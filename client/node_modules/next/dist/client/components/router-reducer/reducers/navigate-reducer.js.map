{"version":3,"sources":["../../../../../src/client/components/router-reducer/reducers/navigate-reducer.ts"],"names":["handleExternalUrl","navigateReducer","state","mutable","url","pendingPush","previousTree","tree","mpaNavigation","canonicalUrl","applyFocusAndScroll","handleMutable","action","isExternalUrl","navigateType","cache","forceOptimisticNavigation","pathname","hash","href","createHrefFromUrl","isForCurrentTree","JSON","stringify","toString","prefetchValues","prefetchCache","get","treeAtTimeOfPrefetch","data","flightData","canonicalUrlOverride","readRecordValue","currentTree","currentCache","flightDataPath","flightSegmentPath","slice","treePatch","newTree","applyRouterStatePatchToTree","isNavigatingToNewRootLayout","applied","applyFlightData","hardNavigate","shouldHardNavigate","status","CacheStates","READY","subTreeData","invalidateCacheBelowFlightSegmentPath","patchedTree","hashFragment","segments","split","push","optimisticTree","createOptimisticTree","res","fillCacheWithDataProperty","fetchServerResponse","nextUrl","bailOptimistic","createRecordFromThenable","Error"],"mappings":"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"}
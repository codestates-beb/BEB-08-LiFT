{"version":3,"sources":["../../../../../src/client/components/router-reducer/reducers/refresh-reducer.ts"],"names":["refreshReducer","state","action","cache","mutable","origin","href","canonicalUrl","isForCurrentTree","JSON","stringify","previousTree","tree","handleMutable","data","createRecordFromThenable","fetchServerResponse","URL","nextUrl","flightData","canonicalUrlOverride","readRecordValue","handleExternalUrl","pushRef","pendingPush","currentTree","flightDataPath","length","console","log","treePatch","newTree","applyRouterStatePatchToTree","Error","isNavigatingToNewRootLayout","canonicalUrlOverrideHref","createHrefFromUrl","undefined","subTreeData","head","slice","status","CacheStates","READY","fillLazyItemsTillLeafWithHead","prefetchCache","Map","patchedTree"],"mappings":"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"}
{"version":3,"sources":["../../../../src/server/lib/incremental-cache/fetch-cache.ts"],"names":["FetchCache","constructor","ctx","debug","process","env","NEXT_PRIVATE_DEBUG_CACHE","headers","FETCH_CACHE_HEADER","_requestHeaders","newHeaders","JSON","parse","k","cacheEndpoint","console","log","maxMemoryCacheSize","memoryCache","LRUCache","max","length","value","kind","stringify","props","Error","data","body","html","pageData","get","key","fetchCache","originUrl","fetchIdx","Date","now","lastModified","undefined","start","fetchParams","internal","fetchType","res","fetch","method","next","status","ok","error","text","cached","json","cacheState","age","CACHE_ONE_YEAR","parseInt","Object","keys","set","err","revalidate","toString"],"mappings":"AAAA;;;;;AAAqB,IAAA,SAA8B,kCAA9B,8BAA8B,EAAA;AAChB,IAAA,iBAA+C,WAA/C,+CAA+C,CAAA;AACnD,IAAA,UAAwB,WAAxB,wBAAwB,CAAA;AAYxC,MAAMA,UAAU;IAK7BC,YAAYC,GAAwB,CAAE;QACpC,IAAI,CAACC,KAAK,GAAG,CAAC,CAACC,OAAO,CAACC,GAAG,CAACC,wBAAwB;QACnD,IAAI,CAACC,OAAO,GAAG,EAAE;QACjB,IAAI,CAACA,OAAO,CAAC,cAAc,CAAC,GAAG,kBAAkB;QAEjD,IAAIC,iBAAkB,mBAAA,IAAIN,GAAG,CAACO,eAAe,EAAE;YAC7C,MAAMC,UAAU,GAAGC,IAAI,CAACC,KAAK,CAC3BV,GAAG,CAACO,eAAe,CAACD,iBAAkB,mBAAA,CAAC,CACxC;YACD,IAAK,MAAMK,CAAC,IAAIH,UAAU,CAAE;gBAC1B,IAAI,CAACH,OAAO,CAACM,CAAC,CAAC,GAAGH,UAAU,CAACG,CAAC,CAAC;aAChC;YACD,OAAOX,GAAG,CAACO,eAAe,CAACD,iBAAkB,mBAAA,CAAC;SAC/C;QACD,IAAIN,GAAG,CAACO,eAAe,CAAC,kBAAkB,CAAC,EAAE;YAC3C,IAAI,CAACK,aAAa,GAAG,CAAC,QAAQ,EAAEZ,GAAG,CAACO,eAAe,CAAC,kBAAkB,CAAC,CAAC,EACtEP,GAAG,CAACO,eAAe,CAAC,sBAAsB,CAAC,IAAI,EAAE,CAClD,CAAC;YACF,IAAI,IAAI,CAACN,KAAK,EAAE;gBACdY,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAE,IAAI,CAACF,aAAa,CAAC;aACxD;SACF,MAAM,IAAI,IAAI,CAACX,KAAK,EAAE;YACrBY,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;SAC3C;QAED,IAAId,GAAG,CAACe,kBAAkB,IAAI,CAACC,WAAW,EAAE;YAC1C,IAAI,IAAI,CAACf,KAAK,EAAE;gBACdY,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC;aAClD;YACDE,WAAW,GAAG,IAAIC,SAAQ,QAAA,CAAC;gBACzBC,GAAG,EAAElB,GAAG,CAACe,kBAAkB;gBAC3BI,MAAM,EAAC,EAAEC,KAAK,CAAA,EAAE,EAAE;wBAcOX,GAA8B;oBAbrD,IAAI,CAACW,KAAK,EAAE;wBACV,OAAO,EAAE,CAAA;qBACV,MAAM,IAAIA,KAAK,CAACC,IAAI,KAAK,UAAU,EAAE;wBACpC,OAAOZ,IAAI,CAACa,SAAS,CAACF,KAAK,CAACG,KAAK,CAAC,CAACJ,MAAM,CAAA;qBAC1C,MAAM,IAAIC,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;wBACjC,MAAM,IAAIG,KAAK,CAAC,iDAAiD,CAAC,CAAA;qBACnE,MAAM,IAAIJ,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;wBACjC,OAAOZ,IAAI,CAACa,SAAS,CAACF,KAAK,CAACK,IAAI,IAAI,EAAE,CAAC,CAACN,MAAM,CAAA;qBAC/C,MAAM,IAAIC,KAAK,CAACC,IAAI,KAAK,OAAO,EAAE;wBACjC,OAAOD,KAAK,CAACM,IAAI,CAACP,MAAM,CAAA;qBACzB;oBACD,wCAAwC;oBACxC,OACEC,KAAK,CAACO,IAAI,CAACR,MAAM,GAAG,CAACV,CAAAA,CAAAA,GAA8B,GAA9BA,IAAI,CAACa,SAAS,CAACF,KAAK,CAACQ,QAAQ,CAAC,SAAQ,GAAtCnB,KAAAA,CAAsC,GAAtCA,GAA8B,CAAEU,MAAM,CAAA,IAAI,CAAC,CAAC,CAClE;iBACF;aACF,CAAC;SACH,MAAM;YACL,IAAI,IAAI,CAAClB,KAAK,EAAE;gBACdY,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;aACtD;SACF;KACF;IAED,MAAae,GAAG,CACdC,GAAW,EACXC,UAAoB,EACpBC,SAAkB,EAClBC,QAAiB,EACjB;QACA,IAAI,CAACF,UAAU,EAAE,OAAO,IAAI,CAAA;QAE5B,IAAIN,IAAI,GAAGT,WAAW,QAAK,GAAhBA,KAAAA,CAAgB,GAAhBA,WAAW,CAAEa,GAAG,CAACC,GAAG,CAAC;QAEhC,0DAA0D;QAC1D,wDAAwD;QACxD,IAAII,IAAI,CAACC,GAAG,EAAE,GAAG,CAACV,CAAAA,IAAI,QAAc,GAAlBA,KAAAA,CAAkB,GAAlBA,IAAI,CAAEW,YAAY,CAAA,IAAI,CAAC,CAAC,GAAG,IAAI,EAAE;YACjDX,IAAI,GAAGY,SAAS;SACjB;QAED,4BAA4B;QAC5B,IAAI,CAACZ,IAAI,IAAI,IAAI,CAACb,aAAa,EAAE;YAC/B,IAAI;gBACF,MAAM0B,KAAK,GAAGJ,IAAI,CAACC,GAAG,EAAE;gBACxB,MAAMI,WAAW,GAAyB;oBACxCC,QAAQ,EAAE,IAAI;oBACdC,SAAS,EAAE,WAAW;oBACtBT,SAAS;oBACTC,QAAQ;iBACT;gBACD,MAAMS,GAAG,GAAG,MAAMC,KAAK,CACrB,CAAC,EAAE,IAAI,CAAC/B,aAAa,CAAC,mBAAmB,EAAEkB,GAAG,CAAC,CAAC,EAChD;oBACEc,MAAM,EAAE,KAAK;oBACbvC,OAAO,EAAE,IAAI,CAACA,OAAO;oBACrBwC,IAAI,EAAEN,WAAW;iBAClB,CACF;gBAED,IAAIG,GAAG,CAACI,MAAM,KAAK,GAAG,EAAE;oBACtB,IAAI,IAAI,CAAC7C,KAAK,EAAE;wBACdY,OAAO,CAACC,GAAG,CACT,CAAC,yBAAyB,EAAEgB,GAAG,CAAC,YAAY,EAC1CI,IAAI,CAACC,GAAG,EAAE,GAAGG,KAAK,CACnB,EAAE,CAAC,CACL;qBACF;oBACD,OAAO,IAAI,CAAA;iBACZ;gBAED,IAAI,CAACI,GAAG,CAACK,EAAE,EAAE;oBACXlC,OAAO,CAACmC,KAAK,CAAC,MAAMN,GAAG,CAACO,IAAI,EAAE,CAAC;oBAC/B,MAAM,IAAIzB,KAAK,CAAC,CAAC,4BAA4B,EAAEkB,GAAG,CAACI,MAAM,CAAC,CAAC,CAAC,CAAA;iBAC7D;gBAED,MAAMI,MAAM,GAAG,MAAMR,GAAG,CAACS,IAAI,EAAE;gBAE/B,IAAI,CAACD,MAAM,IAAIA,MAAM,CAAC7B,IAAI,KAAK,OAAO,EAAE;oBACtC,IAAI,CAACpB,KAAK,IAAIY,OAAO,CAACC,GAAG,CAAC;wBAAEoC,MAAM;qBAAE,CAAC;oBACrC,MAAM,IAAI1B,KAAK,CAAC,CAAC,mBAAmB,CAAC,CAAC,CAAA;iBACvC;gBAED,MAAM4B,UAAU,GAAGV,GAAG,CAACrC,OAAO,CAACwB,GAAG,CAAC,sBAAsB,CAAC;gBAC1D,MAAMwB,GAAG,GAAGX,GAAG,CAACrC,OAAO,CAACwB,GAAG,CAAC,KAAK,CAAC;gBAElCJ,IAAI,GAAG;oBACLL,KAAK,EAAE8B,MAAM;oBACb,qDAAqD;oBACrD,uCAAuC;oBACvCd,YAAY,EACVgB,UAAU,KAAK,OAAO,GAClBlB,IAAI,CAACC,GAAG,EAAE,GAAGmB,UAAc,eAAA,GAC3BpB,IAAI,CAACC,GAAG,EAAE,GAAGoB,QAAQ,CAACF,GAAG,IAAI,GAAG,EAAE,EAAE,CAAC,GAAG,IAAI;iBACnD;gBACD,IAAI,IAAI,CAACpD,KAAK,EAAE;oBACdY,OAAO,CAACC,GAAG,CACT,CAAC,0BAA0B,EAAEgB,GAAG,CAAC,YAAY,EAC3CI,IAAI,CAACC,GAAG,EAAE,GAAGG,KAAK,CACnB,UAAU,EAAEkB,MAAM,CAACC,IAAI,CAACP,MAAM,CAAC,CAAC/B,MAAM,CAAC,CAAC,CAC1C;iBACF;gBAED,IAAIM,IAAI,EAAE;oBACRT,WAAW,QAAK,GAAhBA,KAAAA,CAAgB,GAAhBA,WAAW,CAAE0C,GAAG,CAAC5B,GAAG,EAAEL,IAAI,CAAC,CAAA;iBAC5B;aACF,CAAC,OAAOkC,GAAG,EAAE;gBACZ,sCAAsC;gBACtC,IAAI,IAAI,CAAC1D,KAAK,EAAE;oBACdY,OAAO,CAACmC,KAAK,CAAC,CAAC,8BAA8B,CAAC,EAAEW,GAAG,CAAC;iBACrD;aACF;SACF;QACD,OAAOlC,IAAI,IAAI,IAAI,CAAA;KACpB;IAED,MAAaiC,GAAG,CACd5B,GAAW,EACXL,IAAgC,EAChCM,UAAoB,EACpBC,SAAkB,EAClBC,QAAiB,EACjB;QACA,IAAI,CAACF,UAAU,EAAE,OAAM;QAEvBf,WAAW,QAAK,GAAhBA,KAAAA,CAAgB,GAAhBA,WAAW,CAAE0C,GAAG,CAAC5B,GAAG,EAAE;YACpBV,KAAK,EAAEK,IAAI;YACXW,YAAY,EAAEF,IAAI,CAACC,GAAG,EAAE;SACzB,CAAC,CAAA;QAEF,IAAI,IAAI,CAACvB,aAAa,EAAE;YACtB,IAAI;gBACF,MAAM0B,KAAK,GAAGJ,IAAI,CAACC,GAAG,EAAE;gBACxB,IAAIV,IAAI,KAAK,IAAI,IAAI,YAAY,IAAIA,IAAI,EAAE;oBACzC,IAAI,CAACpB,OAAO,CAAC,qBAAqB,CAAC,GAAGoB,IAAI,CAACmC,UAAU,CAACC,QAAQ,EAAE;iBACjE;gBACD,IACE,CAAC,IAAI,CAACxD,OAAO,CAAC,qBAAqB,CAAC,IACpCoB,IAAI,KAAK,IAAI,IACb,MAAM,IAAIA,IAAI,EACd;oBACA,IAAI,CAACpB,OAAO,CAAC,wBAAwB,CAAC,GACpCoB,IAAI,CAACA,IAAI,CAACpB,OAAO,CAAC,eAAe,CAAC;iBACrC;gBACD,MAAMqB,IAAI,GAAGjB,IAAI,CAACa,SAAS,CAACG,IAAI,CAAC;gBACjC,MAAMc,WAAW,GAAyB;oBACxCC,QAAQ,EAAE,IAAI;oBACdC,SAAS,EAAE,WAAW;oBACtBT,SAAS;oBACTC,QAAQ;iBACT;gBACD,MAAMS,GAAG,GAAG,MAAMC,KAAK,CACrB,CAAC,EAAE,IAAI,CAAC/B,aAAa,CAAC,mBAAmB,EAAEkB,GAAG,CAAC,CAAC,EAChD;oBACEc,MAAM,EAAE,MAAM;oBACdvC,OAAO,EAAE,IAAI,CAACA,OAAO;oBACrBqB,IAAI,EAAEA,IAAI;oBACVmB,IAAI,EAAEN,WAAW;iBAClB,CACF;gBAED,IAAI,CAACG,GAAG,CAACK,EAAE,EAAE;oBACX,IAAI,CAAC9C,KAAK,IAAIY,OAAO,CAACC,GAAG,CAAC,MAAM4B,GAAG,CAACO,IAAI,EAAE,CAAC;oBAC3C,MAAM,IAAIzB,KAAK,CAAC,CAAC,iBAAiB,EAAEkB,GAAG,CAACI,MAAM,CAAC,CAAC,CAAC,CAAA;iBAClD;gBAED,IAAI,IAAI,CAAC7C,KAAK,EAAE;oBACdY,OAAO,CAACC,GAAG,CACT,CAAC,oCAAoC,EAAEgB,GAAG,CAAC,YAAY,EACrDI,IAAI,CAACC,GAAG,EAAE,GAAGG,KAAK,CACnB,UAAU,EAAEZ,IAAI,CAACP,MAAM,CAAC,CAAC,CAC3B;iBACF;aACF,CAAC,OAAOwC,GAAG,EAAE;gBACZ,+BAA+B;gBAC/B,IAAI,IAAI,CAAC1D,KAAK,EAAE;oBACdY,OAAO,CAACmC,KAAK,CAAC,CAAC,4BAA4B,CAAC,EAAEW,GAAG,CAAC;iBACnD;aACF;SACF;QACD,OAAM;KACP;CACF;kBA1NoB7D,UAAU;;;;;;AAT/B,IAAIkB,WAAW,AAAiD"}
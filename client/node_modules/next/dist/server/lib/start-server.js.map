{"version":3,"sources":["../../../src/server/lib/start-server.ts"],"names":["startServer","Log","dir","prevDir","port","isDev","hostname","useWorkers","allowRetry","keepAliveTimeout","onStdout","onStderr","process","sockets","Set","worker","handlersReady","handlersError","isNodeDebugging","execArgv","some","localArg","startsWith","env","NODE_OPTIONS","match","handlersPromise","Promise","resolve","reject","requestHandler","_req","_res","Error","upgradeHandler","_socket","_head","server","http","createServer","req","res","undefined","add","on","delete","err","statusCode","end","error","url","console","socket","head","destroy","portRetryCount","code","warn","listen","exit","targetHost","addr","address","host","normalizedHostname","isIPv6","appUrl","ready","httpProxy","require","renderServerPath","jestWorkerPath","replace","Worker","routerWorker","numWorkers","maxRetries","forkOptions","FORCE_COLOR","initialEnv","getNodeOptionsWithoutInspect","trim","exposedMethods","didInitialize","_worker","_workerPool","_workers","_child","signal","workerStdout","getStdout","workerStderr","getStderr","data","stdout","write","stderr","routerPort","initialize","dev","workerType","getProxyServer","pathname","targetUrl","proxyServer","createProxy","target","changeOrigin","ignorePath","xfwd","ws","followRedirects","_err","urlParts","split","urlNoQuery","cleanUrl","normalizeRepeatedSlashes","setHeader","web","default","next","app","httpServer","customServer","getRequestHandler","getUpgradeHandler","prepare","teardown","close","forEach"],"mappings":"AAAA;;;;QAyBsBA,WAAW,GAAXA,WAAW;AAzBhB,IAAA,KAAM,kCAAN,MAAM,EAAA;AACA,IAAA,IAAK,WAAL,KAAK,CAAA;AAChBC,IAAAA,GAAG,mCAAM,wBAAwB,EAA9B;AAC8B,IAAA,MAAS,WAAT,SAAS,CAAA;AAGb,IAAA,OAAwB,WAAxB,wBAAwB,CAAA;AACtC,IAAA,IAAW,WAAX,WAAW,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkB/B,eAAeD,WAAW,CAAC,EAChCE,GAAG,CAAA,EACHC,OAAO,CAAA,EACPC,IAAI,CAAA,EACJC,KAAK,CAAA,EACLC,QAAQ,CAAA,EACRC,UAAU,CAAA,EACVC,UAAU,CAAA,EACVC,gBAAgB,CAAA,EAChBC,QAAQ,CAAA,EACRC,QAAQ,CAAA,EACW,EAA2B;QAQ5CC,GAAwB,EAKxBA,IAAwB;IAZ1B,MAAMC,OAAO,GAAG,IAAIC,GAAG,EAAkB;IACzC,IAAIC,MAAM,AAA6D;IACvE,IAAIC,aAAa,GAAG,IAAM,EAAE;IAC5B,IAAIC,aAAa,GAAG,IAAM,EAAE;IAE5B,IAAIC,eAAe,GAAoB,CAAC,CAAC,CACvCN,OAAO,CAACO,QAAQ,CAACC,IAAI,CAAC,CAACC,QAAQ,GAAKA,QAAQ,CAACC,UAAU,CAAC,WAAW,CAAC,CAAC,KACrEV,CAAAA,GAAwB,GAAxBA,OAAO,CAACW,GAAG,CAACC,YAAY,SAAO,GAA/BZ,KAAAA,CAA+B,GAA/BA,GAAwB,CAAEa,KAAK,QAA2B,GAA1Db,KAAAA,CAA0D,GAA1DA,GAAwB,CAAEa,KAAK,yBAA2B,CAAA,CAC3D;IAED,IACEb,OAAO,CAACO,QAAQ,CAACC,IAAI,CAAC,CAACC,QAAQ,GAAKA,QAAQ,CAACC,UAAU,CAAC,eAAe,CAAC,CAAC,KACzEV,CAAAA,IAAwB,GAAxBA,OAAO,CAACW,GAAG,CAACC,YAAY,SAAO,GAA/BZ,KAAAA,CAA+B,GAA/BA,IAAwB,CAAEa,KAAK,QAA+B,GAA9Db,KAAAA,CAA8D,GAA9DA,IAAwB,CAAEa,KAAK,6BAA+B,CAAA,EAC9D;QACAP,eAAe,GAAG,KAAK;KACxB;IAED,IAAIQ,eAAe,GAA8B,IAAIC,OAAO,CAC1D,CAACC,OAAO,EAAEC,MAAM,GAAK;QACnBb,aAAa,GAAGY,OAAO;QACvBX,aAAa,GAAGY,MAAM;KACvB,CACF;IACD,IAAIC,cAAc,GAAG,OACnBC,IAAqB,EACrBC,IAAoB,GACF;QAClB,IAAIN,eAAe,EAAE;YACnB,MAAMA,eAAe;YACrB,OAAOI,cAAc,CAACC,IAAI,EAAEC,IAAI,CAAC,CAAA;SAClC;QACD,MAAM,IAAIC,KAAK,CAAC,yCAAyC,CAAC,CAAA;KAC3D;IACD,IAAIC,cAAc,GAAG,OACnBH,IAAqB,EACrBI,OAAuB,EACvBC,KAAa,GACK;QAClB,IAAIV,eAAe,EAAE;YACnB,MAAMA,eAAe;YACrB,OAAOQ,cAAc,CAACH,IAAI,EAAEI,OAAO,EAAEC,KAAK,CAAC,CAAA;SAC5C;QACD,MAAM,IAAIH,KAAK,CAAC,yCAAyC,CAAC,CAAA;KAC3D;IAED,4CAA4C;IAC5C,MAAMI,MAAM,GAAGC,KAAI,QAAA,CAACC,YAAY,CAAC,OAAOC,GAAG,EAAEC,GAAG,GAAK;QACnD,IAAI;YACF,IAAIf,eAAe,EAAE;gBACnB,MAAMA,eAAe;gBACrBA,eAAe,GAAGgB,SAAS;aAC5B;YACD7B,OAAO,CAAC8B,GAAG,CAACF,GAAG,CAAC;YAChBA,GAAG,CAACG,EAAE,CAAC,OAAO,EAAE,IAAM/B,OAAO,CAACgC,MAAM,CAACJ,GAAG,CAAC,CAAC;YAC1C,MAAMX,cAAc,CAACU,GAAG,EAAEC,GAAG,CAAC;SAC/B,CAAC,OAAOK,GAAG,EAAE;YACZL,GAAG,CAACM,UAAU,GAAG,GAAG;YACpBN,GAAG,CAACO,GAAG,CAAC,uBAAuB,CAAC;YAChC/C,GAAG,CAACgD,KAAK,CAAC,CAAC,6BAA6B,EAAET,GAAG,CAACU,GAAG,CAAC,CAAC,CAAC;YACpDC,OAAO,CAACF,KAAK,CAACH,GAAG,CAAC;SACnB;KACF,CAAC;IAEF,IAAIrC,gBAAgB,EAAE;QACpB4B,MAAM,CAAC5B,gBAAgB,GAAGA,gBAAgB;KAC3C;IACD4B,MAAM,CAACO,EAAE,CAAC,SAAS,EAAE,OAAOJ,GAAG,EAAEY,MAAM,EAAEC,IAAI,GAAK;QAChD,IAAI;YACFxC,OAAO,CAAC8B,GAAG,CAACS,MAAM,CAAC;YACnBA,MAAM,CAACR,EAAE,CAAC,OAAO,EAAE,IAAM/B,OAAO,CAACgC,MAAM,CAACO,MAAM,CAAC,CAAC;YAChD,MAAMlB,cAAc,CAACM,GAAG,EAAEY,MAAM,EAAEC,IAAI,CAAC;SACxC,CAAC,OAAOP,GAAG,EAAE;YACZM,MAAM,CAACE,OAAO,EAAE;YAChBrD,GAAG,CAACgD,KAAK,CAAC,CAAC,6BAA6B,EAAET,GAAG,CAACU,GAAG,CAAC,CAAC,CAAC;YACpDC,OAAO,CAACF,KAAK,CAACH,GAAG,CAAC;SACnB;KACF,CAAC;IAEF,IAAIS,cAAc,GAAG,CAAC;IAEtBlB,MAAM,CAACO,EAAE,CAAC,OAAO,EAAE,CAACE,GAA0B,GAAK;QACjD,IACEtC,UAAU,IACVJ,IAAI,IACJC,KAAK,IACLyC,GAAG,CAACU,IAAI,KAAK,YAAY,IACzBD,cAAc,GAAG,EAAE,EACnB;YACAtD,GAAG,CAACwD,IAAI,CAAC,CAAC,KAAK,EAAErD,IAAI,CAAC,mBAAmB,EAAEA,IAAI,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC;YAC/DA,IAAI,IAAI,CAAC;YACTmD,cAAc,IAAI,CAAC;YACnBlB,MAAM,CAACqB,MAAM,CAACtD,IAAI,EAAEE,QAAQ,CAAC;SAC9B,MAAM;YACLL,GAAG,CAACgD,KAAK,CAAC,CAAC,sBAAsB,CAAC,CAAC;YACnCE,OAAO,CAACF,KAAK,CAACH,GAAG,CAAC;YAClBlC,OAAO,CAAC+C,IAAI,CAAC,CAAC,CAAC;SAChB;KACF,CAAC;IAEF,IAAIC,UAAU,GAAGtD,QAAQ;IAEzB,MAAM,IAAIqB,OAAO,CAAO,CAACC,OAAO,GAAK;QACnCS,MAAM,CAACO,EAAE,CAAC,WAAW,EAAE,IAAM;YAC3B,MAAMiB,IAAI,GAAGxB,MAAM,CAACyB,OAAO,EAAE;YAC7B1D,IAAI,GAAG,OAAOyD,IAAI,KAAK,QAAQ,GAAGA,CAAAA,IAAI,QAAM,GAAVA,KAAAA,CAAU,GAAVA,IAAI,CAAEzD,IAAI,CAAA,IAAIA,IAAI,GAAGA,IAAI;YAE3D,IAAI2D,IAAI,GAAG,CAACzD,QAAQ,IAAIA,QAAQ,KAAK,SAAS,GAAG,WAAW,GAAGA,QAAQ;YAEvE,IAAI0D,kBAAkB,GAAG1D,QAAQ,IAAI,SAAS;YAE9C,IAAI2D,CAAAA,GAAAA,IAAM,AAAU,CAAA,OAAV,CAAC3D,QAAQ,CAAC,EAAE;gBACpByD,IAAI,GAAGA,IAAI,KAAK,IAAI,GAAG,OAAO,GAAG,CAAC,CAAC,EAAEA,IAAI,CAAC,CAAC,CAAC;gBAC5CC,kBAAkB,GAAG,CAAC,CAAC,EAAE1D,QAAQ,CAAC,CAAC,CAAC;aACrC;YACDsD,UAAU,GAAGG,IAAI;YAEjB,MAAMG,MAAM,GAAG,CAAC,OAAO,EAAEH,IAAI,CAAC,CAAC,EAAE3D,IAAI,CAAC,CAAC;YAEvCH,GAAG,CAACkE,KAAK,CACP,CAAC,kBAAkB,EAAEH,kBAAkB,CAAC,EACtC,CAAC5D,IAAI,GAAG,EAAE,CAAC,CAACkB,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,GAAG,CACvC,EAAElB,IAAI,CAAC,OAAO,EAAE8D,MAAM,CAAC,CAAC,CAC1B;YACDtC,OAAO,EAAE;SACV,CAAC;QACFS,MAAM,CAACqB,MAAM,CAACtD,IAAI,EAAEE,QAAQ,CAAC;KAC9B,CAAC;IAEF,IAAI;QACF,IAAIC,UAAU,EAAE;gBAoCS,IAAiC;YAnCxD,MAAM6D,SAAS,GACbC,OAAO,CAAC,+BAA+B,CAAC,AAAkD;YAE5F,IAAIC,gBAAgB,GAAGD,OAAO,CAACzC,OAAO,CAAC,iBAAiB,CAAC;YACzD,IAAI2C,cAAc,GAAGF,OAAO,CAACzC,OAAO,CAAC,gCAAgC,CAAC;YAEtE,IAAIzB,OAAO,EAAE;gBACXoE,cAAc,GAAGA,cAAc,CAACC,OAAO,CAACrE,OAAO,EAAED,GAAG,CAAC;gBACrDoE,gBAAgB,GAAGA,gBAAgB,CAACE,OAAO,CAACrE,OAAO,EAAED,GAAG,CAAC;aAC1D;YAED,MAAM,EAAEuE,MAAM,CAAA,EAAE,GACdJ,OAAO,CAACE,cAAc,CAAC,AAAmD;YAE5E,MAAMG,YAAY,GAAG,IAAID,MAAM,CAACH,gBAAgB,EAAE;gBAChDK,UAAU,EAAE,CAAC;gBACb,uDAAuD;gBACvDC,UAAU,EAAE,EAAE;gBACdC,WAAW,EAAE;oBACXtD,GAAG,EAAE;wBACHuD,WAAW,EAAE,GAAG;wBAChB,GAAKC,IAAU,WAAA,IAAInE,OAAO,CAACW,GAAG;wBAC9B,4CAA4C;wBAC5C,qBAAqB;wBACrBC,YAAY,EAAEwD,CAAAA,GAAAA,MAA4B,AAAE,CAAA,6BAAF,EAAE,CACzCR,OAAO,kCAAkC,EAAE,CAAC,CAC5CS,IAAI,EAAE;qBACV;iBACF;gBACDC,cAAc,EAAE;oBAAC,YAAY;iBAAC;aAC/B,CAAC,AAED;YACD,IAAIC,aAAa,GAAG,KAAK;YAEzB,KAAK,MAAMC,OAAO,IAAK,CAAA,CAAA,IAAiC,GAAjC,AAACV,YAAY,CAASW,WAAW,SAAU,GAA3C,KAAA,CAA2C,GAA3C,IAAiC,CAAEC,QAAQ,CAAA,IAChE,EAAE,CAEC;gBACH,wCAAwC;gBACxCF,OAAO,CAACG,MAAM,CAAC3C,EAAE,CAAC,MAAM,EAAE,CAACY,IAAI,EAAEgC,MAAM,GAAK;oBAC1C,0CAA0C;oBAC1C,IAAI,CAAChC,IAAI,IAAIgC,MAAM,CAAC,IAAI,CAACL,aAAa,EAAE;wBACtCT,YAAY,QAAK,GAAjBA,KAAAA,CAAiB,GAAjBA,YAAY,CAAE1B,GAAG,EAAE,CAAA;wBACnBpC,OAAO,CAAC+C,IAAI,CAAC,CAAC,CAAC;qBAChB;iBACF,CAAC;aACH;YAED,MAAM8B,YAAY,GAAGf,YAAY,CAACgB,SAAS,EAAE;YAC7C,MAAMC,YAAY,GAAGjB,YAAY,CAACkB,SAAS,EAAE;YAE7CH,YAAY,CAAC7C,EAAE,CAAC,MAAM,EAAE,CAACiD,IAAI,GAAK;gBAChC,IAAI,OAAOnF,QAAQ,KAAK,UAAU,EAAE;oBAClCA,QAAQ,CAACmF,IAAI,CAAC;iBACf,MAAM;oBACLjF,OAAO,CAACkF,MAAM,CAACC,KAAK,CAACF,IAAI,CAAC;iBAC3B;aACF,CAAC;YACFF,YAAY,CAAC/C,EAAE,CAAC,MAAM,EAAE,CAACiD,IAAI,GAAK;gBAChC,IAAI,OAAOlF,QAAQ,KAAK,UAAU,EAAE;oBAClCA,QAAQ,CAACkF,IAAI,CAAC;iBACf,MAAM;oBACLjF,OAAO,CAACoF,MAAM,CAACD,KAAK,CAACF,IAAI,CAAC;iBAC3B;aACF,CAAC;YAEF,MAAM,EAAEzF,IAAI,EAAE6F,UAAU,CAAA,EAAE,GAAG,MAAMvB,YAAY,CAACwB,UAAU,CAAC;gBACzDhG,GAAG;gBACHE,IAAI;gBACJE,QAAQ;gBACR6F,GAAG,EAAE,CAAC,CAAC9F,KAAK;gBACZ+F,UAAU,EAAE,QAAQ;gBACpB3F,gBAAgB;aACjB,CAAC;YACF0E,aAAa,GAAG,IAAI;YAEpB,MAAMkB,cAAc,GAAG,CAACC,QAAgB,GAAK;gBAC3C,MAAMC,SAAS,GAAG,CAAC,OAAO,EACxB3C,UAAU,KAAK,WAAW,GAAG,WAAW,GAAGA,UAAU,CACtD,CAAC,EAAEqC,UAAU,CAAC,EAAEK,QAAQ,CAAC,CAAC;gBAC3B,MAAME,WAAW,GAAGpC,SAAS,CAACqC,WAAW,CAAC;oBACxCC,MAAM,EAAEH,SAAS;oBACjBI,YAAY,EAAE,KAAK;oBACnBC,UAAU,EAAE,IAAI;oBAChBC,IAAI,EAAE,IAAI;oBACVC,EAAE,EAAE,IAAI;oBACRC,eAAe,EAAE,KAAK;iBACvB,CAAC;gBAEFP,WAAW,CAAC5D,EAAE,CAAC,OAAO,EAAE,CAACoE,IAAI,GAAK;gBAChC,sDAAsD;iBACvD,CAAC;gBACF,OAAOR,WAAW,CAAA;aACnB;YAED,yBAAyB;YACzB1E,cAAc,GAAG,OAAOU,GAAG,EAAEC,GAAG,GAAK;gBACnC,MAAMwE,QAAQ,GAAG,CAACzE,GAAG,CAACU,GAAG,IAAI,EAAE,CAAC,CAACgE,KAAK,CAAC,GAAG,CAAC;gBAC3C,MAAMC,UAAU,GAAGF,QAAQ,CAAC,CAAC,CAAC;gBAE9B,oEAAoE;gBACpE,+DAA+D;gBAC/D,wEAAwE;gBACxE,WAAW;gBACX,IAAIE,UAAU,QAAO,GAAjBA,KAAAA,CAAiB,GAAjBA,UAAU,CAAE1F,KAAK,aAAa,EAAE;oBAClC,MAAM2F,QAAQ,GAAGC,CAAAA,GAAAA,OAAwB,AAAU,CAAA,yBAAV,CAAC7E,GAAG,CAACU,GAAG,CAAE;oBACnDT,GAAG,CAACM,UAAU,GAAG,GAAG;oBACpBN,GAAG,CAAC6E,SAAS,CAAC,UAAU,EAAEF,QAAQ,CAAC;oBACnC3E,GAAG,CAACO,GAAG,CAACoE,QAAQ,CAAC;oBACjB,OAAM;iBACP;gBACD,MAAMZ,WAAW,GAAGH,cAAc,CAAC7D,GAAG,CAACU,GAAG,IAAI,GAAG,CAAC;gBAClDsD,WAAW,CAACe,GAAG,CAAC/E,GAAG,EAAEC,GAAG,CAAC;aAC1B;YACDP,cAAc,GAAG,OAAOM,GAAG,EAAEY,MAAM,EAAEC,IAAI,GAAK;gBAC5C,MAAMmD,WAAW,GAAGH,cAAc,CAAC7D,GAAG,CAACU,GAAG,IAAI,GAAG,CAAC;gBAClDsD,WAAW,CAACM,EAAE,CAACtE,GAAG,EAAEY,MAAM,EAAEC,IAAI,CAAC;aAClC;YACDrC,aAAa,EAAE;SAChB,MAAM;YACL,qDAAqD;YACrD,MAAM,EAAEwG,OAAO,EAAEC,IAAI,CAAA,EAAE,GAAGpD,OAAO,CAAC,SAAS,CAAC,AAA4B;YACxE,MAAMR,IAAI,GAAGxB,MAAM,CAACyB,OAAO,EAAE;YAC7B,MAAM4D,GAAG,GAAGD,IAAI,CAAC;gBACfvH,GAAG;gBACHI,QAAQ;gBACR6F,GAAG,EAAE9F,KAAK;gBACVa,eAAe;gBACfyG,UAAU,EAAEtF,MAAM;gBAClBuF,YAAY,EAAE,KAAK;gBACnBxH,IAAI,EAAEyD,IAAI,IAAI,OAAOA,IAAI,KAAK,QAAQ,GAAGA,IAAI,CAACzD,IAAI,GAAGA,IAAI;aAC1D,CAAC;YACF,oBAAoB;YACpB0B,cAAc,GAAG4F,GAAG,CAACG,iBAAiB,EAAE;YACxC3F,cAAc,GAAGwF,GAAG,CAACI,iBAAiB,EAAE;YACxC,MAAMJ,GAAG,CAACK,OAAO,EAAE;YACnB/G,aAAa,EAAE;SAChB;KACF,CAAC,OAAO8B,GAAG,EAAE;QACZ,gCAAgC;QAChC7B,aAAa,EAAE;QACfkC,OAAO,CAACF,KAAK,CAACH,GAAG,CAAC;QAClBlC,OAAO,CAAC+C,IAAI,CAAC,CAAC,CAAC;KAChB;IAED,qDAAqD;IACrD,eAAeqE,QAAQ,GAAG;QACxB3F,MAAM,CAAC4F,KAAK,EAAE;QACdpH,OAAO,CAACqH,OAAO,CAAC,CAAC9E,MAAM,GAAK;YAC1BvC,OAAO,CAACgC,MAAM,CAACO,MAAM,CAAC;YACtBA,MAAM,CAACE,OAAO,EAAE;SACjB,CAAC;QAEF,IAAIvC,MAAM,EAAE;YACV,MAAMA,MAAM,CAACiC,GAAG,EAAE;SACnB;KACF;IACD,OAAOgF,QAAQ,CAAA;CAChB"}
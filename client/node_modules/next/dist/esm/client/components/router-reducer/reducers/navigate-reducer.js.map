{"version":3,"sources":["../../../../../src/client/components/router-reducer/reducers/navigate-reducer.ts"],"names":["CacheStates","fetchServerResponse","createRecordFromThenable","readRecordValue","createHrefFromUrl","invalidateCacheBelowFlightSegmentPath","fillCacheWithDataProperty","createOptimisticTree","applyRouterStatePatchToTree","shouldHardNavigate","isNavigatingToNewRootLayout","handleMutable","applyFlightData","handleExternalUrl","state","mutable","url","pendingPush","previousTree","tree","mpaNavigation","canonicalUrl","applyFocusAndScroll","navigateReducer","action","isExternalUrl","navigateType","cache","forceOptimisticNavigation","pathname","hash","href","isForCurrentTree","JSON","stringify","toString","prefetchValues","prefetchCache","get","treeAtTimeOfPrefetch","data","flightData","canonicalUrlOverride","currentTree","currentCache","flightDataPath","flightSegmentPath","slice","treePatch","newTree","applied","hardNavigate","status","READY","subTreeData","patchedTree","hashFragment","segments","split","push","optimisticTree","res","nextUrl","bailOptimistic","Error"],"mappings":"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"}
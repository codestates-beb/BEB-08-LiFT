(function(qt,ze){typeof exports=="object"&&typeof module<"u"?ze(exports):typeof define=="function"&&define.amd?define(["exports"],ze):(qt=typeof globalThis<"u"?globalThis:qt||self,ze(qt["@walletconnect/universal-provider"]={}))})(this,function(qt){"use strict";var ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function Sc(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var xc=Oc;function Oc(t,e,r){var i=r&&r.stringify||Sc,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var o=new Array(s);o[0]=i(t);for(var c=1;c<s;c++)o[c]=i(e[c]);return o.join(" ")}if(typeof t!="string")return t;var l=e.length;if(l===0)return t;for(var h="",f=1-n,_=-1,m=t&&t.length||0,D=0;D<m;){if(t.charCodeAt(D)===37&&D+1<m){switch(_=_>-1?_:0,t.charCodeAt(D+1)){case 100:case 102:if(f>=l||e[f]==null)break;_<D&&(h+=t.slice(_,D)),h+=Number(e[f]),_=D+2,D++;break;case 105:if(f>=l||e[f]==null)break;_<D&&(h+=t.slice(_,D)),h+=Math.floor(Number(e[f])),_=D+2,D++;break;case 79:case 111:case 106:if(f>=l||e[f]===void 0)break;_<D&&(h+=t.slice(_,D));var w=typeof e[f];if(w==="string"){h+="'"+e[f]+"'",_=D+2,D++;break}if(w==="function"){h+=e[f].name||"<anonymous>",_=D+2,D++;break}h+=i(e[f]),_=D+2,D++;break;case 115:if(f>=l)break;_<D&&(h+=t.slice(_,D)),h+=String(e[f]),_=D+2,D++;break;case 37:_<D&&(h+=t.slice(_,D)),h+="%",_=D+2,D++,f--;break}++f}++D}return _===-1?t:(_<m&&(h+=t.slice(_)),h)}const Yn=xc;var br=Dt;const vr=Lc().console||{},Ic={mapHttpRequest:Jr,mapHttpResponse:Jr,wrapRequestSerializer:Ni,wrapResponseSerializer:Ni,wrapErrorSerializer:Ni,req:Jr,res:Jr,err:Nc};function Pc(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Dt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||vr;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=Pc(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const c=t.level||"info",l=Object.create(r);l.log||(l.log=mr),Object.defineProperty(l,"levelVal",{get:f}),Object.defineProperty(l,"level",{get:_,set:m});const h={transmit:e,serialize:n,asObject:t.browser.asObject,levels:o,timestamp:Rc(t)};l.levels=Dt.levels,l.level=c,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=mr,l.serializers=i,l._serialize=n,l._stdErrSerialize=s,l.child=D,e&&(l._logEvent=Ti());function f(){return this.level==="silent"?1/0:this.levels.values[this.level]}function _(){return this._level}function m(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,nr(h,l,"error","log"),nr(h,l,"fatal","error"),nr(h,l,"warn","error"),nr(h,l,"info","log"),nr(h,l,"debug","log"),nr(h,l,"trace","log")}function D(w,R){if(!w)throw new Error("missing bindings for child Pino");R=R||{},n&&w.serializers&&(R.serializers=w.serializers);const F=R.serializers;if(n&&F){var B=Object.assign({},i,F),x=t.browser.serialize===!0?Object.keys(B):n;delete w.serializers,Yr([w],x,B,this._stdErrSerialize)}function P(y){this._childLevel=(y._childLevel|0)+1,this.error=sr(y,w,"error"),this.fatal=sr(y,w,"fatal"),this.warn=sr(y,w,"warn"),this.info=sr(y,w,"info"),this.debug=sr(y,w,"debug"),this.trace=sr(y,w,"trace"),B&&(this.serializers=B,this._serialize=x),e&&(this._logEvent=Ti([].concat(y._logEvent.bindings,w)))}return P.prototype=this,new P(this)}return l}Dt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Dt.stdSerializers=Ic,Dt.stdTimeFunctions=Object.assign({},{nullTime:Jn,epochTime:Xn,unixTime:Fc,isoTime:$c});function nr(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?mr:n[r]?n[r]:vr[r]||vr[i]||mr,Ac(t,e,r)}function Ac(t,e,r){!t.transmit&&e[r]===mr||(e[r]=function(i){return function(){const s=t.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===vr?vr:this;for(var l=0;l<o.length;l++)o[l]=arguments[l];if(t.serialize&&!t.asObject&&Yr(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(c,Cc(this,r,o,s)):i.apply(c,o),t.transmit){const h=t.transmit.level||e.level,f=Dt.levels.values[h],_=Dt.levels.values[r];if(_<f)return;Tc(this,{ts:s,methodLevel:r,methodValue:_,transmitLevel:h,transmitValue:Dt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function Cc(t,e,r,i){t._serialize&&Yr(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const o={};i&&(o.time=i),o.level=Dt.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof n[0]=="object";)Object.assign(o,n.shift());s=n.length?Yn(n.shift(),n):void 0}else typeof s=="string"&&(s=Yn(n.shift(),n));return s!==void 0&&(o.msg=s),o}function Yr(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=Dt.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function sr(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function Tc(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,o=e.methodValue,c=e.val,l=t._logEvent.bindings;Yr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(h){return l.indexOf(h)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,i(s,t._logEvent,c),t._logEvent=Ti(l)}function Ti(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Nc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Rc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Jn:Xn}function Jr(){return{}}function Ni(t){return t}function mr(){}function Jn(){return!1}function Xn(){return Date.now()}function Fc(){return Math.round(Date.now()/1e3)}function $c(){return new Date(Date.now()).toISOString()}function Lc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var it={exports:{}},or=typeof Reflect=="object"?Reflect:null,Zn=or&&typeof or.apply=="function"?or.apply:function(e,r,i){return Function.prototype.apply.call(e,r,i)},Xr;or&&typeof or.ownKeys=="function"?Xr=or.ownKeys:Object.getOwnPropertySymbols?Xr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Xr=function(e){return Object.getOwnPropertyNames(e)};function Uc(t){console&&console.warn&&console.warn(t)}var Qn=Number.isNaN||function(e){return e!==e};function xe(){xe.init.call(this)}it.exports=xe,it.exports.once=Bc,xe.EventEmitter=xe,xe.prototype._events=void 0,xe.prototype._eventsCount=0,xe.prototype._maxListeners=void 0;var es=10;function Zr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(xe,"defaultMaxListeners",{enumerable:!0,get:function(){return es},set:function(t){if(typeof t!="number"||t<0||Qn(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");es=t}}),xe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},xe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Qn(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ts(t){return t._maxListeners===void 0?xe.defaultMaxListeners:t._maxListeners}xe.prototype.getMaxListeners=function(){return ts(this)},xe.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")Zn(l,this,r);else for(var h=l.length,f=os(l,h),i=0;i<h;++i)Zn(f[i],this,r);return!0};function rs(t,e,r,i){var n,s,o;if(Zr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=ts(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,Uc(c)}return t}xe.prototype.addListener=function(e,r){return rs(this,e,r,!1)},xe.prototype.on=xe.prototype.addListener,xe.prototype.prependListener=function(e,r){return rs(this,e,r,!0)};function Mc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function is(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Mc.bind(i);return n.listener=r,i.wrapFn=n,n}xe.prototype.once=function(e,r){return Zr(r),this.on(e,is(this,e,r)),this},xe.prototype.prependOnceListener=function(e,r){return Zr(r),this.prependListener(e,is(this,e,r)),this},xe.prototype.removeListener=function(e,r){var i,n,s,o,c;if(Zr(r),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||r));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===r||i[o].listener===r){c=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():jc(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this},xe.prototype.off=xe.prototype.removeListener,xe.prototype.removeAllListeners=function(e){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this};function ns(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Hc(n):os(n,n.length)}xe.prototype.listeners=function(e){return ns(this,e,!0)},xe.prototype.rawListeners=function(e){return ns(this,e,!1)},xe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ss.call(t,e)},xe.prototype.listenerCount=ss;function ss(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}xe.prototype.eventNames=function(){return this._eventsCount>0?Xr(this._events):[]};function os(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function jc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Hc(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Bc(t,e){return new Promise(function(r,i){function n(o){t.removeListener(e,s),i(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}as(t,e,s,{once:!0}),e!=="error"&&qc(t,n,{once:!0})})}function qc(t,e,r){typeof t.on=="function"&&as(t,"error",e,r)}function as(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function n(s){i.once&&t.removeEventListener(e,n),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Qr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ri=function(t,e){return Ri=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Ri(t,e)};function zc(t,e){Ri(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fi=function(){return Fi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fi.apply(this,arguments)};function Kc(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Vc(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Gc(t,e){return function(r,i){e(r,i,t)}}function kc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Wc(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function Yc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Jc(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Xc(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function $i(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function cs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Zc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(cs(arguments[e]));return t}function Qc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function wr(t){return this instanceof wr?(this.v=t,this):new wr(t)}function eu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(m){i[m]&&(n[m]=function(D){return new Promise(function(w,R){s.push([m,D,w,R])>1||c(m,D)})})}function c(m,D){try{l(i[m](D))}catch(w){_(s[0][3],w)}}function l(m){m.value instanceof wr?Promise.resolve(m.value.v).then(h,f):_(s[0][2],m)}function h(m){c("next",m)}function f(m){c("throw",m)}function _(m,D){m(D),s.shift(),s.length&&c(s[0][0],s[0][1])}}function tu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:wr(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function ru(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof $i=="function"?$i(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function iu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function nu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function su(t){return t&&t.__esModule?t:{default:t}}function ou(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function au(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var cu=Object.freeze({__proto__:null,__extends:zc,get __assign(){return Fi},__rest:Kc,__decorate:Vc,__param:Gc,__metadata:kc,__awaiter:Wc,__generator:Yc,__createBinding:Jc,__exportStar:Xc,__values:$i,__read:cs,__spread:Zc,__spreadArrays:Qc,__await:wr,__asyncGenerator:eu,__asyncDelegator:tu,__asyncValues:ru,__makeTemplateObject:iu,__importStar:nu,__importDefault:su,__classPrivateFieldGet:ou,__classPrivateFieldSet:au}),us=zt(cu),Er={};Object.defineProperty(Er,"__esModule",{value:!0});function uu(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Er.safeJsonParse=uu;function hu(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Er.safeJsonStringify=hu;var Dr={exports:{}},hs;function lu(){return hs||(hs=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ze<"u"&&ze.localStorage?Dr.exports=ze.localStorage:typeof window<"u"&&window.localStorage?Dr.exports=window.localStorage:Dr.exports=new e}()),Dr.exports}var Li={},Sr={},ls;function fu(){if(ls)return Sr;ls=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IKeyValueStorage=void 0;class t{}return Sr.IKeyValueStorage=t,Sr}var xr={},fs;function du(){if(fs)return xr;fs=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.parseEntry=void 0;const t=Er;function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return xr.parseEntry=e,xr}var ds;function pu(){return ds||(ds=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=us;e.__exportStar(fu(),t),e.__exportStar(du(),t)}(Li)),Li}Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.KeyValueStorage=void 0;const ar=us,ps=Er,gu=ar.__importDefault(lu()),yu=pu();class gs{constructor(){this.localStorage=gu.default}getKeys(){return ar.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return ar.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(yu.parseEntry)})}getItem(e){return ar.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return ps.safeJsonParse(r)})}setItem(e,r){return ar.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,ps.safeJsonStringify(r))})}removeItem(e){return ar.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Qr.KeyValueStorage=gs;var _u=Qr.default=gs,Or={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ui=function(t,e){return Ui=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Ui(t,e)};function bu(t,e){Ui(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Mi=function(){return Mi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mi.apply(this,arguments)};function vu(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function mu(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function wu(t,e){return function(r,i){e(r,i,t)}}function Eu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Du(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function Su(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function xu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Ou(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ji(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ys(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Iu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ys(arguments[e]));return t}function Pu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Ir(t){return this instanceof Ir?(this.v=t,this):new Ir(t)}function Au(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(m){i[m]&&(n[m]=function(D){return new Promise(function(w,R){s.push([m,D,w,R])>1||c(m,D)})})}function c(m,D){try{l(i[m](D))}catch(w){_(s[0][3],w)}}function l(m){m.value instanceof Ir?Promise.resolve(m.value.v).then(h,f):_(s[0][2],m)}function h(m){c("next",m)}function f(m){c("throw",m)}function _(m,D){m(D),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Cu(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Ir(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Tu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ji=="function"?ji(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Nu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Ru(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Fu(t){return t&&t.__esModule?t:{default:t}}function $u(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Lu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Uu=Object.freeze({__proto__:null,__extends:bu,get __assign(){return Mi},__rest:vu,__decorate:mu,__param:wu,__metadata:Eu,__awaiter:Du,__generator:Su,__createBinding:xu,__exportStar:Ou,__values:ji,__read:ys,__spread:Iu,__spreadArrays:Pu,__await:Ir,__asyncGenerator:Au,__asyncDelegator:Cu,__asyncValues:Tu,__makeTemplateObject:Nu,__importStar:Ru,__importDefault:Fu,__classPrivateFieldGet:$u,__classPrivateFieldSet:Lu}),ei=zt(Uu),Pr={},Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Hi=function(t,e){return Hi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Hi(t,e)};function Mu(t,e){Hi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Bi=function(){return Bi=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Bi.apply(this,arguments)};function ju(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Hu(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Bu(t,e){return function(r,i){e(r,i,t)}}function qu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function zu(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function Ku(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Vu(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Gu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function qi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function _s(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function ku(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(_s(arguments[e]));return t}function Wu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Ar(t){return this instanceof Ar?(this.v=t,this):new Ar(t)}function Yu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(m){i[m]&&(n[m]=function(D){return new Promise(function(w,R){s.push([m,D,w,R])>1||c(m,D)})})}function c(m,D){try{l(i[m](D))}catch(w){_(s[0][3],w)}}function l(m){m.value instanceof Ar?Promise.resolve(m.value.v).then(h,f):_(s[0][2],m)}function h(m){c("next",m)}function f(m){c("throw",m)}function _(m,D){m(D),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ju(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Ar(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Xu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof qi=="function"?qi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Zu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Qu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function eh(t){return t&&t.__esModule?t:{default:t}}function th(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function rh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var ih=Object.freeze({__proto__:null,__extends:Mu,get __assign(){return Bi},__rest:ju,__decorate:Hu,__param:Bu,__metadata:qu,__awaiter:zu,__generator:Ku,__createBinding:Vu,__exportStar:Gu,__values:qi,__read:_s,__spread:ku,__spreadArrays:Wu,__await:Ar,__asyncGenerator:Yu,__asyncDelegator:Ju,__asyncValues:Xu,__makeTemplateObject:Zu,__importStar:Qu,__importDefault:eh,__classPrivateFieldGet:th,__classPrivateFieldSet:rh}),ti=zt(ih),zi={},Cr={},bs;function nh(){if(bs)return Cr;bs=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Cr.delay=t,Cr}var Kt={},Ki={},Vt={},vs;function sh(){return vs||(vs=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.ONE_THOUSAND=Vt.ONE_HUNDRED=void 0,Vt.ONE_HUNDRED=100,Vt.ONE_THOUSAND=1e3),Vt}var Vi={},ms;function oh(){return ms||(ms=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Vi)),Vi}var ws;function Es(){return ws||(ws=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ti;e.__exportStar(sh(),t),e.__exportStar(oh(),t)}(Ki)),Ki}var Ds;function ah(){if(Ds)return Kt;Ds=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.fromMiliseconds=Kt.toMiliseconds=void 0;const t=Es();function e(i){return i*t.ONE_THOUSAND}Kt.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return Kt.fromMiliseconds=r,Kt}var Ss;function ch(){return Ss||(Ss=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ti;e.__exportStar(nh(),t),e.__exportStar(ah(),t)}(zi)),zi}var cr={},xs;function uh(){if(xs)return cr;xs=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return cr.Watch=t,cr.default=t,cr}var Gi={},Tr={},Os;function hh(){if(Os)return Tr;Os=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.IWatch=void 0;class t{}return Tr.IWatch=t,Tr}var Is;function lh(){return Is||(Is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ti.__exportStar(hh(),t)}(Gi)),Gi}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ti;e.__exportStar(ch(),t),e.__exportStar(uh(),t),e.__exportStar(lh(),t),e.__exportStar(Es(),t)})(Z);var ki={},Nr={};class Gt{}var fh=Object.freeze({__proto__:null,IEvents:Gt}),dh=zt(fh),Ps;function ph(){if(Ps)return Nr;Ps=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.IHeartBeat=void 0;const t=dh;class e extends t.IEvents{constructor(i){super()}}return Nr.IHeartBeat=e,Nr}var As;function Cs(){return As||(As=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ei.__exportStar(ph(),t)}(ki)),ki}var Wi={},kt={},Ts;function gh(){if(Ts)return kt;Ts=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.HEARTBEAT_EVENTS=kt.HEARTBEAT_INTERVAL=void 0;const t=Z;return kt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,kt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},kt}var Ns;function Rs(){return Ns||(Ns=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ei.__exportStar(gh(),t)}(Wi)),Wi}var Fs;function yh(){if(Fs)return Pr;Fs=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.HeartBeat=void 0;const t=ei,e=it.exports,r=Z,i=Cs(),n=Rs();class s extends i.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=c?.interval||n.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const l=new s(c);return yield l.init(),l})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,l){this.events.on(c,l)}once(c,l){this.events.once(c,l)}off(c,l){this.events.off(c,l)}removeListener(c,l){this.events.removeListener(c,l)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Pr.HeartBeat=s,Pr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ei;e.__exportStar(yh(),t),e.__exportStar(Cs(),t),e.__exportStar(Rs(),t)})(Or);var Se={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Yi=function(t,e){return Yi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Yi(t,e)};function _h(t,e){Yi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Ji=function(){return Ji=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ji.apply(this,arguments)};function bh(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function vh(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function mh(t,e){return function(r,i){e(r,i,t)}}function wh(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Eh(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function Dh(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Sh(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function xh(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Xi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function $s(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Oh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat($s(arguments[e]));return t}function Ih(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Rr(t){return this instanceof Rr?(this.v=t,this):new Rr(t)}function Ph(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(m){i[m]&&(n[m]=function(D){return new Promise(function(w,R){s.push([m,D,w,R])>1||c(m,D)})})}function c(m,D){try{l(i[m](D))}catch(w){_(s[0][3],w)}}function l(m){m.value instanceof Rr?Promise.resolve(m.value.v).then(h,f):_(s[0][2],m)}function h(m){c("next",m)}function f(m){c("throw",m)}function _(m,D){m(D),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ah(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Rr(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Ch(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Xi=="function"?Xi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Th(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Nh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Rh(t){return t&&t.__esModule?t:{default:t}}function Fh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function $h(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Lh=Object.freeze({__proto__:null,__extends:_h,get __assign(){return Ji},__rest:bh,__decorate:vh,__param:mh,__metadata:wh,__awaiter:Eh,__generator:Dh,__createBinding:Sh,__exportStar:xh,__values:Xi,__read:$s,__spread:Oh,__spreadArrays:Ih,__await:Rr,__asyncGenerator:Ph,__asyncDelegator:Ah,__asyncValues:Ch,__makeTemplateObject:Th,__importStar:Nh,__importDefault:Rh,__classPrivateFieldGet:Fh,__classPrivateFieldSet:$h}),Uh=zt(Lh),Wt={},Ls;function Us(){return Ls||(Ls=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PINO_CUSTOM_CONTEXT_KEY=Wt.PINO_LOGGER_DEFAULTS=void 0,Wt.PINO_LOGGER_DEFAULTS={level:"info"},Wt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Wt}var ot={},Ms;function Mh(){if(Ms)return ot;Ms=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=Us();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(c,l=t.PINO_CUSTOM_CONTEXT_KEY){return c[l]||""}ot.getBrowserLoggerContext=r;function i(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]=l,c}ot.setBrowserLoggerContext=i;function n(c,l=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof c.bindings>"u"?h=r(c,l):h=c.bindings().context||"",h}ot.getLoggerContext=n;function s(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const f=n(c,h);return f.trim()?`${f}/${l}`:l}ot.formatChildLoggerContext=s;function o(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const f=s(c,l,h),_=c.child({context:f});return i(_,f,h)}return ot.generateChildLogger=o,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Uh,r=e.__importDefault(br);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Us(),t),e.__exportStar(Mh(),t)})(Se);class jh extends Gt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class Hh extends Gt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Bh{constructor(e,r){this.logger=e,this.core=r}}class qh extends Gt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class zh extends Gt{constructor(e){super()}}class Kh{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Vh extends Gt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Gh extends Gt{constructor(e,r){super(),this.core=e,this.logger=r}}class kh{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Wh{constructor(e){this.client=e}}const Yh=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),Jh=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Zi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return Jh(t)}catch{return t}}function Fr(t){return typeof t=="string"?t:Yh(t)||""}var Qi={},ur={},ri={},ii={};Object.defineProperty(ii,"__esModule",{value:!0}),ii.BrowserRandomSource=void 0;const js=65536;class Xh{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let i=0;i<r.length;i+=js)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,js)));return r}}ii.BrowserRandomSource=Xh;function Zh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ni={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});function Qh(t){for(var e=0;e<t.length;e++)t[e]=0;return t}dt.wipe=Qh;var el={},tl=Object.freeze({__proto__:null,default:el}),rl=zt(tl);Object.defineProperty(ni,"__esModule",{value:!0}),ni.NodeRandomSource=void 0;const il=dt;class nl{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Zh<"u"){const e=rl;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,il.wipe)(r),i}}ni.NodeRandomSource=nl,Object.defineProperty(ri,"__esModule",{value:!0}),ri.SystemRandomSource=void 0;const sl=ii,ol=ni;class al{constructor(){if(this.isAvailable=!1,this.name="",this._source=new sl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ol.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ri.SystemRandomSource=al;var re={},Hs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l){var h=c>>>16&65535,f=c&65535,_=l>>>16&65535,m=l&65535;return f*m+(h*m+f*_<<16>>>0)|0}t.mul=Math.imul||e;function r(c,l){return c+l|0}t.add=r;function i(c,l){return c-l|0}t.sub=i;function n(c,l){return c<<l|c>>>32-l}t.rotl=n;function s(c,l){return c<<32-l|c>>>l}t.rotr=s;function o(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Hs),Object.defineProperty(re,"__esModule",{value:!0});var Bs=Hs;function cl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=cl;function ul(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=ul;function hl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=hl;function ll(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=ll;function qs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=qs,re.writeInt16BE=qs;function zs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=zs,re.writeInt16LE=zs;function en(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=en;function tn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=tn;function rn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=rn;function nn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=nn;function si(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=si,re.writeInt32BE=si;function oi(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=oi,re.writeInt32LE=oi;function fl(t,e){e===void 0&&(e=0);var r=en(t,e),i=en(t,e+4);return r*4294967296+i-(i>>31)*4294967296}re.readInt64BE=fl;function dl(t,e){e===void 0&&(e=0);var r=tn(t,e),i=tn(t,e+4);return r*4294967296+i}re.readUint64BE=dl;function pl(t,e){e===void 0&&(e=0);var r=rn(t,e),i=rn(t,e+4);return i*4294967296+r-(r>>31)*4294967296}re.readInt64LE=pl;function gl(t,e){e===void 0&&(e=0);var r=nn(t,e),i=nn(t,e+4);return i*4294967296+r}re.readUint64LE=gl;function Ks(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),si(t/4294967296>>>0,e,r),si(t>>>0,e,r+4),e}re.writeUint64BE=Ks,re.writeInt64BE=Ks;function Vs(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),oi(t>>>0,e,r),oi(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=Vs,re.writeInt64LE=Vs;function yl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}re.readUintBE=yl;function _l(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}re.readUintLE=_l;function bl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Bs.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}re.writeUintBE=bl;function vl(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Bs.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}re.writeUintLE=vl;function ml(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=ml;function wl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=wl;function El(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=El;function Dl(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=Dl;function Sl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}re.writeFloat32BE=Sl;function xl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}re.writeFloat32LE=xl;function Ol(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}re.writeFloat64BE=Ol;function Il(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}re.writeFloat64LE=Il,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=ri,r=re,i=dt;t.defaultRandomSource=new e.SystemRandomSource;function n(h,f=t.defaultRandomSource){return f.randomBytes(h)}t.randomBytes=n;function s(h=t.defaultRandomSource){const f=n(4,h),_=(0,r.readUint32LE)(f);return(0,i.wipe)(f),_}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(h,f=o,_=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let m="";const D=f.length,w=256-256%D;for(;h>0;){const R=n(Math.ceil(h*256/w),_);for(let F=0;F<R.length&&h>0;F++){const B=R[F];B<w&&(m+=f.charAt(B%D),h--)}(0,i.wipe)(R)}return m}t.randomString=c;function l(h,f=o,_=t.defaultRandomSource){const m=Math.ceil(h/(Math.log(f.length)/Math.LN2));return c(m,f,_)}t.randomStringForEntropy=l}(ur);var Gs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=dt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=l[f++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(f=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,l,f,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[f++],h--;return this},c.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,f=this._bufferLength,_=h/536870912|0,m=h<<3,D=h%128<112?128:256;this._buffer[f]=128;for(var w=f+1;w<D-8;w++)this._buffer[w]=0;e.writeUint32BE(_,this._buffer,D-8),e.writeUint32BE(m,this._buffer,D-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var w=0;w<this.digestLength/8;w++)e.writeUint32BE(this._stateHi[w],l,w*8),e.writeUint32BE(this._stateLo[w],l,w*8+4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._stateHi.set(l.stateHi),this._stateLo.set(l.stateLo),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.stateHi),r.wipe(l.stateLo),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,l,h,f,_,m,D){for(var w=h[0],R=h[1],F=h[2],B=h[3],x=h[4],P=h[5],y=h[6],S=h[7],E=f[0],a=f[1],d=f[2],M=f[3],q=f[4],G=f[5],J=f[6],X=f[7],g,b,L,U,N,T,j,H;D>=128;){for(var Q=0;Q<16;Q++){var z=8*Q+m;c[Q]=e.readUint32BE(_,z),l[Q]=e.readUint32BE(_,z+4)}for(var Q=0;Q<80;Q++){var ee=w,Y=R,ae=F,C=B,A=x,O=P,u=y,v=S,K=E,k=a,le=d,_e=M,de=q,me=G,Fe=J,Ce=X;if(g=S,b=X,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=(x>>>14|q<<32-14)^(x>>>18|q<<32-18)^(q>>>41-32|x<<32-(41-32)),b=(q>>>14|x<<32-14)^(q>>>18|x<<32-18)^(x>>>41-32|q<<32-(41-32)),N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,g=x&P^~x&y,b=q&G^~q&J,N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,g=n[Q*2],b=n[Q*2+1],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,g=c[Q%16],b=l[Q%16],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,L=j&65535|H<<16,U=N&65535|T<<16,g=L,b=U,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=(w>>>28|E<<32-28)^(E>>>34-32|w<<32-(34-32))^(E>>>39-32|w<<32-(39-32)),b=(E>>>28|w<<32-28)^(w>>>34-32|E<<32-(34-32))^(w>>>39-32|E<<32-(39-32)),N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,g=w&R^w&F^R&F,b=E&a^E&d^a&d,N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,v=j&65535|H<<16,Ce=N&65535|T<<16,g=C,b=_e,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=L,b=U,N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,C=j&65535|H<<16,_e=N&65535|T<<16,R=ee,F=Y,B=ae,x=C,P=A,y=O,S=u,w=v,a=K,d=k,M=le,q=_e,G=de,J=me,X=Fe,E=Ce,Q%16===15)for(var z=0;z<16;z++)g=c[z],b=l[z],N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=c[(z+9)%16],b=l[(z+9)%16],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,L=c[(z+1)%16],U=l[(z+1)%16],g=(L>>>1|U<<32-1)^(L>>>8|U<<32-8)^L>>>7,b=(U>>>1|L<<32-1)^(U>>>8|L<<32-8)^(U>>>7|L<<32-7),N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,L=c[(z+14)%16],U=l[(z+14)%16],g=(L>>>19|U<<32-19)^(U>>>61-32|L<<32-(61-32))^L>>>6,b=(U>>>19|L<<32-19)^(L>>>61-32|U<<32-(61-32))^(U>>>6|L<<32-6),N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,c[z]=j&65535|H<<16,l[z]=N&65535|T<<16}g=w,b=E,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[0],b=f[0],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[0]=w=j&65535|H<<16,f[0]=E=N&65535|T<<16,g=R,b=a,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[1],b=f[1],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[1]=R=j&65535|H<<16,f[1]=a=N&65535|T<<16,g=F,b=d,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[2],b=f[2],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[2]=F=j&65535|H<<16,f[2]=d=N&65535|T<<16,g=B,b=M,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[3],b=f[3],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[3]=B=j&65535|H<<16,f[3]=M=N&65535|T<<16,g=x,b=q,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[4],b=f[4],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[4]=x=j&65535|H<<16,f[4]=q=N&65535|T<<16,g=P,b=G,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[5],b=f[5],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[5]=P=j&65535|H<<16,f[5]=G=N&65535|T<<16,g=y,b=J,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[6],b=f[6],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[6]=y=j&65535|H<<16,f[6]=J=N&65535|T<<16,g=S,b=X,N=b&65535,T=b>>>16,j=g&65535,H=g>>>16,g=h[7],b=f[7],N+=b&65535,T+=b>>>16,j+=g&65535,H+=g>>>16,T+=N>>>16,j+=T>>>16,H+=j>>>16,h[7]=S=j&65535|H<<16,f[7]=X=N&65535|T<<16,m+=128,D-=128}return m}function o(c){var l=new i;l.update(c);var h=l.digest();return l.clean(),h}t.hash=o})(Gs),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=ur,r=Gs,i=dt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(C){const A=new Float64Array(16);if(C)for(let O=0;O<C.length;O++)A[O]=C[O];return A}const s=new Uint8Array(32);s[0]=9;const o=n(),c=n([1]),l=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),m=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(C,A){for(let O=0;O<16;O++)C[O]=A[O]|0}function w(C){let A=1;for(let O=0;O<16;O++){let u=C[O]+A+65535;A=Math.floor(u/65536),C[O]=u-A*65536}C[0]+=A-1+37*(A-1)}function R(C,A,O){const u=~(O-1);for(let v=0;v<16;v++){const K=u&(C[v]^A[v]);C[v]^=K,A[v]^=K}}function F(C,A){const O=n(),u=n();for(let v=0;v<16;v++)u[v]=A[v];w(u),w(u),w(u);for(let v=0;v<2;v++){O[0]=u[0]-65517;for(let k=1;k<15;k++)O[k]=u[k]-65535-(O[k-1]>>16&1),O[k-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const K=O[15]>>16&1;O[14]&=65535,R(u,O,1-K)}for(let v=0;v<16;v++)C[2*v]=u[v]&255,C[2*v+1]=u[v]>>8}function B(C,A){let O=0;for(let u=0;u<32;u++)O|=C[u]^A[u];return(1&O-1>>>8)-1}function x(C,A){const O=new Uint8Array(32),u=new Uint8Array(32);return F(O,C),F(u,A),B(O,u)}function P(C){const A=new Uint8Array(32);return F(A,C),A[0]&1}function y(C,A){for(let O=0;O<16;O++)C[O]=A[2*O]+(A[2*O+1]<<8);C[15]&=32767}function S(C,A,O){for(let u=0;u<16;u++)C[u]=A[u]+O[u]}function E(C,A,O){for(let u=0;u<16;u++)C[u]=A[u]-O[u]}function a(C,A,O){let u,v,K=0,k=0,le=0,_e=0,de=0,me=0,Fe=0,Ce=0,ye=0,pe=0,fe=0,ue=0,ce=0,oe=0,se=0,te=0,he=0,ge=0,ie=0,be=0,ve=0,Ee=0,De=0,we=0,wt=0,At=0,Mt=0,pt=0,er=0,Gr=0,Si=0,Ue=O[0],Te=O[1],Me=O[2],je=O[3],He=O[4],Ne=O[5],Ge=O[6],ke=O[7],We=O[8],Ye=O[9],Je=O[10],qe=O[11],Be=O[12],Pe=O[13],Xe=O[14],Ze=O[15];u=A[0],K+=u*Ue,k+=u*Te,le+=u*Me,_e+=u*je,de+=u*He,me+=u*Ne,Fe+=u*Ge,Ce+=u*ke,ye+=u*We,pe+=u*Ye,fe+=u*Je,ue+=u*qe,ce+=u*Be,oe+=u*Pe,se+=u*Xe,te+=u*Ze,u=A[1],k+=u*Ue,le+=u*Te,_e+=u*Me,de+=u*je,me+=u*He,Fe+=u*Ne,Ce+=u*Ge,ye+=u*ke,pe+=u*We,fe+=u*Ye,ue+=u*Je,ce+=u*qe,oe+=u*Be,se+=u*Pe,te+=u*Xe,he+=u*Ze,u=A[2],le+=u*Ue,_e+=u*Te,de+=u*Me,me+=u*je,Fe+=u*He,Ce+=u*Ne,ye+=u*Ge,pe+=u*ke,fe+=u*We,ue+=u*Ye,ce+=u*Je,oe+=u*qe,se+=u*Be,te+=u*Pe,he+=u*Xe,ge+=u*Ze,u=A[3],_e+=u*Ue,de+=u*Te,me+=u*Me,Fe+=u*je,Ce+=u*He,ye+=u*Ne,pe+=u*Ge,fe+=u*ke,ue+=u*We,ce+=u*Ye,oe+=u*Je,se+=u*qe,te+=u*Be,he+=u*Pe,ge+=u*Xe,ie+=u*Ze,u=A[4],de+=u*Ue,me+=u*Te,Fe+=u*Me,Ce+=u*je,ye+=u*He,pe+=u*Ne,fe+=u*Ge,ue+=u*ke,ce+=u*We,oe+=u*Ye,se+=u*Je,te+=u*qe,he+=u*Be,ge+=u*Pe,ie+=u*Xe,be+=u*Ze,u=A[5],me+=u*Ue,Fe+=u*Te,Ce+=u*Me,ye+=u*je,pe+=u*He,fe+=u*Ne,ue+=u*Ge,ce+=u*ke,oe+=u*We,se+=u*Ye,te+=u*Je,he+=u*qe,ge+=u*Be,ie+=u*Pe,be+=u*Xe,ve+=u*Ze,u=A[6],Fe+=u*Ue,Ce+=u*Te,ye+=u*Me,pe+=u*je,fe+=u*He,ue+=u*Ne,ce+=u*Ge,oe+=u*ke,se+=u*We,te+=u*Ye,he+=u*Je,ge+=u*qe,ie+=u*Be,be+=u*Pe,ve+=u*Xe,Ee+=u*Ze,u=A[7],Ce+=u*Ue,ye+=u*Te,pe+=u*Me,fe+=u*je,ue+=u*He,ce+=u*Ne,oe+=u*Ge,se+=u*ke,te+=u*We,he+=u*Ye,ge+=u*Je,ie+=u*qe,be+=u*Be,ve+=u*Pe,Ee+=u*Xe,De+=u*Ze,u=A[8],ye+=u*Ue,pe+=u*Te,fe+=u*Me,ue+=u*je,ce+=u*He,oe+=u*Ne,se+=u*Ge,te+=u*ke,he+=u*We,ge+=u*Ye,ie+=u*Je,be+=u*qe,ve+=u*Be,Ee+=u*Pe,De+=u*Xe,we+=u*Ze,u=A[9],pe+=u*Ue,fe+=u*Te,ue+=u*Me,ce+=u*je,oe+=u*He,se+=u*Ne,te+=u*Ge,he+=u*ke,ge+=u*We,ie+=u*Ye,be+=u*Je,ve+=u*qe,Ee+=u*Be,De+=u*Pe,we+=u*Xe,wt+=u*Ze,u=A[10],fe+=u*Ue,ue+=u*Te,ce+=u*Me,oe+=u*je,se+=u*He,te+=u*Ne,he+=u*Ge,ge+=u*ke,ie+=u*We,be+=u*Ye,ve+=u*Je,Ee+=u*qe,De+=u*Be,we+=u*Pe,wt+=u*Xe,At+=u*Ze,u=A[11],ue+=u*Ue,ce+=u*Te,oe+=u*Me,se+=u*je,te+=u*He,he+=u*Ne,ge+=u*Ge,ie+=u*ke,be+=u*We,ve+=u*Ye,Ee+=u*Je,De+=u*qe,we+=u*Be,wt+=u*Pe,At+=u*Xe,Mt+=u*Ze,u=A[12],ce+=u*Ue,oe+=u*Te,se+=u*Me,te+=u*je,he+=u*He,ge+=u*Ne,ie+=u*Ge,be+=u*ke,ve+=u*We,Ee+=u*Ye,De+=u*Je,we+=u*qe,wt+=u*Be,At+=u*Pe,Mt+=u*Xe,pt+=u*Ze,u=A[13],oe+=u*Ue,se+=u*Te,te+=u*Me,he+=u*je,ge+=u*He,ie+=u*Ne,be+=u*Ge,ve+=u*ke,Ee+=u*We,De+=u*Ye,we+=u*Je,wt+=u*qe,At+=u*Be,Mt+=u*Pe,pt+=u*Xe,er+=u*Ze,u=A[14],se+=u*Ue,te+=u*Te,he+=u*Me,ge+=u*je,ie+=u*He,be+=u*Ne,ve+=u*Ge,Ee+=u*ke,De+=u*We,we+=u*Ye,wt+=u*Je,At+=u*qe,Mt+=u*Be,pt+=u*Pe,er+=u*Xe,Gr+=u*Ze,u=A[15],te+=u*Ue,he+=u*Te,ge+=u*Me,ie+=u*je,be+=u*He,ve+=u*Ne,Ee+=u*Ge,De+=u*ke,we+=u*We,wt+=u*Ye,At+=u*Je,Mt+=u*qe,pt+=u*Be,er+=u*Pe,Gr+=u*Xe,Si+=u*Ze,K+=38*he,k+=38*ge,le+=38*ie,_e+=38*be,de+=38*ve,me+=38*Ee,Fe+=38*De,Ce+=38*we,ye+=38*wt,pe+=38*At,fe+=38*Mt,ue+=38*pt,ce+=38*er,oe+=38*Gr,se+=38*Si,v=1,u=K+v+65535,v=Math.floor(u/65536),K=u-v*65536,u=k+v+65535,v=Math.floor(u/65536),k=u-v*65536,u=le+v+65535,v=Math.floor(u/65536),le=u-v*65536,u=_e+v+65535,v=Math.floor(u/65536),_e=u-v*65536,u=de+v+65535,v=Math.floor(u/65536),de=u-v*65536,u=me+v+65535,v=Math.floor(u/65536),me=u-v*65536,u=Fe+v+65535,v=Math.floor(u/65536),Fe=u-v*65536,u=Ce+v+65535,v=Math.floor(u/65536),Ce=u-v*65536,u=ye+v+65535,v=Math.floor(u/65536),ye=u-v*65536,u=pe+v+65535,v=Math.floor(u/65536),pe=u-v*65536,u=fe+v+65535,v=Math.floor(u/65536),fe=u-v*65536,u=ue+v+65535,v=Math.floor(u/65536),ue=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=oe+v+65535,v=Math.floor(u/65536),oe=u-v*65536,u=se+v+65535,v=Math.floor(u/65536),se=u-v*65536,u=te+v+65535,v=Math.floor(u/65536),te=u-v*65536,K+=v-1+37*(v-1),v=1,u=K+v+65535,v=Math.floor(u/65536),K=u-v*65536,u=k+v+65535,v=Math.floor(u/65536),k=u-v*65536,u=le+v+65535,v=Math.floor(u/65536),le=u-v*65536,u=_e+v+65535,v=Math.floor(u/65536),_e=u-v*65536,u=de+v+65535,v=Math.floor(u/65536),de=u-v*65536,u=me+v+65535,v=Math.floor(u/65536),me=u-v*65536,u=Fe+v+65535,v=Math.floor(u/65536),Fe=u-v*65536,u=Ce+v+65535,v=Math.floor(u/65536),Ce=u-v*65536,u=ye+v+65535,v=Math.floor(u/65536),ye=u-v*65536,u=pe+v+65535,v=Math.floor(u/65536),pe=u-v*65536,u=fe+v+65535,v=Math.floor(u/65536),fe=u-v*65536,u=ue+v+65535,v=Math.floor(u/65536),ue=u-v*65536,u=ce+v+65535,v=Math.floor(u/65536),ce=u-v*65536,u=oe+v+65535,v=Math.floor(u/65536),oe=u-v*65536,u=se+v+65535,v=Math.floor(u/65536),se=u-v*65536,u=te+v+65535,v=Math.floor(u/65536),te=u-v*65536,K+=v-1+37*(v-1),C[0]=K,C[1]=k,C[2]=le,C[3]=_e,C[4]=de,C[5]=me,C[6]=Fe,C[7]=Ce,C[8]=ye,C[9]=pe,C[10]=fe,C[11]=ue,C[12]=ce,C[13]=oe,C[14]=se,C[15]=te}function d(C,A){a(C,A,A)}function M(C,A){const O=n();let u;for(u=0;u<16;u++)O[u]=A[u];for(u=253;u>=0;u--)d(O,O),u!==2&&u!==4&&a(O,O,A);for(u=0;u<16;u++)C[u]=O[u]}function q(C,A){const O=n();let u;for(u=0;u<16;u++)O[u]=A[u];for(u=250;u>=0;u--)d(O,O),u!==1&&a(O,O,A);for(u=0;u<16;u++)C[u]=O[u]}function G(C,A){const O=n(),u=n(),v=n(),K=n(),k=n(),le=n(),_e=n(),de=n(),me=n();E(O,C[1],C[0]),E(me,A[1],A[0]),a(O,O,me),S(u,C[0],C[1]),S(me,A[0],A[1]),a(u,u,me),a(v,C[3],A[3]),a(v,v,h),a(K,C[2],A[2]),S(K,K,K),E(k,u,O),E(le,K,v),S(_e,K,v),S(de,u,O),a(C[0],k,le),a(C[1],de,_e),a(C[2],_e,le),a(C[3],k,de)}function J(C,A,O){for(let u=0;u<4;u++)R(C[u],A[u],O)}function X(C,A){const O=n(),u=n(),v=n();M(v,A[2]),a(O,A[0],v),a(u,A[1],v),F(C,u),C[31]^=P(O)<<7}function g(C,A,O){D(C[0],o),D(C[1],c),D(C[2],c),D(C[3],o);for(let u=255;u>=0;--u){const v=O[u/8|0]>>(u&7)&1;J(C,A,v),G(A,C),G(C,C),J(C,A,v)}}function b(C,A){const O=[n(),n(),n(),n()];D(O[0],f),D(O[1],_),D(O[2],c),a(O[3],f,_),g(C,O,A)}function L(C){if(C.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const A=(0,r.hash)(C);A[0]&=248,A[31]&=127,A[31]|=64;const O=new Uint8Array(32),u=[n(),n(),n(),n()];b(u,A),X(O,u);const v=new Uint8Array(64);return v.set(C),v.set(O,32),{publicKey:O,secretKey:v}}t.generateKeyPairFromSeed=L;function U(C){const A=(0,e.randomBytes)(32,C),O=L(A);return(0,i.wipe)(A),O}t.generateKeyPair=U;function N(C){if(C.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(C.subarray(32))}t.extractPublicKeyFromSecretKey=N;const T=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(C,A){let O,u,v,K;for(u=63;u>=32;--u){for(O=0,v=u-32,K=u-12;v<K;++v)A[v]+=O-16*A[u]*T[v-(u-32)],O=Math.floor((A[v]+128)/256),A[v]-=O*256;A[v]+=O,A[u]=0}for(O=0,v=0;v<32;v++)A[v]+=O-(A[31]>>4)*T[v],O=A[v]>>8,A[v]&=255;for(v=0;v<32;v++)A[v]-=O*T[v];for(u=0;u<32;u++)A[u+1]+=A[u]>>8,C[u]=A[u]&255}function H(C){const A=new Float64Array(64);for(let O=0;O<64;O++)A[O]=C[O];for(let O=0;O<64;O++)C[O]=0;j(C,A)}function Q(C,A){const O=new Float64Array(64),u=[n(),n(),n(),n()],v=(0,r.hash)(C.subarray(0,32));v[0]&=248,v[31]&=127,v[31]|=64;const K=new Uint8Array(64);K.set(v.subarray(32),32);const k=new r.SHA512;k.update(K.subarray(32)),k.update(A);const le=k.digest();k.clean(),H(le),b(u,le),X(K,u),k.reset(),k.update(K.subarray(0,32)),k.update(C.subarray(32)),k.update(A);const _e=k.digest();H(_e);for(let de=0;de<32;de++)O[de]=le[de];for(let de=0;de<32;de++)for(let me=0;me<32;me++)O[de+me]+=_e[de]*v[me];return j(K.subarray(32),O),K}t.sign=Q;function z(C,A){const O=n(),u=n(),v=n(),K=n(),k=n(),le=n(),_e=n();return D(C[2],c),y(C[1],A),d(v,C[1]),a(K,v,l),E(v,v,C[2]),S(K,C[2],K),d(k,K),d(le,k),a(_e,le,k),a(O,_e,v),a(O,O,K),q(O,O),a(O,O,v),a(O,O,K),a(O,O,K),a(C[0],O,K),d(u,C[0]),a(u,u,K),x(u,v)&&a(C[0],C[0],m),d(u,C[0]),a(u,u,K),x(u,v)?-1:(P(C[0])===A[31]>>7&&E(C[0],o,C[0]),a(C[3],C[0],C[1]),0)}function ee(C,A,O){const u=new Uint8Array(32),v=[n(),n(),n(),n()],K=[n(),n(),n(),n()];if(O.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(z(K,C))return!1;const k=new r.SHA512;k.update(O.subarray(0,32)),k.update(C),k.update(A);const le=k.digest();return H(le),g(v,K,le),b(K,O.subarray(32)),G(v,K),X(u,v),!B(O,u)}t.verify=ee;function Y(C){let A=[n(),n(),n(),n()];if(z(A,C))throw new Error("Ed25519: invalid public key");let O=n(),u=n(),v=A[1];S(O,c,v),E(u,c,v),M(u,u),a(O,O,u);let K=new Uint8Array(32);return F(K,O),K}t.convertPublicKeyToX25519=Y;function ae(C){const A=(0,r.hash)(C.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const O=new Uint8Array(A.subarray(0,32));return(0,i.wipe)(A),O}t.convertSecretKeyToX25519=ae}(Qi);const Pl="EdDSA",Al="JWT",ks=".",Ws="base64url",Cl="utf8",Tl="utf8",Nl=":",Rl="did",Fl="key",Ys="base58btc",$l="z",Ll="K36",Ul=32;function Js(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function sn(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Js(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function Ml(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var c=t.length,l=t.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function _(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var R=0,F=0,B=0,x=w.length;B!==x&&w[B]===0;)B++,R++;for(var P=(x-B)*f+1>>>0,y=new Uint8Array(P);B!==x;){for(var S=w[B],E=0,a=P-1;(S!==0||E<F)&&a!==-1;a--,E++)S+=256*y[a]>>>0,y[a]=S%c>>>0,S=S/c>>>0;if(S!==0)throw new Error("Non-zero carry");F=E,B++}for(var d=P-F;d!==P&&y[d]===0;)d++;for(var M=l.repeat(R);d<P;++d)M+=t.charAt(y[d]);return M}function m(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var R=0;if(w[R]!==" "){for(var F=0,B=0;w[R]===l;)F++,R++;for(var x=(w.length-R)*h+1>>>0,P=new Uint8Array(x);w[R];){var y=r[w.charCodeAt(R)];if(y===255)return;for(var S=0,E=x-1;(y!==0||S<B)&&E!==-1;E--,S++)y+=c*P[E]>>>0,P[E]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");B=S,R++}if(w[R]!==" "){for(var a=x-B;a!==x&&P[a]===0;)a++;for(var d=new Uint8Array(F+(x-a)),M=F;a!==x;)d[M++]=P[a++];return d}}}function D(w){var R=m(w);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:m,decode:D}}var jl=Ml,Hl=jl;const Xs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Bl=t=>new TextEncoder().encode(t),ql=t=>new TextDecoder().decode(t);class zl{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Kl{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Zs(this,e)}}class Vl{constructor(e){this.decoders=e}or(e){return Zs(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Zs=(t,e)=>new Vl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Gl{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new zl(e,r,i),this.decoder=new Kl(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ai=({name:t,prefix:e,encode:r,decode:i})=>new Gl(t,e,r,i),$r=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=Hl(r,e);return ai({prefix:t,name:e,encode:i,decode:s=>Xs(n(s))})},kl=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,l=0,h=0;for(let f=0;f<s;++f){const _=n[t[f]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);l=l<<r|_,c+=r,c>=8&&(c-=8,o[h++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},Wl=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>r;)o-=r,s+=e[n&c>>o];if(o&&(s+=e[n&c<<r-o]),i)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>ai({prefix:e,name:t,encode(n){return Wl(n,i,r)},decode(n){return kl(n,i,r,t)}}),Yl=ai({prefix:"\0",name:"identity",encode:t=>ql(t),decode:t=>Bl(t)});var Jl=Object.freeze({__proto__:null,identity:Yl});const Xl=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Zl=Object.freeze({__proto__:null,base2:Xl});const Ql=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ef=Object.freeze({__proto__:null,base8:Ql});const tf=$r({prefix:"9",name:"base10",alphabet:"0123456789"});var rf=Object.freeze({__proto__:null,base10:tf});const nf=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sf=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var of=Object.freeze({__proto__:null,base16:nf,base16upper:sf});const af=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),cf=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),uf=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hf=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),lf=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ff=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),df=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pf=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gf=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var yf=Object.freeze({__proto__:null,base32:af,base32upper:cf,base32pad:uf,base32padupper:hf,base32hex:lf,base32hexupper:ff,base32hexpad:df,base32hexpadupper:pf,base32z:gf});const _f=$r({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),bf=$r({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var vf=Object.freeze({__proto__:null,base36:_f,base36upper:bf});const mf=$r({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wf=$r({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ef=Object.freeze({__proto__:null,base58btc:mf,base58flickr:wf});const Df=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Sf=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xf=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Of=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var If=Object.freeze({__proto__:null,base64:Df,base64pad:Sf,base64url:xf,base64urlpad:Of});const Qs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Pf=Qs.reduce((t,e,r)=>(t[r]=e,t),[]),Af=Qs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Cf(t){return t.reduce((e,r)=>(e+=Pf[r],e),"")}function Tf(t){const e=[];for(const r of t){const i=Af[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const Nf=ai({prefix:"\u{1F680}",name:"base256emoji",encode:Cf,decode:Tf});var Rf=Object.freeze({__proto__:null,base256emoji:Nf}),Ff=to,eo=128,$f=127,Lf=~$f,Uf=Math.pow(2,31);function to(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Uf;)e[r++]=t&255|eo,t/=128;for(;t&Lf;)e[r++]=t&255|eo,t>>>=7;return e[r]=t|0,to.bytes=r-i+1,e}var Mf=on,jf=128,ro=127;function on(t,i){var r=0,i=i||0,n=0,s=i,o,c=t.length;do{if(s>=c)throw on.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&ro)<<n:(o&ro)*Math.pow(2,n),n+=7}while(o>=jf);return on.bytes=s-i,r}var Hf=Math.pow(2,7),Bf=Math.pow(2,14),qf=Math.pow(2,21),zf=Math.pow(2,28),Kf=Math.pow(2,35),Vf=Math.pow(2,42),Gf=Math.pow(2,49),kf=Math.pow(2,56),Wf=Math.pow(2,63),Yf=function(t){return t<Hf?1:t<Bf?2:t<qf?3:t<zf?4:t<Kf?5:t<Vf?6:t<Gf?7:t<kf?8:t<Wf?9:10},Jf={encode:Ff,decode:Mf,encodingLength:Yf},io=Jf;const no=(t,e,r=0)=>(io.encode(t,e,r),e),so=t=>io.encodingLength(t),an=(t,e)=>{const r=e.byteLength,i=so(t),n=i+so(r),s=new Uint8Array(n+r);return no(t,s,0),no(r,s,i),s.set(e,n),new Xf(t,r,e,s)};class Xf{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const oo=({name:t,code:e,encode:r})=>new Zf(t,e,r);class Zf{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?an(this.code,r):r.then(i=>an(this.code,i))}else throw Error("Unknown type, must be binary type")}}const ao=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Qf=oo({name:"sha2-256",code:18,encode:ao("SHA-256")}),ed=oo({name:"sha2-512",code:19,encode:ao("SHA-512")});var td=Object.freeze({__proto__:null,sha256:Qf,sha512:ed});const co=0,rd="identity",uo=Xs;var id=Object.freeze({__proto__:null,identity:{code:co,name:rd,encode:uo,digest:t=>an(co,uo(t))}});new TextEncoder,new TextDecoder;const ho={...Jl,...Zl,...ef,...rf,...of,...yf,...vf,...Ef,...If,...Rf};({...td,...id});function lo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const fo=lo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),cn=lo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Js(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),po={utf8:fo,"utf-8":fo,hex:ho.base16,latin1:cn,ascii:cn,binary:cn,...ho};function at(t,e="utf8"){const r=po[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function lt(t,e="utf8"){const r=po[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function ci(t){return at(lt(Fr(t),Cl),Ws)}function go(t){const e=lt(Ll,Ys),r=$l+at(sn([e,t]),Ys);return[Rl,Fl,r].join(Nl)}function nd(t){return at(t,Ws)}function sd(t){return lt([ci(t.header),ci(t.payload)].join(ks),Tl)}function od(t){return[ci(t.header),ci(t.payload),nd(t.signature)].join(ks)}function yo(t=ur.randomBytes(Ul)){return Qi.generateKeyPairFromSeed(t)}async function ad(t,e,r,i,n=Z.fromMiliseconds(Date.now())){const s={alg:Pl,typ:Al},o=go(i.publicKey),c=n+r,l={iss:o,sub:t,aud:e,iat:n,exp:c},h=sd({header:s,payload:l}),f=Qi.sign(i.secretKey,h);return od({header:s,payload:l,signature:f})}var un={},ui={};Object.defineProperty(ui,"__esModule",{value:!0});var nt=re,hn=dt,cd=20;function ud(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],_=r[19]<<24|r[18]<<16|r[17]<<8|r[16],m=r[23]<<24|r[22]<<16|r[21]<<8|r[20],D=r[27]<<24|r[26]<<16|r[25]<<8|r[24],w=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],F=e[7]<<24|e[6]<<16|e[5]<<8|e[4],B=e[11]<<24|e[10]<<16|e[9]<<8|e[8],x=e[15]<<24|e[14]<<16|e[13]<<8|e[12],P=i,y=n,S=s,E=o,a=c,d=l,M=h,q=f,G=_,J=m,X=D,g=w,b=R,L=F,U=B,N=x,T=0;T<cd;T+=2)P=P+a|0,b^=P,b=b>>>32-16|b<<16,G=G+b|0,a^=G,a=a>>>32-12|a<<12,y=y+d|0,L^=y,L=L>>>32-16|L<<16,J=J+L|0,d^=J,d=d>>>32-12|d<<12,S=S+M|0,U^=S,U=U>>>32-16|U<<16,X=X+U|0,M^=X,M=M>>>32-12|M<<12,E=E+q|0,N^=E,N=N>>>32-16|N<<16,g=g+N|0,q^=g,q=q>>>32-12|q<<12,S=S+M|0,U^=S,U=U>>>32-8|U<<8,X=X+U|0,M^=X,M=M>>>32-7|M<<7,E=E+q|0,N^=E,N=N>>>32-8|N<<8,g=g+N|0,q^=g,q=q>>>32-7|q<<7,y=y+d|0,L^=y,L=L>>>32-8|L<<8,J=J+L|0,d^=J,d=d>>>32-7|d<<7,P=P+a|0,b^=P,b=b>>>32-8|b<<8,G=G+b|0,a^=G,a=a>>>32-7|a<<7,P=P+d|0,N^=P,N=N>>>32-16|N<<16,X=X+N|0,d^=X,d=d>>>32-12|d<<12,y=y+M|0,b^=y,b=b>>>32-16|b<<16,g=g+b|0,M^=g,M=M>>>32-12|M<<12,S=S+q|0,L^=S,L=L>>>32-16|L<<16,G=G+L|0,q^=G,q=q>>>32-12|q<<12,E=E+a|0,U^=E,U=U>>>32-16|U<<16,J=J+U|0,a^=J,a=a>>>32-12|a<<12,S=S+q|0,L^=S,L=L>>>32-8|L<<8,G=G+L|0,q^=G,q=q>>>32-7|q<<7,E=E+a|0,U^=E,U=U>>>32-8|U<<8,J=J+U|0,a^=J,a=a>>>32-7|a<<7,y=y+M|0,b^=y,b=b>>>32-8|b<<8,g=g+b|0,M^=g,M=M>>>32-7|M<<7,P=P+d|0,N^=P,N=N>>>32-8|N<<8,X=X+N|0,d^=X,d=d>>>32-7|d<<7;nt.writeUint32LE(P+i|0,t,0),nt.writeUint32LE(y+n|0,t,4),nt.writeUint32LE(S+s|0,t,8),nt.writeUint32LE(E+o|0,t,12),nt.writeUint32LE(a+c|0,t,16),nt.writeUint32LE(d+l|0,t,20),nt.writeUint32LE(M+h|0,t,24),nt.writeUint32LE(q+f|0,t,28),nt.writeUint32LE(G+_|0,t,32),nt.writeUint32LE(J+m|0,t,36),nt.writeUint32LE(X+D|0,t,40),nt.writeUint32LE(g+w|0,t,44),nt.writeUint32LE(b+R|0,t,48),nt.writeUint32LE(L+F|0,t,52),nt.writeUint32LE(U+B|0,t,56),nt.writeUint32LE(N+x|0,t,60)}function _o(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var c=new Uint8Array(64),l=0;l<r.length;l+=64){ud(c,s,t);for(var h=l;h<l+64&&h<r.length;h++)i[h]=r[h]^c[h-l];ld(s,0,o)}return hn.wipe(c),n===0&&hn.wipe(s),i}ui.streamXOR=_o;function hd(t,e,r,i){return i===void 0&&(i=0),hn.wipe(r),_o(t,e,r,r,i)}ui.stream=hd;function ld(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var bo={},$t={};Object.defineProperty($t,"__esModule",{value:!0});function fd(t,e,r){return~(t-1)&e|t-1&r}$t.select=fd;function dd(t,e){return(t|0)-(e|0)-1>>>31&1}$t.lessOrEqual=dd;function vo(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}$t.compare=vo;function pd(t,e){return t.length===0||e.length===0?!1:vo(t,e)!==0}$t.equal=pd,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=$t,r=dt;t.DIGEST_LENGTH=16;var i=function(){function o(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=c[0]|c[1]<<8;this._r[0]=l&8191;var h=c[2]|c[3]<<8;this._r[1]=(l>>>13|h<<3)&8191;var f=c[4]|c[5]<<8;this._r[2]=(h>>>10|f<<6)&7939;var _=c[6]|c[7]<<8;this._r[3]=(f>>>7|_<<9)&8191;var m=c[8]|c[9]<<8;this._r[4]=(_>>>4|m<<12)&255,this._r[5]=m>>>1&8190;var D=c[10]|c[11]<<8;this._r[6]=(m>>>14|D<<2)&8191;var w=c[12]|c[13]<<8;this._r[7]=(D>>>11|w<<5)&8065;var R=c[14]|c[15]<<8;this._r[8]=(w>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return o.prototype._blocks=function(c,l,h){for(var f=this._fin?0:2048,_=this._h[0],m=this._h[1],D=this._h[2],w=this._h[3],R=this._h[4],F=this._h[5],B=this._h[6],x=this._h[7],P=this._h[8],y=this._h[9],S=this._r[0],E=this._r[1],a=this._r[2],d=this._r[3],M=this._r[4],q=this._r[5],G=this._r[6],J=this._r[7],X=this._r[8],g=this._r[9];h>=16;){var b=c[l+0]|c[l+1]<<8;_+=b&8191;var L=c[l+2]|c[l+3]<<8;m+=(b>>>13|L<<3)&8191;var U=c[l+4]|c[l+5]<<8;D+=(L>>>10|U<<6)&8191;var N=c[l+6]|c[l+7]<<8;w+=(U>>>7|N<<9)&8191;var T=c[l+8]|c[l+9]<<8;R+=(N>>>4|T<<12)&8191,F+=T>>>1&8191;var j=c[l+10]|c[l+11]<<8;B+=(T>>>14|j<<2)&8191;var H=c[l+12]|c[l+13]<<8;x+=(j>>>11|H<<5)&8191;var Q=c[l+14]|c[l+15]<<8;P+=(H>>>8|Q<<8)&8191,y+=Q>>>5|f;var z=0,ee=z;ee+=_*S,ee+=m*(5*g),ee+=D*(5*X),ee+=w*(5*J),ee+=R*(5*G),z=ee>>>13,ee&=8191,ee+=F*(5*q),ee+=B*(5*M),ee+=x*(5*d),ee+=P*(5*a),ee+=y*(5*E),z+=ee>>>13,ee&=8191;var Y=z;Y+=_*E,Y+=m*S,Y+=D*(5*g),Y+=w*(5*X),Y+=R*(5*J),z=Y>>>13,Y&=8191,Y+=F*(5*G),Y+=B*(5*q),Y+=x*(5*M),Y+=P*(5*d),Y+=y*(5*a),z+=Y>>>13,Y&=8191;var ae=z;ae+=_*a,ae+=m*E,ae+=D*S,ae+=w*(5*g),ae+=R*(5*X),z=ae>>>13,ae&=8191,ae+=F*(5*J),ae+=B*(5*G),ae+=x*(5*q),ae+=P*(5*M),ae+=y*(5*d),z+=ae>>>13,ae&=8191;var C=z;C+=_*d,C+=m*a,C+=D*E,C+=w*S,C+=R*(5*g),z=C>>>13,C&=8191,C+=F*(5*X),C+=B*(5*J),C+=x*(5*G),C+=P*(5*q),C+=y*(5*M),z+=C>>>13,C&=8191;var A=z;A+=_*M,A+=m*d,A+=D*a,A+=w*E,A+=R*S,z=A>>>13,A&=8191,A+=F*(5*g),A+=B*(5*X),A+=x*(5*J),A+=P*(5*G),A+=y*(5*q),z+=A>>>13,A&=8191;var O=z;O+=_*q,O+=m*M,O+=D*d,O+=w*a,O+=R*E,z=O>>>13,O&=8191,O+=F*S,O+=B*(5*g),O+=x*(5*X),O+=P*(5*J),O+=y*(5*G),z+=O>>>13,O&=8191;var u=z;u+=_*G,u+=m*q,u+=D*M,u+=w*d,u+=R*a,z=u>>>13,u&=8191,u+=F*E,u+=B*S,u+=x*(5*g),u+=P*(5*X),u+=y*(5*J),z+=u>>>13,u&=8191;var v=z;v+=_*J,v+=m*G,v+=D*q,v+=w*M,v+=R*d,z=v>>>13,v&=8191,v+=F*a,v+=B*E,v+=x*S,v+=P*(5*g),v+=y*(5*X),z+=v>>>13,v&=8191;var K=z;K+=_*X,K+=m*J,K+=D*G,K+=w*q,K+=R*M,z=K>>>13,K&=8191,K+=F*d,K+=B*a,K+=x*E,K+=P*S,K+=y*(5*g),z+=K>>>13,K&=8191;var k=z;k+=_*g,k+=m*X,k+=D*J,k+=w*G,k+=R*q,z=k>>>13,k&=8191,k+=F*M,k+=B*d,k+=x*a,k+=P*E,k+=y*S,z+=k>>>13,k&=8191,z=(z<<2)+z|0,z=z+ee|0,ee=z&8191,z=z>>>13,Y+=z,_=ee,m=Y,D=ae,w=C,R=A,F=O,B=u,x=v,P=K,y=k,l+=16,h-=16}this._h[0]=_,this._h[1]=m,this._h[2]=D,this._h[3]=w,this._h[4]=R,this._h[5]=F,this._h[6]=B,this._h[7]=x,this._h[8]=P,this._h[9]=y},o.prototype.finish=function(c,l){l===void 0&&(l=0);var h=new Uint16Array(10),f,_,m,D;if(this._leftover){for(D=this._leftover,this._buffer[D++]=1;D<16;D++)this._buffer[D]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,D=2;D<10;D++)this._h[D]+=f,f=this._h[D]>>>13,this._h[D]&=8191;for(this._h[0]+=f*5,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,h[0]=this._h[0]+5,f=h[0]>>>13,h[0]&=8191,D=1;D<10;D++)h[D]=this._h[D]+f,f=h[D]>>>13,h[D]&=8191;for(h[9]-=1<<13,_=(f^1)-1,D=0;D<10;D++)h[D]&=_;for(_=~_,D=0;D<10;D++)this._h[D]=this._h[D]&_|h[D];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,m=this._h[0]+this._pad[0],this._h[0]=m&65535,D=1;D<8;D++)m=(this._h[D]+this._pad[D]|0)+(m>>>16)|0,this._h[D]=m&65535;return c[l+0]=this._h[0]>>>0,c[l+1]=this._h[0]>>>8,c[l+2]=this._h[1]>>>0,c[l+3]=this._h[1]>>>8,c[l+4]=this._h[2]>>>0,c[l+5]=this._h[2]>>>8,c[l+6]=this._h[3]>>>0,c[l+7]=this._h[3]>>>8,c[l+8]=this._h[4]>>>0,c[l+9]=this._h[4]>>>8,c[l+10]=this._h[5]>>>0,c[l+11]=this._h[5]>>>8,c[l+12]=this._h[6]>>>0,c[l+13]=this._h[6]>>>8,c[l+14]=this._h[7]>>>0,c[l+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(c){var l=0,h=c.length,f;if(this._leftover){f=16-this._leftover,f>h&&(f=h);for(var _=0;_<f;_++)this._buffer[this._leftover+_]=c[l+_];if(h-=f,l+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(f=h-h%16,this._blocks(c,l,f),l+=f,h-=f),h){for(var _=0;_<h;_++)this._buffer[this._leftover+_]=c[l+_];this._leftover+=h}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();t.Poly1305=i;function n(o,c){var l=new i(o);l.update(c);var h=l.digest();return l.clean(),h}t.oneTimeAuth=n;function s(o,c){return o.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(o,c)}t.equal=s}(bo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=ui,r=bo,i=dt,n=re,s=$t;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),c=function(){function l(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return l.prototype.seal=function(h,f,_,m){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var D=new Uint8Array(16);D.set(h,D.length-h.length);var w=new Uint8Array(32);e.stream(this._key,D,w,4);var R=f.length+this.tagLength,F;if(m){if(m.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");F=m}else F=new Uint8Array(R);return e.streamXOR(this._key,D,f,F,4),this._authenticate(F.subarray(F.length-this.tagLength,F.length),w,F.subarray(0,F.length-this.tagLength),_),i.wipe(D),F},l.prototype.open=function(h,f,_,m){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var D=new Uint8Array(16);D.set(h,D.length-h.length);var w=new Uint8Array(32);e.stream(this._key,D,w,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,w,f.subarray(0,f.length-this.tagLength),_),!s.equal(R,f.subarray(f.length-this.tagLength,f.length)))return null;var F=f.length-this.tagLength,B;if(m){if(m.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");B=m}else B=new Uint8Array(F);return e.streamXOR(this._key,D,f.subarray(0,f.length-this.tagLength),B,4),i.wipe(D),B},l.prototype.clean=function(){return i.wipe(this._key),this},l.prototype._authenticate=function(h,f,_,m){var D=new r.Poly1305(f);m&&(D.update(m),m.length%16>0&&D.update(o.subarray(m.length%16))),D.update(_),_.length%16>0&&D.update(o.subarray(_.length%16));var w=new Uint8Array(8);m&&n.writeUint64LE(m.length,w),D.update(w),n.writeUint64LE(_.length,w),D.update(w);for(var R=D.digest(),F=0;F<R.length;F++)h[F]=R[F];D.clean(),i.wipe(R),i.wipe(w)},l}();t.ChaCha20Poly1305=c}(un);var mo={},Lr={},ln={};Object.defineProperty(ln,"__esModule",{value:!0});function gd(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}ln.isSerializableHash=gd,Object.defineProperty(Lr,"__esModule",{value:!0});var St=ln,yd=$t,_d=dt,wo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),St.isSerializableHash(this._inner)&&St.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),_d.wipe(i)}return t.prototype.reset=function(){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){St.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),St.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Lr.HMAC=wo;function bd(t,e,r){var i=new wo(t,e);i.update(r);var n=i.digest();return i.clean(),n}Lr.hmac=bd,Lr.equal=yd.equal,Object.defineProperty(mo,"__esModule",{value:!0});var Eo=Lr,Do=dt,vd=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=Eo.hmac(this._hash,i,r);this._hmac=new Eo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Do.wipe(this._buffer),Do.wipe(this._counter),this._bufpos=0},t}(),md=mo.HKDF=vd,hi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=dt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=l[f++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(f=s(this._temp,this._state,l,f,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[f++],h--;return this},c.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,f=this._bufferLength,_=h/536870912|0,m=h<<3,D=h%64<56?64:128;this._buffer[f]=128;for(var w=f+1;w<D-8;w++)this._buffer[w]=0;e.writeUint32BE(_,this._buffer,D-8),e.writeUint32BE(m,this._buffer,D-4),s(this._temp,this._state,this._buffer,0,D),this._finished=!0}for(var w=0;w<this.digestLength/4;w++)e.writeUint32BE(this._state[w],l,w*4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,l,h,f,_){for(;_>=64;){for(var m=l[0],D=l[1],w=l[2],R=l[3],F=l[4],B=l[5],x=l[6],P=l[7],y=0;y<16;y++){var S=f+y*4;c[y]=e.readUint32BE(h,S)}for(var y=16;y<64;y++){var E=c[y-2],a=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=c[y-15];var d=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;c[y]=(a+c[y-7]|0)+(d+c[y-16]|0)}for(var y=0;y<64;y++){var a=(((F>>>6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7))+(F&B^~F&x)|0)+(P+(n[y]+c[y]|0)|0)|0,d=((m>>>2|m<<32-2)^(m>>>13|m<<32-13)^(m>>>22|m<<32-22))+(m&D^m&w^D&w)|0;P=x,x=B,B=F,F=R+a|0,R=w,w=D,D=m,m=a+d|0}l[0]+=m,l[1]+=D,l[2]+=w,l[3]+=R,l[4]+=F,l[5]+=B,l[6]+=x,l[7]+=P,f+=64,_-=64}return f}function o(c){var l=new i;l.update(c);var h=l.digest();return l.clean(),h}t.hash=o})(hi);var fn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=ur,r=dt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(y){const S=new Float64Array(16);if(y)for(let E=0;E<y.length;E++)S[E]=y[E];return S}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function o(y){let S=1;for(let E=0;E<16;E++){let a=y[E]+S+65535;S=Math.floor(a/65536),y[E]=a-S*65536}y[0]+=S-1+37*(S-1)}function c(y,S,E){const a=~(E-1);for(let d=0;d<16;d++){const M=a&(y[d]^S[d]);y[d]^=M,S[d]^=M}}function l(y,S){const E=i(),a=i();for(let d=0;d<16;d++)a[d]=S[d];o(a),o(a),o(a);for(let d=0;d<2;d++){E[0]=a[0]-65517;for(let q=1;q<15;q++)E[q]=a[q]-65535-(E[q-1]>>16&1),E[q-1]&=65535;E[15]=a[15]-32767-(E[14]>>16&1);const M=E[15]>>16&1;E[14]&=65535,c(a,E,1-M)}for(let d=0;d<16;d++)y[2*d]=a[d]&255,y[2*d+1]=a[d]>>8}function h(y,S){for(let E=0;E<16;E++)y[E]=S[2*E]+(S[2*E+1]<<8);y[15]&=32767}function f(y,S,E){for(let a=0;a<16;a++)y[a]=S[a]+E[a]}function _(y,S,E){for(let a=0;a<16;a++)y[a]=S[a]-E[a]}function m(y,S,E){let a,d,M=0,q=0,G=0,J=0,X=0,g=0,b=0,L=0,U=0,N=0,T=0,j=0,H=0,Q=0,z=0,ee=0,Y=0,ae=0,C=0,A=0,O=0,u=0,v=0,K=0,k=0,le=0,_e=0,de=0,me=0,Fe=0,Ce=0,ye=E[0],pe=E[1],fe=E[2],ue=E[3],ce=E[4],oe=E[5],se=E[6],te=E[7],he=E[8],ge=E[9],ie=E[10],be=E[11],ve=E[12],Ee=E[13],De=E[14],we=E[15];a=S[0],M+=a*ye,q+=a*pe,G+=a*fe,J+=a*ue,X+=a*ce,g+=a*oe,b+=a*se,L+=a*te,U+=a*he,N+=a*ge,T+=a*ie,j+=a*be,H+=a*ve,Q+=a*Ee,z+=a*De,ee+=a*we,a=S[1],q+=a*ye,G+=a*pe,J+=a*fe,X+=a*ue,g+=a*ce,b+=a*oe,L+=a*se,U+=a*te,N+=a*he,T+=a*ge,j+=a*ie,H+=a*be,Q+=a*ve,z+=a*Ee,ee+=a*De,Y+=a*we,a=S[2],G+=a*ye,J+=a*pe,X+=a*fe,g+=a*ue,b+=a*ce,L+=a*oe,U+=a*se,N+=a*te,T+=a*he,j+=a*ge,H+=a*ie,Q+=a*be,z+=a*ve,ee+=a*Ee,Y+=a*De,ae+=a*we,a=S[3],J+=a*ye,X+=a*pe,g+=a*fe,b+=a*ue,L+=a*ce,U+=a*oe,N+=a*se,T+=a*te,j+=a*he,H+=a*ge,Q+=a*ie,z+=a*be,ee+=a*ve,Y+=a*Ee,ae+=a*De,C+=a*we,a=S[4],X+=a*ye,g+=a*pe,b+=a*fe,L+=a*ue,U+=a*ce,N+=a*oe,T+=a*se,j+=a*te,H+=a*he,Q+=a*ge,z+=a*ie,ee+=a*be,Y+=a*ve,ae+=a*Ee,C+=a*De,A+=a*we,a=S[5],g+=a*ye,b+=a*pe,L+=a*fe,U+=a*ue,N+=a*ce,T+=a*oe,j+=a*se,H+=a*te,Q+=a*he,z+=a*ge,ee+=a*ie,Y+=a*be,ae+=a*ve,C+=a*Ee,A+=a*De,O+=a*we,a=S[6],b+=a*ye,L+=a*pe,U+=a*fe,N+=a*ue,T+=a*ce,j+=a*oe,H+=a*se,Q+=a*te,z+=a*he,ee+=a*ge,Y+=a*ie,ae+=a*be,C+=a*ve,A+=a*Ee,O+=a*De,u+=a*we,a=S[7],L+=a*ye,U+=a*pe,N+=a*fe,T+=a*ue,j+=a*ce,H+=a*oe,Q+=a*se,z+=a*te,ee+=a*he,Y+=a*ge,ae+=a*ie,C+=a*be,A+=a*ve,O+=a*Ee,u+=a*De,v+=a*we,a=S[8],U+=a*ye,N+=a*pe,T+=a*fe,j+=a*ue,H+=a*ce,Q+=a*oe,z+=a*se,ee+=a*te,Y+=a*he,ae+=a*ge,C+=a*ie,A+=a*be,O+=a*ve,u+=a*Ee,v+=a*De,K+=a*we,a=S[9],N+=a*ye,T+=a*pe,j+=a*fe,H+=a*ue,Q+=a*ce,z+=a*oe,ee+=a*se,Y+=a*te,ae+=a*he,C+=a*ge,A+=a*ie,O+=a*be,u+=a*ve,v+=a*Ee,K+=a*De,k+=a*we,a=S[10],T+=a*ye,j+=a*pe,H+=a*fe,Q+=a*ue,z+=a*ce,ee+=a*oe,Y+=a*se,ae+=a*te,C+=a*he,A+=a*ge,O+=a*ie,u+=a*be,v+=a*ve,K+=a*Ee,k+=a*De,le+=a*we,a=S[11],j+=a*ye,H+=a*pe,Q+=a*fe,z+=a*ue,ee+=a*ce,Y+=a*oe,ae+=a*se,C+=a*te,A+=a*he,O+=a*ge,u+=a*ie,v+=a*be,K+=a*ve,k+=a*Ee,le+=a*De,_e+=a*we,a=S[12],H+=a*ye,Q+=a*pe,z+=a*fe,ee+=a*ue,Y+=a*ce,ae+=a*oe,C+=a*se,A+=a*te,O+=a*he,u+=a*ge,v+=a*ie,K+=a*be,k+=a*ve,le+=a*Ee,_e+=a*De,de+=a*we,a=S[13],Q+=a*ye,z+=a*pe,ee+=a*fe,Y+=a*ue,ae+=a*ce,C+=a*oe,A+=a*se,O+=a*te,u+=a*he,v+=a*ge,K+=a*ie,k+=a*be,le+=a*ve,_e+=a*Ee,de+=a*De,me+=a*we,a=S[14],z+=a*ye,ee+=a*pe,Y+=a*fe,ae+=a*ue,C+=a*ce,A+=a*oe,O+=a*se,u+=a*te,v+=a*he,K+=a*ge,k+=a*ie,le+=a*be,_e+=a*ve,de+=a*Ee,me+=a*De,Fe+=a*we,a=S[15],ee+=a*ye,Y+=a*pe,ae+=a*fe,C+=a*ue,A+=a*ce,O+=a*oe,u+=a*se,v+=a*te,K+=a*he,k+=a*ge,le+=a*ie,_e+=a*be,de+=a*ve,me+=a*Ee,Fe+=a*De,Ce+=a*we,M+=38*Y,q+=38*ae,G+=38*C,J+=38*A,X+=38*O,g+=38*u,b+=38*v,L+=38*K,U+=38*k,N+=38*le,T+=38*_e,j+=38*de,H+=38*me,Q+=38*Fe,z+=38*Ce,d=1,a=M+d+65535,d=Math.floor(a/65536),M=a-d*65536,a=q+d+65535,d=Math.floor(a/65536),q=a-d*65536,a=G+d+65535,d=Math.floor(a/65536),G=a-d*65536,a=J+d+65535,d=Math.floor(a/65536),J=a-d*65536,a=X+d+65535,d=Math.floor(a/65536),X=a-d*65536,a=g+d+65535,d=Math.floor(a/65536),g=a-d*65536,a=b+d+65535,d=Math.floor(a/65536),b=a-d*65536,a=L+d+65535,d=Math.floor(a/65536),L=a-d*65536,a=U+d+65535,d=Math.floor(a/65536),U=a-d*65536,a=N+d+65535,d=Math.floor(a/65536),N=a-d*65536,a=T+d+65535,d=Math.floor(a/65536),T=a-d*65536,a=j+d+65535,d=Math.floor(a/65536),j=a-d*65536,a=H+d+65535,d=Math.floor(a/65536),H=a-d*65536,a=Q+d+65535,d=Math.floor(a/65536),Q=a-d*65536,a=z+d+65535,d=Math.floor(a/65536),z=a-d*65536,a=ee+d+65535,d=Math.floor(a/65536),ee=a-d*65536,M+=d-1+37*(d-1),d=1,a=M+d+65535,d=Math.floor(a/65536),M=a-d*65536,a=q+d+65535,d=Math.floor(a/65536),q=a-d*65536,a=G+d+65535,d=Math.floor(a/65536),G=a-d*65536,a=J+d+65535,d=Math.floor(a/65536),J=a-d*65536,a=X+d+65535,d=Math.floor(a/65536),X=a-d*65536,a=g+d+65535,d=Math.floor(a/65536),g=a-d*65536,a=b+d+65535,d=Math.floor(a/65536),b=a-d*65536,a=L+d+65535,d=Math.floor(a/65536),L=a-d*65536,a=U+d+65535,d=Math.floor(a/65536),U=a-d*65536,a=N+d+65535,d=Math.floor(a/65536),N=a-d*65536,a=T+d+65535,d=Math.floor(a/65536),T=a-d*65536,a=j+d+65535,d=Math.floor(a/65536),j=a-d*65536,a=H+d+65535,d=Math.floor(a/65536),H=a-d*65536,a=Q+d+65535,d=Math.floor(a/65536),Q=a-d*65536,a=z+d+65535,d=Math.floor(a/65536),z=a-d*65536,a=ee+d+65535,d=Math.floor(a/65536),ee=a-d*65536,M+=d-1+37*(d-1),y[0]=M,y[1]=q,y[2]=G,y[3]=J,y[4]=X,y[5]=g,y[6]=b,y[7]=L,y[8]=U,y[9]=N,y[10]=T,y[11]=j,y[12]=H,y[13]=Q,y[14]=z,y[15]=ee}function D(y,S){m(y,S,S)}function w(y,S){const E=i();for(let a=0;a<16;a++)E[a]=S[a];for(let a=253;a>=0;a--)D(E,E),a!==2&&a!==4&&m(E,E,S);for(let a=0;a<16;a++)y[a]=E[a]}function R(y,S){const E=new Uint8Array(32),a=new Float64Array(80),d=i(),M=i(),q=i(),G=i(),J=i(),X=i();for(let U=0;U<31;U++)E[U]=y[U];E[31]=y[31]&127|64,E[0]&=248,h(a,S);for(let U=0;U<16;U++)M[U]=a[U];d[0]=G[0]=1;for(let U=254;U>=0;--U){const N=E[U>>>3]>>>(U&7)&1;c(d,M,N),c(q,G,N),f(J,d,q),_(d,d,q),f(q,M,G),_(M,M,G),D(G,J),D(X,d),m(d,q,d),m(q,M,J),f(J,d,q),_(d,d,q),D(M,d),_(q,G,X),m(d,q,s),f(d,d,G),m(q,q,d),m(d,G,X),m(G,M,a),D(M,J),c(d,M,N),c(q,G,N)}for(let U=0;U<16;U++)a[U+16]=d[U],a[U+32]=q[U],a[U+48]=M[U],a[U+64]=G[U];const g=a.subarray(32),b=a.subarray(16);w(g,g),m(b,b,g);const L=new Uint8Array(32);return l(L,b),L}t.scalarMult=R;function F(y){return R(y,n)}t.scalarMultBase=F;function B(y){if(y.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const S=new Uint8Array(y);return{publicKey:F(S),secretKey:S}}t.generateKeyPairFromSeed=B;function x(y){const S=(0,e.randomBytes)(32,y),E=B(S);return(0,r.wipe)(S),E}t.generateKeyPair=x;function P(y,S,E=!1){if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(S.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const a=R(y,S);if(E){let d=0;for(let M=0;M<a.length;M++)d|=a[M];if(d===0)throw new Error("X25519: invalid shared key")}return a}t.sharedKey=P})(fn);var So=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},wd=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),Ed=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Dd=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),Sd=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),xd=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Od=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Id=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,xo=3,Pd=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Od]],Oo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Ad(t){return t?Io(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new xd:typeof navigator<"u"?Io(navigator.userAgent):Nd()}function Cd(t){return t!==""&&Pd.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Io(t){var e=Cd(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new Sd;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<xo&&(n=So(So([],n,!0),Rd(xo-n.length),!0)):n=[];var s=n.join("."),o=Td(t),c=Id.exec(t);return c&&c[1]?new Dd(r,s,o,c[1]):new wd(r,s,o)}function Td(t){for(var e=0,r=Oo.length;e<r;e++){var i=Oo[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function Nd(){var t=typeof process<"u"&&process.version;return t?new Ed(process.version.slice(1)):null}function Rd(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Ao=Oe.getLocation=Oe.getLocationOrThrow=dn=Oe.getNavigator=Oe.getNavigatorOrThrow=Po=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Yt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Yt;function hr(t){const e=Yt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=hr;function Fd(){return hr("document")}Oe.getDocumentOrThrow=Fd;function $d(){return Yt("document")}var Po=Oe.getDocument=$d;function Ld(){return hr("navigator")}Oe.getNavigatorOrThrow=Ld;function Ud(){return Yt("navigator")}var dn=Oe.getNavigator=Ud;function Md(){return hr("location")}Oe.getLocationOrThrow=Md;function jd(){return Yt("location")}var Ao=Oe.getLocation=jd;function Hd(){return hr("crypto")}Oe.getCryptoOrThrow=Hd;function Bd(){return Yt("crypto")}Oe.getCrypto=Bd;function qd(){return hr("localStorage")}Oe.getLocalStorageOrThrow=qd;function zd(){return Yt("localStorage")}Oe.getLocalStorage=zd;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});var Co=pn.getWindowMetadata=void 0;const To=Oe;function Kd(){let t,e;try{t=To.getDocumentOrThrow(),e=To.getLocationOrThrow()}catch{return null}function r(){const _=t.getElementsByTagName("link"),m=[];for(let D=0;D<_.length;D++){const w=_[D],R=w.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const F=w.getAttribute("href");if(F)if(F.toLowerCase().indexOf("https:")===-1&&F.toLowerCase().indexOf("http:")===-1&&F.indexOf("//")!==0){let B=e.protocol+"//"+e.host;if(F.indexOf("/")===0)B+=F;else{const x=e.pathname.split("/");x.pop();const P=x.join("/");B+=P+"/"+F}m.push(B)}else if(F.indexOf("//")===0){const B=e.protocol+F;m.push(B)}else m.push(F)}}return m}function i(..._){const m=t.getElementsByTagName("meta");for(let D=0;D<m.length;D++){const w=m[D],R=["itemprop","property","name"].map(F=>w.getAttribute(F)).filter(F=>F?_.includes(F):!1);if(R.length&&R){const F=w.getAttribute("content");if(F)return F}}return""}function n(){let _=i("name","og:site_name","og:title","twitter:title");return _||(_=t.title),_}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),c=s(),l=e.origin,h=r();return{description:c,url:l,icons:h,name:o}}Co=pn.getWindowMetadata=Kd;var Ur={},Vd=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),No="%[a-f0-9]{2}",Ro=new RegExp("("+No+")|([^%]+?)","gi"),Fo=new RegExp("("+No+")+","gi");function gn(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],gn(r),gn(i))}function Gd(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Ro)||[],r=1;r<e.length;r++)t=gn(e,r).join(""),e=t.match(Ro)||[];return t}}function kd(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Fo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Gd(r[0]);i!==r[0]&&(e[r[0]]=i)}r=Fo.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var o=n[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var Wd=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return kd(t)}},Yd=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Jd=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var o=i[s],c=t[o];(n?e.indexOf(o)!==-1:e(o,c,t))&&(r[o]=c)}return r};(function(t){const e=Vd,r=Wd,i=Yd,n=Jd,s=x=>x==null,o=Symbol("encodeFragmentIdentifier");function c(x){switch(x.arrayFormat){case"index":return P=>(y,S)=>{const E=y.length;return S===void 0||x.skipNull&&S===null||x.skipEmptyString&&S===""?y:S===null?[...y,[f(P,x),"[",E,"]"].join("")]:[...y,[f(P,x),"[",f(E,x),"]=",f(S,x)].join("")]};case"bracket":return P=>(y,S)=>S===void 0||x.skipNull&&S===null||x.skipEmptyString&&S===""?y:S===null?[...y,[f(P,x),"[]"].join("")]:[...y,[f(P,x),"[]=",f(S,x)].join("")];case"colon-list-separator":return P=>(y,S)=>S===void 0||x.skipNull&&S===null||x.skipEmptyString&&S===""?y:S===null?[...y,[f(P,x),":list="].join("")]:[...y,[f(P,x),":list=",f(S,x)].join("")];case"comma":case"separator":case"bracket-separator":{const P=x.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(S,E)=>E===void 0||x.skipNull&&E===null||x.skipEmptyString&&E===""?S:(E=E===null?"":E,S.length===0?[[f(y,x),P,f(E,x)].join("")]:[[S,f(E,x)].join(x.arrayFormatSeparator)])}default:return P=>(y,S)=>S===void 0||x.skipNull&&S===null||x.skipEmptyString&&S===""?y:S===null?[...y,f(P,x)]:[...y,[f(P,x),"=",f(S,x)].join("")]}}function l(x){let P;switch(x.arrayFormat){case"index":return(y,S,E)=>{if(P=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!P){E[y]=S;return}E[y]===void 0&&(E[y]={}),E[y][P[1]]=S};case"bracket":return(y,S,E)=>{if(P=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!P){E[y]=S;return}if(E[y]===void 0){E[y]=[S];return}E[y]=[].concat(E[y],S)};case"colon-list-separator":return(y,S,E)=>{if(P=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!P){E[y]=S;return}if(E[y]===void 0){E[y]=[S];return}E[y]=[].concat(E[y],S)};case"comma":case"separator":return(y,S,E)=>{const a=typeof S=="string"&&S.includes(x.arrayFormatSeparator),d=typeof S=="string"&&!a&&_(S,x).includes(x.arrayFormatSeparator);S=d?_(S,x):S;const M=a||d?S.split(x.arrayFormatSeparator).map(q=>_(q,x)):S===null?S:_(S,x);E[y]=M};case"bracket-separator":return(y,S,E)=>{const a=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!a){E[y]=S&&_(S,x);return}const d=S===null?[]:S.split(x.arrayFormatSeparator).map(M=>_(M,x));if(E[y]===void 0){E[y]=d;return}E[y]=[].concat(E[y],d)};default:return(y,S,E)=>{if(E[y]===void 0){E[y]=S;return}E[y]=[].concat(E[y],S)}}}function h(x){if(typeof x!="string"||x.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(x,P){return P.encode?P.strict?e(x):encodeURIComponent(x):x}function _(x,P){return P.decode?r(x):x}function m(x){return Array.isArray(x)?x.sort():typeof x=="object"?m(Object.keys(x)).sort((P,y)=>Number(P)-Number(y)).map(P=>x[P]):x}function D(x){const P=x.indexOf("#");return P!==-1&&(x=x.slice(0,P)),x}function w(x){let P="";const y=x.indexOf("#");return y!==-1&&(P=x.slice(y)),P}function R(x){x=D(x);const P=x.indexOf("?");return P===-1?"":x.slice(P+1)}function F(x,P){return P.parseNumbers&&!Number.isNaN(Number(x))&&typeof x=="string"&&x.trim()!==""?x=Number(x):P.parseBooleans&&x!==null&&(x.toLowerCase()==="true"||x.toLowerCase()==="false")&&(x=x.toLowerCase()==="true"),x}function B(x,P){P=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},P),h(P.arrayFormatSeparator);const y=l(P),S=Object.create(null);if(typeof x!="string"||(x=x.trim().replace(/^[?#&]/,""),!x))return S;for(const E of x.split("&")){if(E==="")continue;let[a,d]=i(P.decode?E.replace(/\+/g," "):E,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(P.arrayFormat)?d:_(d,P),y(_(a,P),d,S)}for(const E of Object.keys(S)){const a=S[E];if(typeof a=="object"&&a!==null)for(const d of Object.keys(a))a[d]=F(a[d],P);else S[E]=F(a,P)}return P.sort===!1?S:(P.sort===!0?Object.keys(S).sort():Object.keys(S).sort(P.sort)).reduce((E,a)=>{const d=S[a];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?E[a]=m(d):E[a]=d,E},Object.create(null))}t.extract=R,t.parse=B,t.stringify=(x,P)=>{if(!x)return"";P=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},P),h(P.arrayFormatSeparator);const y=d=>P.skipNull&&s(x[d])||P.skipEmptyString&&x[d]==="",S=c(P),E={};for(const d of Object.keys(x))y(d)||(E[d]=x[d]);const a=Object.keys(E);return P.sort!==!1&&a.sort(P.sort),a.map(d=>{const M=x[d];return M===void 0?"":M===null?f(d,P):Array.isArray(M)?M.length===0&&P.arrayFormat==="bracket-separator"?f(d,P)+"[]":M.reduce(S(d),[]).join("&"):f(d,P)+"="+f(M,P)}).filter(d=>d.length>0).join("&")},t.parseUrl=(x,P)=>{P=Object.assign({decode:!0},P);const[y,S]=i(x,"#");return Object.assign({url:y.split("?")[0]||"",query:B(R(x),P)},P&&P.parseFragmentIdentifier&&S?{fragmentIdentifier:_(S,P)}:{})},t.stringifyUrl=(x,P)=>{P=Object.assign({encode:!0,strict:!0,[o]:!0},P);const y=D(x.url).split("?")[0]||"",S=t.extract(x.url),E=t.parse(S,{sort:!1}),a=Object.assign(E,x.query);let d=t.stringify(a,P);d&&(d=`?${d}`);let M=w(x.url);return x.fragmentIdentifier&&(M=`#${P[o]?f(x.fragmentIdentifier,P):x.fragmentIdentifier}`),`${y}${d}${M}`},t.pick=(x,P,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[o]:!1},y);const{url:S,query:E,fragmentIdentifier:a}=t.parseUrl(x,y);return t.stringifyUrl({url:S,query:n(E,P),fragmentIdentifier:a},y)},t.exclude=(x,P,y)=>{const S=Array.isArray(P)?E=>!P.includes(E):(E,a)=>!P(E,a);return t.pick(x,S,y)}})(Ur);const Xd={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function $o(t,e){return t.includes(":")?[t]:e.chains||[]}const Lo="base10",ct="base16",yn="base64pad",_n="utf8",Uo=0,Jt=1,Zd=0,Mo=1,bn=12,vn=32;function Qd(){const t=fn.generateKeyPair();return{privateKey:at(t.secretKey,ct),publicKey:at(t.publicKey,ct)}}function mn(){const t=ur.randomBytes(vn);return at(t,ct)}function ep(t,e){const r=fn.sharedKey(lt(t,ct),lt(e,ct)),i=new md(hi.SHA256,r).expand(vn);return at(i,ct)}function tp(t){const e=hi.hash(lt(t,ct));return at(e,ct)}function li(t){const e=hi.hash(lt(t,_n));return at(e,ct)}function rp(t){return lt(`${t}`,Lo)}function Mr(t){return Number(at(t,Lo))}function ip(t){const e=rp(typeof t.type<"u"?t.type:Uo);if(Mr(e)===Jt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?lt(t.senderPublicKey,ct):void 0,i=typeof t.iv<"u"?lt(t.iv,ct):ur.randomBytes(bn),n=new un.ChaCha20Poly1305(lt(t.symKey,ct)).seal(i,lt(t.message,_n));return sp({type:e,sealed:n,iv:i,senderPublicKey:r})}function np(t){const e=new un.ChaCha20Poly1305(lt(t.symKey,ct)),{sealed:r,iv:i}=fi(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return at(n,_n)}function sp(t){if(Mr(t.type)===Jt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return at(sn([t.type,t.senderPublicKey,t.iv,t.sealed]),yn)}return at(sn([t.type,t.iv,t.sealed]),yn)}function fi(t){const e=lt(t,yn),r=e.slice(Zd,Mo),i=Mo;if(Mr(r)===Jt){const c=i+vn,l=c+bn,h=e.slice(i,c),f=e.slice(c,l),_=e.slice(l);return{type:r,sealed:_,iv:f,senderPublicKey:h}}const n=i+bn,s=e.slice(i,n),o=e.slice(n);return{type:r,sealed:o,iv:s}}function op(t,e){const r=fi(t);return jo({type:Mr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ct):void 0,receiverPublicKey:e?.receiverPublicKey})}function jo(t){const e=t?.type||Uo;if(e===Jt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ho(t){return t.type===Jt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var ap=Object.defineProperty,Bo=Object.getOwnPropertySymbols,cp=Object.prototype.hasOwnProperty,up=Object.prototype.propertyIsEnumerable,qo=(t,e,r)=>e in t?ap(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zo=(t,e)=>{for(var r in e||(e={}))cp.call(e,r)&&qo(t,r,e[r]);if(Bo)for(var r of Bo(e))up.call(e,r)&&qo(t,r,e[r]);return t};const hp="ReactNative",jr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},lp="js";function Ko(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function fp(){return!Po()&&!!dn()&&navigator.product===hp}function dp(){return!Ko()&&!!dn()}function pp(){return fp()?jr.reactNative:Ko()?jr.node:dp()?jr.browser:jr.unknown}function gp(t,e){let r=Ur.parse(t);return r=zo(zo({},r),e),t=Ur.stringify(r),t}function yp(){return Co()||{name:"",description:"",url:"",icons:[""]}}function _p(){const t=Ad();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function bp(){var t;const e=pp();return e===jr.browser?[e,((t=Ao())==null?void 0:t.host)||"unknown"].join(":"):e}function vp(t,e,r){const i=_p(),n=bp();return[[t,e].join("-"),[lp,r].join("-"),i,n].join("/")}function mp({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:o}){const c=r.split("?"),l=vp(t,e,i),h={auth:n,ua:l,projectId:s,useOnCloseEvent:o||void 0},f=gp(c[1]||"",h);return c[0]+"?"+f}function Xt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Vo(t){return Object.fromEntries(t.entries())}function Go(t){return new Map(Object.entries(t))}function lr(t=Z.FIVE_MINUTES,e){const r=Z.toMiliseconds(t||Z.FIVE_MINUTES);let i,n,s;return{resolve:o=>{s&&i&&(clearTimeout(s),i(o))},reject:o=>{s&&n&&(clearTimeout(s),n(o))},done:()=>new Promise((o,c)=>{s=setTimeout(()=>{c(new Error(e))},r),i=o,n=c})}}function di(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const o=await t;i(o)}catch(o){n(o)}clearTimeout(s)})}function ko(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function wp(t){return ko("topic",t)}function Ep(t){return ko("id",t)}function Wo(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function xt(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function Lt(t){return Date.now()>=Z.toMiliseconds(t)}function $e(t,e){return`${t}${e?`:${e}`:""}`}const Dp="irn";function wn(t){return t?.relay||{protocol:Dp}}function pi(t){const e=Xd[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Sp=Object.defineProperty,Yo=Object.getOwnPropertySymbols,xp=Object.prototype.hasOwnProperty,Op=Object.prototype.propertyIsEnumerable,Jo=(t,e,r)=>e in t?Sp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ip=(t,e)=>{for(var r in e||(e={}))xp.call(e,r)&&Jo(t,r,e[r]);if(Yo)for(var r of Yo(e))Op.call(e,r)&&Jo(t,r,e[r]);return t};function Pp(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),o=t[n];r[s]=o}}),r}function Ap(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Ur.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:o.symKey,relay:Pp(o)}}function Cp(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function Tp(t){return`${t.protocol}:${t.topic}@${t.version}?`+Ur.stringify(Ip({symKey:t.symKey},Cp(t.relay)))}function fr(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function Np(t){const e=[];return Object.values(t).forEach(r=>{e.push(...fr(r.accounts))}),e}function Rp(t,e){const r=[];return Object.values(t).forEach(i=>{fr(i.accounts).includes(e)&&r.push(...i.methods)}),r}function Fp(t,e){const r=[];return Object.values(t).forEach(i=>{fr(i.accounts).includes(e)&&r.push(...i.events)}),r}function $p(t,e){const r=gi(t,e);if(r)throw new Error(r.message);const i={};for(const[n,s]of Object.entries(t))i[n]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return i}const Lp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Up={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:i}=Up[t];return{message:e?`${r} ${e}`:r,code:i}}function Le(t,e){const{message:r,code:i}=Lp[t];return{message:e?`${r} ${e}`:r,code:i}}function dr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function pr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ut(t){return typeof t>"u"}function Ke(t,e){return e&&ut(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function En(t,e){return e&&ut(t)?!0:typeof t=="number"&&!isNaN(t)}function Mp(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Xt(n,i)?(i.forEach(o=>{const{accounts:c,methods:l,events:h}=t.namespaces[o],f=fr(c),_=r[o];(!Xt($o(o,_),f)||!Xt(_.methods,l)||!Xt(_.events,h))&&(s=!1)}),s):!1}function Dn(t){return Ke(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function jp(t){if(Ke(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Dn(r)}}return!1}function Hp(t){if(Ke(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Bp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function qp(t){return t?.topic}function zp(t,e){let r=null;return Ke(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Xo(t){let e=!0;return dr(t)?t.length&&(e=t.every(r=>Ke(r,!1))):e=!1,e}function Kp(t,e,r){let i=null;return dr(e)?e.forEach(n=>{i||(!Dn(n)||!n.includes(t))&&(i=Le("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=Le("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function Vp(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=Kp(i,$o(i,n),`${e} requiredNamespace`);s&&(r=s)}),r}function Gp(t,e){let r=null;return dr(t)?t.forEach(i=>{r||jp(i)||(r=Le("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=Le("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function kp(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Gp(i?.accounts,`${e} namespace`);n&&(r=n)}),r}function Wp(t,e){let r=null;return Xo(t?.methods)?Xo(t?.events)||(r=Le("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Le("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Zo(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=Wp(i,`${e}, namespace`);n&&(r=n)}),r}function Yp(t,e,r){let i=null;if(t&&pr(t)){const n=Zo(t,e);n&&(i=n);const s=Vp(t,e);s&&(i=s)}else i=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function gi(t,e){let r=null;if(t&&pr(t)){const i=Zo(t,e);i&&(r=i);const n=kp(t,e);n&&(r=n)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Qo(t){return Ke(t.protocol,!0)}function Jp(t,e){let r=!1;return e&&!t?r=!0:t&&dr(t)&&t.length&&t.forEach(i=>{r=Qo(i)}),r}function Xp(t){return typeof t=="number"}function ft(t){return typeof t<"u"&&typeof t!==null}function Zp(t){return!(!t||typeof t!="object"||!t.code||!En(t.code,!1)||!t.message||!Ke(t.message,!1))}function Qp(t){return!(ut(t)||!Ke(t.method,!1))}function eg(t){return!(ut(t)||ut(t.result)&&ut(t.error)||!En(t.id,!1)||!Ke(t.jsonrpc,!1))}function tg(t){return!(ut(t)||!Ke(t.name,!1))}function ea(t,e){return!(!Dn(e)||!Np(t).includes(e))}function rg(t,e,r){return Ke(r,!1)?Rp(t,e).includes(r):!1}function ig(t,e,r){return Ke(r,!1)?Fp(t,e).includes(r):!1}function ta(t,e,r){let i=null;const n=ng(t),s=sg(e),o=Object.keys(n),c=Object.keys(s),l=ra(Object.keys(t)),h=ra(Object.keys(e)),f=l.filter(_=>!h.includes(_));return f.length&&(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(e).toString()}`)),Xt(o,c)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(_=>{if(!_.includes(":")||i)return;const m=fr(e[_].accounts);m.includes(_)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${_}
        Required: ${_}
        Approved: ${m.toString()}`))}),o.forEach(_=>{i||(Xt(n[_].methods,s[_].methods)?Xt(n[_].events,s[_].events)||(i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${_}`)):i=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${_}`))}),i}function ng(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function ra(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function sg(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=fr(t[r].accounts);i?.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function og(t,e){return En(t,!1)&&t<=e.max&&t>=e.min}const ag="PARSE_ERROR",cg="INVALID_REQUEST",ug="METHOD_NOT_FOUND",hg="INVALID_PARAMS",ia="INTERNAL_ERROR",Sn="SERVER_ERROR",lg=[-32700,-32600,-32601,-32602,-32603],Hr={[ag]:{code:-32700,message:"Parse error"},[cg]:{code:-32600,message:"Invalid Request"},[ug]:{code:-32601,message:"Method not found"},[hg]:{code:-32602,message:"Invalid params"},[ia]:{code:-32603,message:"Internal error"},[Sn]:{code:-32e3,message:"Server error"}},na=Sn;function fg(t){return lg.includes(t)}function sa(t){return Object.keys(Hr).includes(t)?Hr[t]:Hr[na]}function dg(t){const e=Object.values(Hr).find(r=>r.code===t);return e||Hr[na]}function oa(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var aa={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xn=function(t,e){return xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},xn(t,e)};function pg(t,e){xn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var On=function(){return On=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},On.apply(this,arguments)};function gg(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function yg(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function _g(t,e){return function(r,i){e(r,i,t)}}function bg(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function vg(t,e,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{h(i.next(f))}catch(_){o(_)}}function l(f){try{h(i.throw(f))}catch(_){o(_)}}function h(f){f.done?s(f.value):n(f.value).then(c,l)}h((i=i.apply(t,e||[])).next())})}function mg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(h){return function(f){return l([h,f])}}function l(h){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=h[0]&2?n.return:h[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,h[1])).done)return s;switch(n=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,n=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],n=0}finally{i=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function wg(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Eg(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function In(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ca(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Dg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ca(arguments[e]));return t}function Sg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,c=s.length;o<c;o++,n++)i[n]=s[o];return i}function Br(t){return this instanceof Br?(this.v=t,this):new Br(t)}function xg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(m){i[m]&&(n[m]=function(D){return new Promise(function(w,R){s.push([m,D,w,R])>1||c(m,D)})})}function c(m,D){try{l(i[m](D))}catch(w){_(s[0][3],w)}}function l(m){m.value instanceof Br?Promise.resolve(m.value.v).then(h,f):_(s[0][2],m)}function h(m){c("next",m)}function f(m){c("throw",m)}function _(m,D){m(D),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Og(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(o){return(r=!r)?{value:Br(t[n](o)),done:n==="return"}:s?s(o):o}:s}}function Ig(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof In=="function"?In(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(o){return new Promise(function(c,l){o=t[s](o),n(c,l,o.done,o.value)})}}function n(s,o,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},o)}}function Pg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Ag(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Cg(t){return t&&t.__esModule?t:{default:t}}function Tg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ng(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Rg=Object.freeze({__proto__:null,__extends:pg,get __assign(){return On},__rest:gg,__decorate:yg,__param:_g,__metadata:bg,__awaiter:vg,__generator:mg,__createBinding:wg,__exportStar:Eg,__values:In,__read:ca,__spread:Dg,__spreadArrays:Sg,__await:Br,__asyncGenerator:xg,__asyncDelegator:Og,__asyncValues:Ig,__makeTemplateObject:Pg,__importStar:Ag,__importDefault:Cg,__classPrivateFieldGet:Tg,__classPrivateFieldSet:Ng}),Fg=zt(Rg),Ct={},ua;function $g(){if(ua)return Ct;ua=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.isBrowserCryptoAvailable=Ct.getSubtleCrypto=Ct.getBrowerCrypto=void 0;function t(){return ze?.crypto||ze?.msCrypto||{}}Ct.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}Ct.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Ct.isBrowserCryptoAvailable=r,Ct}var Tt={},ha;function Lg(){if(ha)return Tt;ha=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.isBrowser=Tt.isNode=Tt.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Tt.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Tt.isNode=e;function r(){return!t()&&!e()}return Tt.isBrowser=r,Tt}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Fg;e.__exportStar($g(),t),e.__exportStar(Lg(),t)})(aa);function la(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Ug(t=6){return BigInt(la(t))}function yi(t,e,r){return{id:r||la(),jsonrpc:"2.0",method:t,params:e}}function Pn(t,e){return{id:t,jsonrpc:"2.0",result:e}}function _i(t,e,r){return{id:t,jsonrpc:"2.0",error:Mg(e,r)}}function Mg(t,e){return typeof t>"u"?sa(ia):(typeof t=="string"&&(t=Object.assign(Object.assign({},sa(Sn)),{message:t})),typeof e<"u"&&(t.data=e),fg(t.code)&&(t=dg(t.code)),t)}class jg{}class Hg extends jg{constructor(){super()}}class Bg extends Hg{constructor(e){super()}}const qg="^https?:",zg="^wss?:";function Kg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function fa(t,e){const r=Kg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function da(t){return fa(t,qg)}function pa(t){return fa(t,zg)}function Vg(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function ga(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function An(t){return ga(t)&&"method"in t}function Cn(t){return ga(t)&&(Nt(t)||mt(t))}function Nt(t){return"result"in t}function mt(t){return"error"in t}class Zt extends Bg{constructor(e){super(e),this.events=new it.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(yi(e.method,e.params||[],Ug().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{mt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Cn(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ya=10,Gg=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),kg=()=>typeof window<"u",Wg=Gg();class Yg{constructor(e){if(this.url=e,this.events=new it.exports.EventEmitter,this.registering=!1,!pa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Fr(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!pa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=aa.isReactNative()?void 0:{rejectUnauthorized:!Vg(e)},s=new Wg(e,[],n);kg()?s.onerror=o=>{const c=o;i(this.emitError(c.error))}:s.on("error",o=>{i(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Zi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=_i(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return oa(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ya&&this.events.setMaxListeners(ya)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Tn={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,o=9007199254740991,c="[object Arguments]",l="[object Array]",h="[object AsyncFunction]",f="[object Boolean]",_="[object Date]",m="[object Error]",D="[object Function]",w="[object GeneratorFunction]",R="[object Map]",F="[object Number]",B="[object Null]",x="[object Object]",P="[object Promise]",y="[object Proxy]",S="[object RegExp]",E="[object Set]",a="[object String]",d="[object Symbol]",M="[object Undefined]",q="[object WeakMap]",G="[object ArrayBuffer]",J="[object DataView]",X="[object Float32Array]",g="[object Float64Array]",b="[object Int8Array]",L="[object Int16Array]",U="[object Int32Array]",N="[object Uint8Array]",T="[object Uint8ClampedArray]",j="[object Uint16Array]",H="[object Uint32Array]",Q=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,Y={};Y[X]=Y[g]=Y[b]=Y[L]=Y[U]=Y[N]=Y[T]=Y[j]=Y[H]=!0,Y[c]=Y[l]=Y[G]=Y[f]=Y[J]=Y[_]=Y[m]=Y[D]=Y[R]=Y[F]=Y[x]=Y[S]=Y[E]=Y[a]=Y[q]=!1;var ae=typeof ze=="object"&&ze&&ze.Object===Object&&ze,C=typeof self=="object"&&self&&self.Object===Object&&self,A=ae||C||Function("return this")(),O=e&&!e.nodeType&&e,u=O&&!0&&t&&!t.nodeType&&t,v=u&&u.exports===O,K=v&&ae.process,k=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),le=k&&k.isTypedArray;function _e(p,I){for(var $=-1,W=p==null?0:p.length,Ie=0,ne=[];++$<W;){var Re=p[$];I(Re,$,p)&&(ne[Ie++]=Re)}return ne}function de(p,I){for(var $=-1,W=I.length,Ie=p.length;++$<W;)p[Ie+$]=I[$];return p}function me(p,I){for(var $=-1,W=p==null?0:p.length;++$<W;)if(I(p[$],$,p))return!0;return!1}function Fe(p,I){for(var $=-1,W=Array(p);++$<p;)W[$]=I($);return W}function Ce(p){return function(I){return p(I)}}function ye(p,I){return p.has(I)}function pe(p,I){return p?.[I]}function fe(p){var I=-1,$=Array(p.size);return p.forEach(function(W,Ie){$[++I]=[Ie,W]}),$}function ue(p,I){return function($){return p(I($))}}function ce(p){var I=-1,$=Array(p.size);return p.forEach(function(W){$[++I]=W}),$}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,he=A["__core-js_shared__"],ge=se.toString,ie=te.hasOwnProperty,be=function(){var p=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),ve=te.toString,Ee=RegExp("^"+ge.call(ie).replace(Q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=v?A.Buffer:void 0,we=A.Symbol,wt=A.Uint8Array,At=te.propertyIsEnumerable,Mt=oe.splice,pt=we?we.toStringTag:void 0,er=Object.getOwnPropertySymbols,Gr=De?De.isBuffer:void 0,Si=ue(Object.keys,Object),Ue=_r(A,"DataView"),Te=_r(A,"Map"),Me=_r(A,"Promise"),je=_r(A,"Set"),He=_r(A,"WeakMap"),Ne=_r(Object,"create"),Ge=rr(Ue),ke=rr(Te),We=rr(Me),Ye=rr(je),Je=rr(He),qe=we?we.prototype:void 0,Be=qe?qe.valueOf:void 0;function Pe(p){var I=-1,$=p==null?0:p.length;for(this.clear();++I<$;){var W=p[I];this.set(W[0],W[1])}}function Xe(){this.__data__=Ne?Ne(null):{},this.size=0}function Ze(p){var I=this.has(p)&&delete this.__data__[p];return this.size-=I?1:0,I}function ib(p){var I=this.__data__;if(Ne){var $=I[p];return $===i?void 0:$}return ie.call(I,p)?I[p]:void 0}function nb(p){var I=this.__data__;return Ne?I[p]!==void 0:ie.call(I,p)}function sb(p,I){var $=this.__data__;return this.size+=this.has(p)?0:1,$[p]=Ne&&I===void 0?i:I,this}Pe.prototype.clear=Xe,Pe.prototype.delete=Ze,Pe.prototype.get=ib,Pe.prototype.has=nb,Pe.prototype.set=sb;function Rt(p){var I=-1,$=p==null?0:p.length;for(this.clear();++I<$;){var W=p[I];this.set(W[0],W[1])}}function ob(){this.__data__=[],this.size=0}function ab(p){var I=this.__data__,$=Oi(I,p);if($<0)return!1;var W=I.length-1;return $==W?I.pop():Mt.call(I,$,1),--this.size,!0}function cb(p){var I=this.__data__,$=Oi(I,p);return $<0?void 0:I[$][1]}function ub(p){return Oi(this.__data__,p)>-1}function hb(p,I){var $=this.__data__,W=Oi($,p);return W<0?(++this.size,$.push([p,I])):$[W][1]=I,this}Rt.prototype.clear=ob,Rt.prototype.delete=ab,Rt.prototype.get=cb,Rt.prototype.has=ub,Rt.prototype.set=hb;function tr(p){var I=-1,$=p==null?0:p.length;for(this.clear();++I<$;){var W=p[I];this.set(W[0],W[1])}}function lb(){this.size=0,this.__data__={hash:new Pe,map:new(Te||Rt),string:new Pe}}function fb(p){var I=Ii(this,p).delete(p);return this.size-=I?1:0,I}function db(p){return Ii(this,p).get(p)}function pb(p){return Ii(this,p).has(p)}function gb(p,I){var $=Ii(this,p),W=$.size;return $.set(p,I),this.size+=$.size==W?0:1,this}tr.prototype.clear=lb,tr.prototype.delete=fb,tr.prototype.get=db,tr.prototype.has=pb,tr.prototype.set=gb;function xi(p){var I=-1,$=p==null?0:p.length;for(this.__data__=new tr;++I<$;)this.add(p[I])}function yb(p){return this.__data__.set(p,i),this}function _b(p){return this.__data__.has(p)}xi.prototype.add=xi.prototype.push=yb,xi.prototype.has=_b;function jt(p){var I=this.__data__=new Rt(p);this.size=I.size}function bb(){this.__data__=new Rt,this.size=0}function vb(p){var I=this.__data__,$=I.delete(p);return this.size=I.size,$}function mb(p){return this.__data__.get(p)}function wb(p){return this.__data__.has(p)}function Eb(p,I){var $=this.__data__;if($ instanceof Rt){var W=$.__data__;if(!Te||W.length<r-1)return W.push([p,I]),this.size=++$.size,this;$=this.__data__=new tr(W)}return $.set(p,I),this.size=$.size,this}jt.prototype.clear=bb,jt.prototype.delete=vb,jt.prototype.get=mb,jt.prototype.has=wb,jt.prototype.set=Eb;function Db(p,I){var $=Pi(p),W=!$&&Mb(p),Ie=!$&&!W&&Wn(p),ne=!$&&!W&&!Ie&&wc(p),Re=$||W||Ie||ne,Qe=Re?Fe(p.length,String):[],rt=Qe.length;for(var Ae in p)(I||ie.call(p,Ae))&&!(Re&&(Ae=="length"||Ie&&(Ae=="offset"||Ae=="parent")||ne&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||Rb(Ae,rt)))&&Qe.push(Ae);return Qe}function Oi(p,I){for(var $=p.length;$--;)if(_c(p[$][0],I))return $;return-1}function Sb(p,I,$){var W=I(p);return Pi(p)?W:de(W,$(p))}function kr(p){return p==null?p===void 0?M:B:pt&&pt in Object(p)?Tb(p):Ub(p)}function dc(p){return Wr(p)&&kr(p)==c}function pc(p,I,$,W,Ie){return p===I?!0:p==null||I==null||!Wr(p)&&!Wr(I)?p!==p&&I!==I:xb(p,I,$,W,pc,Ie)}function xb(p,I,$,W,Ie,ne){var Re=Pi(p),Qe=Pi(I),rt=Re?l:Ht(p),Ae=Qe?l:Ht(I);rt=rt==c?x:rt,Ae=Ae==c?x:Ae;var gt=rt==x,Et=Ae==x,st=rt==Ae;if(st&&Wn(p)){if(!Wn(I))return!1;Re=!0,gt=!1}if(st&&!gt)return ne||(ne=new jt),Re||wc(p)?gc(p,I,$,W,Ie,ne):Ab(p,I,rt,$,W,Ie,ne);if(!($&n)){var bt=gt&&ie.call(p,"__wrapped__"),vt=Et&&ie.call(I,"__wrapped__");if(bt||vt){var Bt=bt?p.value():p,Ft=vt?I.value():I;return ne||(ne=new jt),Ie(Bt,Ft,$,W,ne)}}return st?(ne||(ne=new jt),Cb(p,I,$,W,Ie,ne)):!1}function Ob(p){if(!mc(p)||$b(p))return!1;var I=bc(p)?Ee:z;return I.test(rr(p))}function Ib(p){return Wr(p)&&vc(p.length)&&!!Y[kr(p)]}function Pb(p){if(!Lb(p))return Si(p);var I=[];for(var $ in Object(p))ie.call(p,$)&&$!="constructor"&&I.push($);return I}function gc(p,I,$,W,Ie,ne){var Re=$&n,Qe=p.length,rt=I.length;if(Qe!=rt&&!(Re&&rt>Qe))return!1;var Ae=ne.get(p);if(Ae&&ne.get(I))return Ae==I;var gt=-1,Et=!0,st=$&s?new xi:void 0;for(ne.set(p,I),ne.set(I,p);++gt<Qe;){var bt=p[gt],vt=I[gt];if(W)var Bt=Re?W(vt,bt,gt,I,p,ne):W(bt,vt,gt,p,I,ne);if(Bt!==void 0){if(Bt)continue;Et=!1;break}if(st){if(!me(I,function(Ft,ir){if(!ye(st,ir)&&(bt===Ft||Ie(bt,Ft,$,W,ne)))return st.push(ir)})){Et=!1;break}}else if(!(bt===vt||Ie(bt,vt,$,W,ne))){Et=!1;break}}return ne.delete(p),ne.delete(I),Et}function Ab(p,I,$,W,Ie,ne,Re){switch($){case J:if(p.byteLength!=I.byteLength||p.byteOffset!=I.byteOffset)return!1;p=p.buffer,I=I.buffer;case G:return!(p.byteLength!=I.byteLength||!ne(new wt(p),new wt(I)));case f:case _:case F:return _c(+p,+I);case m:return p.name==I.name&&p.message==I.message;case S:case a:return p==I+"";case R:var Qe=fe;case E:var rt=W&n;if(Qe||(Qe=ce),p.size!=I.size&&!rt)return!1;var Ae=Re.get(p);if(Ae)return Ae==I;W|=s,Re.set(p,I);var gt=gc(Qe(p),Qe(I),W,Ie,ne,Re);return Re.delete(p),gt;case d:if(Be)return Be.call(p)==Be.call(I)}return!1}function Cb(p,I,$,W,Ie,ne){var Re=$&n,Qe=yc(p),rt=Qe.length,Ae=yc(I),gt=Ae.length;if(rt!=gt&&!Re)return!1;for(var Et=rt;Et--;){var st=Qe[Et];if(!(Re?st in I:ie.call(I,st)))return!1}var bt=ne.get(p);if(bt&&ne.get(I))return bt==I;var vt=!0;ne.set(p,I),ne.set(I,p);for(var Bt=Re;++Et<rt;){st=Qe[Et];var Ft=p[st],ir=I[st];if(W)var Ec=Re?W(ir,Ft,st,I,p,ne):W(Ft,ir,st,p,I,ne);if(!(Ec===void 0?Ft===ir||Ie(Ft,ir,$,W,ne):Ec)){vt=!1;break}Bt||(Bt=st=="constructor")}if(vt&&!Bt){var Ai=p.constructor,Ci=I.constructor;Ai!=Ci&&"constructor"in p&&"constructor"in I&&!(typeof Ai=="function"&&Ai instanceof Ai&&typeof Ci=="function"&&Ci instanceof Ci)&&(vt=!1)}return ne.delete(p),ne.delete(I),vt}function yc(p){return Sb(p,Bb,Nb)}function Ii(p,I){var $=p.__data__;return Fb(I)?$[typeof I=="string"?"string":"hash"]:$.map}function _r(p,I){var $=pe(p,I);return Ob($)?$:void 0}function Tb(p){var I=ie.call(p,pt),$=p[pt];try{p[pt]=void 0;var W=!0}catch{}var Ie=ve.call(p);return W&&(I?p[pt]=$:delete p[pt]),Ie}var Nb=er?function(p){return p==null?[]:(p=Object(p),_e(er(p),function(I){return At.call(p,I)}))}:qb,Ht=kr;(Ue&&Ht(new Ue(new ArrayBuffer(1)))!=J||Te&&Ht(new Te)!=R||Me&&Ht(Me.resolve())!=P||je&&Ht(new je)!=E||He&&Ht(new He)!=q)&&(Ht=function(p){var I=kr(p),$=I==x?p.constructor:void 0,W=$?rr($):"";if(W)switch(W){case Ge:return J;case ke:return R;case We:return P;case Ye:return E;case Je:return q}return I});function Rb(p,I){return I=I??o,!!I&&(typeof p=="number"||ee.test(p))&&p>-1&&p%1==0&&p<I}function Fb(p){var I=typeof p;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?p!=="__proto__":p===null}function $b(p){return!!be&&be in p}function Lb(p){var I=p&&p.constructor,$=typeof I=="function"&&I.prototype||te;return p===$}function Ub(p){return ve.call(p)}function rr(p){if(p!=null){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""}function _c(p,I){return p===I||p!==p&&I!==I}var Mb=dc(function(){return arguments}())?dc:function(p){return Wr(p)&&ie.call(p,"callee")&&!At.call(p,"callee")},Pi=Array.isArray;function jb(p){return p!=null&&vc(p.length)&&!bc(p)}var Wn=Gr||zb;function Hb(p,I){return pc(p,I)}function bc(p){if(!mc(p))return!1;var I=kr(p);return I==D||I==w||I==h||I==y}function vc(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function mc(p){var I=typeof p;return p!=null&&(I=="object"||I=="function")}function Wr(p){return p!=null&&typeof p=="object"}var wc=le?Ce(le):Ib;function Bb(p){return jb(p)?Db(p):Pb(p)}function qb(){return[]}function zb(){return!1}t.exports=Hb})(Tn,Tn.exports);var Jg=Tn.exports,Xg=Object.defineProperty,_a=Object.getOwnPropertySymbols,Zg=Object.prototype.hasOwnProperty,Qg=Object.prototype.propertyIsEnumerable,ba=(t,e,r)=>e in t?Xg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ht=(t,e)=>{for(var r in e||(e={}))Zg.call(e,r)&&ba(t,r,e[r]);if(_a)for(var r of _a(e))Qg.call(e,r)&&ba(t,r,e[r]);return t};function ey(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var c=t.length,l=t.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function _(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var R=0,F=0,B=0,x=w.length;B!==x&&w[B]===0;)B++,R++;for(var P=(x-B)*f+1>>>0,y=new Uint8Array(P);B!==x;){for(var S=w[B],E=0,a=P-1;(S!==0||E<F)&&a!==-1;a--,E++)S+=256*y[a]>>>0,y[a]=S%c>>>0,S=S/c>>>0;if(S!==0)throw new Error("Non-zero carry");F=E,B++}for(var d=P-F;d!==P&&y[d]===0;)d++;for(var M=l.repeat(R);d<P;++d)M+=t.charAt(y[d]);return M}function m(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var R=0;if(w[R]!==" "){for(var F=0,B=0;w[R]===l;)F++,R++;for(var x=(w.length-R)*h+1>>>0,P=new Uint8Array(x);w[R];){var y=r[w.charCodeAt(R)];if(y===255)return;for(var S=0,E=x-1;(y!==0||S<B)&&E!==-1;E--,S++)y+=c*P[E]>>>0,P[E]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");B=S,R++}if(w[R]!==" "){for(var a=x-B;a!==x&&P[a]===0;)a++;for(var d=new Uint8Array(F+(x-a)),M=F;a!==x;)d[M++]=P[a++];return d}}}function D(w){var R=m(w);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:_,decodeUnsafe:m,decode:D}}var ty=ey,ry=ty;const va=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},iy=t=>new TextEncoder().encode(t),ny=t=>new TextDecoder().decode(t);class sy{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class oy{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ma(this,e)}}class ay{constructor(e){this.decoders=e}or(e){return ma(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ma=(t,e)=>new ay(ht(ht({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class cy{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new sy(e,r,i),this.decoder=new oy(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bi=({name:t,prefix:e,encode:r,decode:i})=>new cy(t,e,r,i),qr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=ry(r,e);return bi({prefix:t,name:e,encode:i,decode:s=>va(n(s))})},uy=(t,e,r,i)=>{const n={};for(let f=0;f<e.length;++f)n[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,l=0,h=0;for(let f=0;f<s;++f){const _=n[t[f]];if(_===void 0)throw new SyntaxError(`Non-${i} character`);l=l<<r|_,c+=r,c>=8&&(c-=8,o[h++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return o},hy=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],o+=8;o>r;)o-=r,s+=e[n&c>>o];if(o&&(s+=e[n&c<<r-o]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>bi({prefix:e,name:t,encode(n){return hy(n,i,r)},decode(n){return uy(n,i,r,t)}}),ly=bi({prefix:"\0",name:"identity",encode:t=>ny(t),decode:t=>iy(t)});var fy=Object.freeze({__proto__:null,identity:ly});const dy=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var py=Object.freeze({__proto__:null,base2:dy});const gy=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var yy=Object.freeze({__proto__:null,base8:gy});const _y=qr({prefix:"9",name:"base10",alphabet:"0123456789"});var by=Object.freeze({__proto__:null,base10:_y});const vy=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),my=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var wy=Object.freeze({__proto__:null,base16:vy,base16upper:my});const Ey=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Dy=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sy=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),xy=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Oy=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Iy=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Py=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ay=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Cy=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ty=Object.freeze({__proto__:null,base32:Ey,base32upper:Dy,base32pad:Sy,base32padupper:xy,base32hex:Oy,base32hexupper:Iy,base32hexpad:Py,base32hexpadupper:Ay,base32z:Cy});const Ny=qr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ry=qr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Fy=Object.freeze({__proto__:null,base36:Ny,base36upper:Ry});const $y=qr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ly=qr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Uy=Object.freeze({__proto__:null,base58btc:$y,base58flickr:Ly});const My=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jy=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hy=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),By=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var qy=Object.freeze({__proto__:null,base64:My,base64pad:jy,base64url:Hy,base64urlpad:By});const wa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),zy=wa.reduce((t,e,r)=>(t[r]=e,t),[]),Ky=wa.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function Vy(t){return t.reduce((e,r)=>(e+=zy[r],e),"")}function Gy(t){const e=[];for(const r of t){const i=Ky[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const ky=bi({prefix:"\u{1F680}",name:"base256emoji",encode:Vy,decode:Gy});var Wy=Object.freeze({__proto__:null,base256emoji:ky}),Yy=Da,Ea=128,Jy=127,Xy=~Jy,Zy=Math.pow(2,31);function Da(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Zy;)e[r++]=t&255|Ea,t/=128;for(;t&Xy;)e[r++]=t&255|Ea,t>>>=7;return e[r]=t|0,Da.bytes=r-i+1,e}var Qy=Nn,e0=128,Sa=127;function Nn(t,i){var r=0,i=i||0,n=0,s=i,o,c=t.length;do{if(s>=c)throw Nn.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=n<28?(o&Sa)<<n:(o&Sa)*Math.pow(2,n),n+=7}while(o>=e0);return Nn.bytes=s-i,r}var t0=Math.pow(2,7),r0=Math.pow(2,14),i0=Math.pow(2,21),n0=Math.pow(2,28),s0=Math.pow(2,35),o0=Math.pow(2,42),a0=Math.pow(2,49),c0=Math.pow(2,56),u0=Math.pow(2,63),h0=function(t){return t<t0?1:t<r0?2:t<i0?3:t<n0?4:t<s0?5:t<o0?6:t<a0?7:t<c0?8:t<u0?9:10},l0={encode:Yy,decode:Qy,encodingLength:h0},xa=l0;const Oa=(t,e,r=0)=>(xa.encode(t,e,r),e),Ia=t=>xa.encodingLength(t),Rn=(t,e)=>{const r=e.byteLength,i=Ia(t),n=i+Ia(r),s=new Uint8Array(n+r);return Oa(t,s,0),Oa(r,s,i),s.set(e,n),new f0(t,r,e,s)};class f0{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Pa=({name:t,code:e,encode:r})=>new d0(t,e,r);class d0{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Rn(this.code,r):r.then(i=>Rn(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Aa=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),p0=Pa({name:"sha2-256",code:18,encode:Aa("SHA-256")}),g0=Pa({name:"sha2-512",code:19,encode:Aa("SHA-512")});var y0=Object.freeze({__proto__:null,sha256:p0,sha512:g0});const Ca=0,_0="identity",Ta=va;var b0=Object.freeze({__proto__:null,identity:{code:Ca,name:_0,encode:Ta,digest:t=>Rn(Ca,Ta(t))}});new TextEncoder,new TextDecoder;const Na=ht(ht(ht(ht(ht(ht(ht(ht(ht(ht({},fy),py),yy),by),wy),Ty),Fy),Uy),qy),Wy);ht(ht({},y0),b0);function v0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ra(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const Fa=Ra("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Fn=Ra("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=v0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),m0=ht({utf8:Fa,"utf-8":Fa,hex:Na.base16,latin1:Fn,ascii:Fn,binary:Fn},Na);function w0(t,e="utf8"){const r=m0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const $a="wc",E0=2,$n="core",Ut=`${$a}@${2}:${$n}:`,D0={name:$n,logger:"error"},S0={database:":memory:"},x0="crypto",La="client_ed25519_seed",O0=Z.ONE_DAY,I0="keychain",P0="0.3",A0="messages",C0="0.3",T0=Z.SIX_HOURS,N0="publisher",Ua="irn",R0="error",Ma="wss://relay.walletconnect.com",F0="relayer",Ve={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},$0="_subscription",vi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},L0=Z.ONE_SECOND,U0="2.6.2",M0="0.3",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},j0="subscription",H0="0.3",B0=Z.FIVE_SECONDS*1e3,q0="pairing",z0="0.3",zr={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},It={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},K0="history",V0="0.3",G0="expirer",yt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},k0="0.3";class W0{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=I0,this.version=P0,this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Vo(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Go(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Y0{constructor(e,r,i){this.core=e,this.logger=r,this.name=x0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=yo(n);return go(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Qd();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),o=yo(s),c=mn();return await ad(c,n,O0,o)},this.generateSharedKey=(n,s,o)=>{this.isInitialized();const c=this.getPrivateKey(n),l=ep(c,s);return this.setSymKey(l,o)},this.setSymKey=async(n,s)=>{this.isInitialized();const o=s||tp(n);return await this.keychain.set(o,n),o},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,o)=>{this.isInitialized();const c=jo(o),l=Fr(s);if(Ho(c)){const m=c.senderPublicKey,D=c.receiverPublicKey;n=await this.generateSharedKey(m,D)}const h=this.getSymKey(n),{type:f,senderPublicKey:_}=c;return ip({type:f,symKey:h,message:l,senderPublicKey:_})},this.decode=async(n,s,o)=>{this.isInitialized();const c=op(s,o);if(Ho(c)){const f=c.receiverPublicKey,_=c.senderPublicKey;n=await this.generateSharedKey(f,_)}const l=this.getSymKey(n),h=np({symKey:l,encoded:s});return Zi(h)},this.getPayloadType=n=>{const s=fi(n);return Mr(s.type)},this.getPayloadSenderPublicKey=n=>{const s=fi(n);return s.senderPublicKey?at(s.senderPublicKey,ct):void 0},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.keychain=i||new W0(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(La)}catch{e=mn(),await this.keychain.set(La,e)}return w0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class J0 extends Bh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=A0,this.version=C0,this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=li(n);let o=this.messages.get(i);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=n,this.messages.set(i,o),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),o=li(n);return typeof s[o]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=r}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Vo(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Go(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class X0 extends qh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new it.exports.EventEmitter,this.name=N0,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const o=s?.ttl||T0,c=wn(s),l=s?.prompt||!1,h=s?.tag||0,f={topic:i,message:n,opts:{ttl:o,relay:c,prompt:l,tag:h}},_=li(n);this.queue.set(_,f);try{await await di(this.rpcPublish(i,n,o,c,l,h),this.publishTimeout),this.relayer.events.emit(Ve.publish,f)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ve.connection_stalled);return}this.onPublish(_,f),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,o){var c,l,h,f;const _={method:pi(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:o}};return ut((c=_.params)==null?void 0:c.prompt)&&((l=_.params)==null||delete l.prompt),ut((h=_.params)==null?void 0:h.tag)&&((f=_.params)==null||delete f.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:_}),this.relayer.request(_)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:n}=e;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class Z0{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Q0=Object.defineProperty,e_=Object.defineProperties,t_=Object.getOwnPropertyDescriptors,ja=Object.getOwnPropertySymbols,r_=Object.prototype.hasOwnProperty,i_=Object.prototype.propertyIsEnumerable,Ha=(t,e,r)=>e in t?Q0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kr=(t,e)=>{for(var r in e||(e={}))r_.call(e,r)&&Ha(t,r,e[r]);if(ja)for(var r of ja(e))i_.call(e,r)&&Ha(t,r,e[r]);return t},Ln=(t,e)=>e_(t,t_(e));class n_ extends Vh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new Z0,this.events=new it.exports.EventEmitter,this.name=j0,this.version=H0,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ut,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=wn(n),o={topic:i,relay:s};this.pending.set(i,o);const c=await this.rpcSubscribe(i,s);return this.onSubscribe(c,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const o=new Z.Watch;o.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),n(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=B0&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(r,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=wn(i);await this.rpcUnsubscribe(e,r,n);const s=Le("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:pi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await di(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}return li(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:pi(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await di(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}}rpcUnsubscribe(e,r,i){const n={method:pi(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,Ln(Kr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Kr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Kr({},r)),this.topicMap.set(r.topic,e),this.events.emit(Ot.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Ot.deleted,Ln(Kr({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){if(!this.cached.length)return;const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}this.events.emit(Ot.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);dr(r)&&this.onBatchSubscribe(r.map((i,n)=>Ln(Kr({},e[n]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ve.connect,async()=>{await this.onConnect()}),this.relayer.on(Ve.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async e=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Ot.deleted,async e=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var s_=Object.defineProperty,Ba=Object.getOwnPropertySymbols,o_=Object.prototype.hasOwnProperty,a_=Object.prototype.propertyIsEnumerable,qa=(t,e,r)=>e in t?s_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,c_=(t,e)=>{for(var r in e||(e={}))o_.call(e,r)&&qa(t,r,e[r]);if(Ba)for(var r of Ba(e))a_.call(e,r)&&qa(t,r,e[r]);return t};class u_ extends zh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new it.exports.EventEmitter,this.name=F0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):br(Se.getDefaultLoggerOptions({level:e.logger||R0})),this.messages=new J0(this.logger,e.core),this.subscriber=new n_(this,this.logger),this.publisher=new X0(this,this.logger),this.relayUrl=e?.relayUrl||Ma,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Ot.created,s=>{s.topic===e&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(e,r),n()})]),i}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ve.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Ot.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,i)=>{await di(this.provider.connect(),5e3,"socket stalled").catch(n=>i(n)).then(()=>r()).finally(()=>this.removeListener(Ve.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ve.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const i=r;if(!this.isConnectionStalled(i.message))throw r;this.events.emit(Ve.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,await this.transportClose(),await new Promise(r=>setTimeout(r,500)),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Zt(new Yg(mp({sdkVersion:U0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),An(e)){if(!e.method.endsWith($0))return;const r=e.params,{topic:i,message:n,publishedAt:s}=r.data,o={topic:i,message:n,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(c_({type:"event",event:r.id},o)),this.events.emit(r.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ve.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Pn(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(vi.payload,e=>this.onProviderPayload(e)),this.provider.on(vi.connect,()=>{this.events.emit(Ve.connect)}),this.provider.on(vi.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(vi.error,e=>{this.logger.error(e),this.events.emit(Ve.error,e)})}registerEventListeners(){this.events.on(Ve.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ve.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Z.toMiliseconds(L0))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var h_=Object.defineProperty,za=Object.getOwnPropertySymbols,l_=Object.prototype.hasOwnProperty,f_=Object.prototype.propertyIsEnumerable,Ka=(t,e,r)=>e in t?h_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Va=(t,e)=>{for(var r in e||(e={}))l_.call(e,r)&&Ka(t,r,e[r]);if(za)for(var r of za(e))f_.call(e,r)&&Ka(t,r,e[r]);return t};class mi extends Kh{constructor(e,r,i,n=Ut,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=M0,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!ut(o)?this.map.set(this.getKey(o),o):Bp(o)?this.map.set(o.id,o):qp(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)},this.set=async(o,c)=>{this.isInitialized(),this.map.has(o)?await this.update(o,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:c}),this.map.set(o,c),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(c=>Object.keys(o).every(l=>Jg(c[l],o[l]))):this.values),this.update=async(o,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:c});const l=Va(Va({},this.getData(o)),c);this.map.set(o,l),await this.persist()},this.delete=async(o,c)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:c}),this.map.delete(o),await this.persist())},this.logger=Se.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class d_{constructor(e,r){this.core=e,this.logger=r,this.name=q0,this.version=z0,this.events=new it.exports,this.initialized=!1,this.storagePrefix=Ut,this.ignoredPayloadTypes=[Jt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=mn(),n=await this.core.crypto.setSymKey(i),s=xt(Z.FIVE_MINUTES),o={protocol:Ua},c={topic:n,expiry:s,relay:o,active:!1},l=Tp({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:o});return await this.pairings.set(n,c),await this.core.relayer.subscribe(n),this.core.expirer.set(n,s),{topic:n,uri:l}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:s,relay:o}=Ap(i.uri);if(this.pairings.keys.includes(n))throw new Error(`Pairing already exists: ${n}`);if(this.core.crypto.hasKeys(n))throw new Error(`Keychain already exists: ${n}`);const c=xt(Z.FIVE_MINUTES),l={topic:n,relay:o,expiry:c,active:!1};return await this.pairings.set(n,l),await this.core.crypto.setSymKey(s,n),await this.core.relayer.subscribe(n,{relay:o}),this.core.expirer.set(n,c),i.activatePairing&&await this.activate({topic:n}),l},this.activate=async({topic:i})=>{this.isInitialized();const n=xt(Z.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:o,resolve:c,reject:l}=lr();this.events.once($e("pairing_ping",s),({error:h})=>{h?l(h):c()}),await o()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Le("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,s)=>{const o=yi(n,s),c=await this.core.crypto.encode(i,o),l=zr[n].req;return this.core.history.set(i,o),await this.core.relayer.publish(i,c,l),o.id},this.sendResult=async(i,n,s)=>{const o=Pn(i,s),c=await this.core.crypto.encode(n,o),l=await this.core.history.get(n,i),h=zr[l.request.method].res;await this.core.relayer.publish(n,c,h),await this.core.history.resolve(o)},this.sendError=async(i,n,s)=>{const o=_i(i,s),c=await this.core.crypto.encode(n,o),l=await this.core.history.get(n,i),h=zr[l.request.method]?zr[l.request.method].res:zr.unregistered_method.res;await this.core.relayer.publish(n,c,h),await this.core.history.resolve(o)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Le("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Lt(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i,o=s.method;if(this.pairings.keys.includes(n))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,o=(await this.core.history.get(n,s.id)).request.method;if(this.pairings.keys.includes(n))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit("pairing_ping",{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{Nt(n)?this.events.emit($e("pairing_ping",s),{}):mt(n)&&this.events.emit($e("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:s,topic:i})}catch(o){await this.sendError(s,i,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:o}=n;try{if(this.registeredMethods.includes(o))return;const c=Le("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,i,c),this.logger.error(c)}catch(c){await this.sendError(s,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Le("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ft(i)){const{message:n}=V("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!Hp(i.uri)){const{message:n}=V("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!ft(i)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!ft(i)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ke(i,!1)){const{message:n}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Lt(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=V("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=Se.generateChildLogger(r,this.name),this.pairings=new mi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ve.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);An(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Cn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(yt.expired,async e=>{const{topic:r}=Wo(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class p_ extends Hh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new it.exports.EventEmitter,this.name=K0,this.version=V0,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const o={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(It.created,o)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=mt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(It.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(It.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:yi(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(It.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(It.created,e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.updated,e=>{const r=It.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(It.deleted,e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class g_ extends Gh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new it.exports.EventEmitter,this.name=G0,this.version=k0,this.cached=[],this.initialized=!1,this.storagePrefix=Ut,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),o={target:s,expiry:n};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(yt.created,{target:s,expiration:o})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(yt.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Se.generateChildLogger(r,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return wp(e);if(typeof e=="number")return Ep(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Z.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(yt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Or.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yt.created,e=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.expired,e=>{const r=yt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.deleted,e=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var y_=Object.defineProperty,Ga=Object.getOwnPropertySymbols,__=Object.prototype.hasOwnProperty,b_=Object.prototype.propertyIsEnumerable,ka=(t,e,r)=>e in t?y_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Wa=(t,e)=>{for(var r in e||(e={}))__.call(e,r)&&ka(t,r,e[r]);if(Ga)for(var r of Ga(e))b_.call(e,r)&&ka(t,r,e[r]);return t};class Un extends jh{constructor(e){super(e),this.protocol=$a,this.version=E0,this.name=$n,this.events=new it.exports.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Ma;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:br(Se.getDefaultLoggerOptions({level:e?.logger||D0.logger}));this.logger=Se.generateChildLogger(r,this.name),this.heartbeat=new Or.HeartBeat,this.crypto=new Y0(this,this.logger,e?.keychain),this.history=new p_(this,this.logger),this.expirer=new g_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new _u(Wa(Wa({},S0),e?.storageOptions)),this.relayer=new u_({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new d_(this,this.logger)}static async init(e){const r=new Un(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const v_=Un,Ya="wc",Ja=2,Xa="client",Mn=`${Ya}@${Ja}:${Xa}:`,jn={name:Xa,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},m_="proposal",Za="Proposal expired",w_="session",wi=Z.SEVEN_DAYS,E_="engine",Vr={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},Hn={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},D_="request";var S_=Object.defineProperty,x_=Object.defineProperties,O_=Object.getOwnPropertyDescriptors,Qa=Object.getOwnPropertySymbols,I_=Object.prototype.hasOwnProperty,P_=Object.prototype.propertyIsEnumerable,ec=(t,e,r)=>e in t?S_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_t=(t,e)=>{for(var r in e||(e={}))I_.call(e,r)&&ec(t,r,e[r]);if(Qa)for(var r of Qa(e))P_.call(e,r)&&ec(t,r,e[r]);return t},Bn=(t,e)=>x_(t,O_(e));class A_ extends Wh{constructor(e){super(e),this.name=E_,this.events=new it.exports,this.initialized=!1,this.ignoredPayloadTypes=[Jt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Vr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=Bn(_t({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:o,sessionProperties:c,relays:l}=i;let h=n,f,_=!1;if(h&&(_=this.client.core.pairing.pairings.get(h).active),!h||!_){const{topic:P,uri:y}=await this.client.core.pairing.create();h=P,f=y}const m=await this.client.core.crypto.generateKeyPair(),D=_t({requiredNamespaces:s,optionalNamespaces:o,relays:l??[{protocol:Ua}],proposer:{publicKey:m,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:w,resolve:R,done:F}=lr(Z.FIVE_MINUTES,Za);if(this.events.once($e("session_connect"),async({error:P,session:y})=>{if(P)w(P);else if(y){y.self.publicKey=m;const S=Bn(_t({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,S),await this.setExpiry(y.topic,y.expiry),h&&await this.client.core.pairing.updateMetadata({topic:h,metadata:y.peer.metadata}),R(S)}}),!h){const{message:P}=V("NO_MATCHING_KEY",`connect() pairing topic: ${h}`);throw new Error(P)}const B=await this.sendRequest(h,"wc_sessionPropose",D),x=xt(Z.FIVE_MINUTES);return await this.setProposal(B,_t({id:B,expiry:x},D)),{uri:f,approval:F}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s,sessionProperties:o}=r,c=this.client.proposal.get(i);let{pairingTopic:l,proposer:h,requiredNamespaces:f,optionalNamespaces:_}=c;l=l||"",pr(f)||(f=$p(s,"approve()"));const m=await this.client.core.crypto.generateKeyPair(),D=h.publicKey,w=await this.client.core.crypto.generateSharedKey(m,D);l&&i&&(await this.client.core.pairing.updateMetadata({topic:l,metadata:h.metadata}),await this.sendResult(i,l,{relay:{protocol:n??"irn"},responderPublicKey:m}),await this.client.proposal.delete(i,Le("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}));const R=_t({relay:{protocol:n??"irn"},namespaces:s,requiredNamespaces:f,optionalNamespaces:_,pairingTopic:l,controller:{publicKey:m,metadata:this.client.metadata},expiry:xt(wi)},o&&{sessionProperties:o});await this.client.core.relayer.subscribe(w),await this.sendRequest(w,"wc_sessionSettle",R);const F=Bn(_t({},R),{topic:w,pairingTopic:l,acknowledged:!1,self:R.controller,peer:{publicKey:h.publicKey,metadata:h.metadata},controller:m});return await this.client.session.set(w,F),await this.setExpiry(w,xt(wi)),{topic:w,acknowledged:()=>new Promise(B=>B(this.client.session.get(w)))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,Le("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:o,resolve:c,reject:l}=lr();return this.events.once($e("session_update",s),({error:h})=>{h?l(h):c()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:o,reject:c}=lr();return this.events.once($e("session_extend",n),({error:l})=>{l?c(l):o()}),await this.setExpiry(i,xt(wi)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s,expiry:o}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i},o),{done:l,resolve:h,reject:f}=lr(o);return this.events.once($e("session_request",c),({error:_,result:m})=>{_?f(_):h(m)}),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:c}),await l()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Nt(n)?await this.sendResult(s,i,n.result):mt(n)&&await this.sendError(s,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:o,reject:c}=lr();this.events.once($e("session_ping",n),({error:l})=>{l?c(l):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",Le("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>Mp(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Le("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,Le("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Vr.wc_sessionRequest.req.ttl,{id:n,topic:s,params:o}=r;await this.client.pendingRequest.set(n,{id:n,topic:s,params:o}),i&&this.client.core.expirer.set(n,xt(i))},this.sendRequest=async(r,i,n,s)=>{const o=yi(i,n),c=await this.client.core.crypto.encode(r,o),l=Vr[i].req;return s&&(l.ttl=s),this.client.core.history.set(r,o),this.client.core.relayer.publish(r,c,l),o.id},this.sendResult=async(r,i,n)=>{const s=Pn(r,n),o=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),l=Vr[c.request.method].res;this.client.core.relayer.publish(i,o,l),await this.client.core.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=_i(r,n),o=await this.client.core.crypto.encode(i,s),c=await this.client.core.history.get(i,r),l=Vr[c.request.method].res;this.client.core.relayer.publish(i,o,l),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{Lt(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Lt(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.core.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(_t({},i.params));const o=xt(Z.FIVE_MINUTES),c=_t({id:s,pairingTopic:r,expiry:o},n);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Nt(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const c=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const h=await this.client.core.crypto.generateSharedKey(c,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const f=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else mt(i)&&(await this.client.proposal.delete(n,Le("USER_DISCONNECTED")),this.events.emit($e("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:c,expiry:l,namespaces:h,requiredNamespaces:f,optionalNamespaces:_,sessionProperties:m,pairingTopic:D}=i.params,w=_t({topic:r,relay:o,expiry:l,namespaces:h,acknowledged:!0,pairingTopic:D,requiredNamespaces:f,optionalNamespaces:_,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},m&&{sessionProperties:m});await this.sendResult(i.id,r,!0),this.events.emit($e("session_connect"),{session:w})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Nt(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit($e("session_approve",n),{})):mt(i)&&(await this.client.session.delete(r,Le("USER_DISCONNECTED")),this.events.emit($e("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(_t({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Nt(i)?this.events.emit($e("session_update",n),{}):mt(i)&&this.events.emit($e("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,xt(wi)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Nt(i)?this.events.emit($e("session_extend",n),{}):mt(i)&&this.events.emit($e("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{Nt(i)?this.events.emit($e("session_ping",n),{}):mt(i)&&this.events.emit($e("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),this.client.core.relayer.once(Ve.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(n,r,!0),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(_t({topic:r},s)),await this.setPendingSessionRequest({id:n,topic:r,params:s}),this.client.events.emit("session_request",{id:n,topic:r,params:s})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Nt(i)?this.events.emit($e("session_request",n),{result:i.result}):mt(i)&&this.events.emit($e("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(_t({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(o){await this.sendError(n,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!ft(r)){const{message:l}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,relays:c}=r;if(ut(i)||await this.isValidPairingTopic(i),!Jp(c,!0)){const{message:l}=V("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}!ut(n)&&pr(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!ut(s)&&pr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),ut(o)||this.validateSessionProps(o,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=Yp(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!ft(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:o}=r;await this.isValidProposalId(i);const c=this.client.proposal.get(i),l=gi(n,"approve()");if(l)throw new Error(l.message);const h=ta(c.requiredNamespaces,n,"approve()");if(h)throw new Error(h.message);if(!Ke(s,!0)){const{message:f}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}ut(o)||this.validateSessionProps(o,"sessionProperties")},this.isValidReject=async r=>{if(!ft(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Zp(n)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!ft(r)){const{message:h}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:i,controller:n,namespaces:s,expiry:o}=r;if(!Qo(i)){const{message:h}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const c=zp(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const l=gi(s,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(Lt(o)){const{message:h}=V("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!ft(r)){const{message:l}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(l)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),o=gi(n,"update()");if(o)throw new Error(o.message);const c=ta(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!ft(r)){const{message:n}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!ft(r)){const{message:l}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(l)}const{topic:i,request:n,chainId:s,expiry:o}=r;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!ea(c,s)){const{message:l}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(l)}if(!Qp(n)){const{message:l}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(l)}if(!rg(c,s,n.method)){const{message:l}=V("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(l)}if(o&&!og(o,Hn)){const{message:l}=V("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Hn.min} and ${Hn.max}`);throw new Error(l)}},this.isValidRespond=async r=>{if(!ft(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!eg(n)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!ft(r)){const{message:n}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!ft(r)){const{message:c}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!ea(o,s)){const{message:c}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!tg(n)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!ig(o,s,n.name)){const{message:c}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!ft(r)){const{message:n}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!Ke(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ve.message,async e=>{const{topic:r,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);An(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Cn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(yt.expired,async e=>{const{topic:r,id:i}=Wo(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Ke(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Lt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!Ke(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Lt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Ke(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Xp(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Lt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class C_ extends mi{constructor(e,r){super(e,r,m_,Mn),this.core=e,this.logger=r}}class T_ extends mi{constructor(e,r){super(e,r,w_,Mn),this.core=e,this.logger=r}}class N_ extends mi{constructor(e,r){super(e,r,D_,Mn,i=>i.id),this.core=e,this.logger=r}}class qn extends kh{constructor(e){super(e),this.protocol=Ya,this.version=Ja,this.name=jn.name,this.events=new it.exports.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=e?.name||jn.name,this.metadata=e?.metadata||yp();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:br(Se.getDefaultLoggerOptions({level:e?.logger||jn.logger}));this.core=e?.core||new v_(e),this.logger=Se.generateChildLogger(r,this.name),this.session=new T_(this.core,this.logger),this.proposal=new C_(this.core,this.logger),this.pendingRequest=new N_(this.core,this.logger),this.engine=new A_(this)}static async init(e){const r=new qn(e);return await r.initialize(),r}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var zn={exports:{}};(function(t,e){var r=typeof self<"u"?self:ze,i=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(o){var c={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function l(g){return g&&DataView.prototype.isPrototypeOf(g)}if(c.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(g){return g&&h.indexOf(Object.prototype.toString.call(g))>-1};function _(g){if(typeof g!="string"&&(g=String(g)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(g))throw new TypeError("Invalid character in header field name");return g.toLowerCase()}function m(g){return typeof g!="string"&&(g=String(g)),g}function D(g){var b={next:function(){var L=g.shift();return{done:L===void 0,value:L}}};return c.iterable&&(b[Symbol.iterator]=function(){return b}),b}function w(g){this.map={},g instanceof w?g.forEach(function(b,L){this.append(L,b)},this):Array.isArray(g)?g.forEach(function(b){this.append(b[0],b[1])},this):g&&Object.getOwnPropertyNames(g).forEach(function(b){this.append(b,g[b])},this)}w.prototype.append=function(g,b){g=_(g),b=m(b);var L=this.map[g];this.map[g]=L?L+", "+b:b},w.prototype.delete=function(g){delete this.map[_(g)]},w.prototype.get=function(g){return g=_(g),this.has(g)?this.map[g]:null},w.prototype.has=function(g){return this.map.hasOwnProperty(_(g))},w.prototype.set=function(g,b){this.map[_(g)]=m(b)},w.prototype.forEach=function(g,b){for(var L in this.map)this.map.hasOwnProperty(L)&&g.call(b,this.map[L],L,this)},w.prototype.keys=function(){var g=[];return this.forEach(function(b,L){g.push(L)}),D(g)},w.prototype.values=function(){var g=[];return this.forEach(function(b){g.push(b)}),D(g)},w.prototype.entries=function(){var g=[];return this.forEach(function(b,L){g.push([L,b])}),D(g)},c.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function R(g){if(g.bodyUsed)return Promise.reject(new TypeError("Already read"));g.bodyUsed=!0}function F(g){return new Promise(function(b,L){g.onload=function(){b(g.result)},g.onerror=function(){L(g.error)}})}function B(g){var b=new FileReader,L=F(b);return b.readAsArrayBuffer(g),L}function x(g){var b=new FileReader,L=F(b);return b.readAsText(g),L}function P(g){for(var b=new Uint8Array(g),L=new Array(b.length),U=0;U<b.length;U++)L[U]=String.fromCharCode(b[U]);return L.join("")}function y(g){if(g.slice)return g.slice(0);var b=new Uint8Array(g.byteLength);return b.set(new Uint8Array(g)),b.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(g){this._bodyInit=g,g?typeof g=="string"?this._bodyText=g:c.blob&&Blob.prototype.isPrototypeOf(g)?this._bodyBlob=g:c.formData&&FormData.prototype.isPrototypeOf(g)?this._bodyFormData=g:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)?this._bodyText=g.toString():c.arrayBuffer&&c.blob&&l(g)?(this._bodyArrayBuffer=y(g.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(g)||f(g))?this._bodyArrayBuffer=y(g):this._bodyText=g=Object.prototype.toString.call(g):this._bodyText="",this.headers.get("content-type")||(typeof g=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var g=R(this);if(g)return g;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?R(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(B)}),this.text=function(){var g=R(this);if(g)return g;if(this._bodyBlob)return x(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(P(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function a(g){var b=g.toUpperCase();return E.indexOf(b)>-1?b:g}function d(g,b){b=b||{};var L=b.body;if(g instanceof d){if(g.bodyUsed)throw new TypeError("Already read");this.url=g.url,this.credentials=g.credentials,b.headers||(this.headers=new w(g.headers)),this.method=g.method,this.mode=g.mode,this.signal=g.signal,!L&&g._bodyInit!=null&&(L=g._bodyInit,g.bodyUsed=!0)}else this.url=String(g);if(this.credentials=b.credentials||this.credentials||"same-origin",(b.headers||!this.headers)&&(this.headers=new w(b.headers)),this.method=a(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&L)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(L)}d.prototype.clone=function(){return new d(this,{body:this._bodyInit})};function M(g){var b=new FormData;return g.trim().split("&").forEach(function(L){if(L){var U=L.split("="),N=U.shift().replace(/\+/g," "),T=U.join("=").replace(/\+/g," ");b.append(decodeURIComponent(N),decodeURIComponent(T))}}),b}function q(g){var b=new w,L=g.replace(/\r?\n[\t ]+/g," ");return L.split(/\r?\n/).forEach(function(U){var N=U.split(":"),T=N.shift().trim();if(T){var j=N.join(":").trim();b.append(T,j)}}),b}S.call(d.prototype);function G(g,b){b||(b={}),this.type="default",this.status=b.status===void 0?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"OK",this.headers=new w(b.headers),this.url=b.url||"",this._initBody(g)}S.call(G.prototype),G.prototype.clone=function(){return new G(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},G.error=function(){var g=new G(null,{status:0,statusText:""});return g.type="error",g};var J=[301,302,303,307,308];G.redirect=function(g,b){if(J.indexOf(b)===-1)throw new RangeError("Invalid status code");return new G(null,{status:b,headers:{location:g}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(b,L){this.message=b,this.name=L;var U=Error(b);this.stack=U.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function X(g,b){return new Promise(function(L,U){var N=new d(g,b);if(N.signal&&N.signal.aborted)return U(new o.DOMException("Aborted","AbortError"));var T=new XMLHttpRequest;function j(){T.abort()}T.onload=function(){var H={status:T.status,statusText:T.statusText,headers:q(T.getAllResponseHeaders()||"")};H.url="responseURL"in T?T.responseURL:H.headers.get("X-Request-URL");var Q="response"in T?T.response:T.responseText;L(new G(Q,H))},T.onerror=function(){U(new TypeError("Network request failed"))},T.ontimeout=function(){U(new TypeError("Network request failed"))},T.onabort=function(){U(new o.DOMException("Aborted","AbortError"))},T.open(N.method,N.url,!0),N.credentials==="include"?T.withCredentials=!0:N.credentials==="omit"&&(T.withCredentials=!1),"responseType"in T&&c.blob&&(T.responseType="blob"),N.headers.forEach(function(H,Q){T.setRequestHeader(Q,H)}),N.signal&&(N.signal.addEventListener("abort",j),T.onreadystatechange=function(){T.readyState===4&&N.signal.removeEventListener("abort",j)}),T.send(typeof N._bodyInit>"u"?null:N._bodyInit)})}return X.polyfill=!0,s.fetch||(s.fetch=X,s.Headers=w,s.Request=d,s.Response=G),o.Headers=w,o.Request=d,o.Response=G,o.fetch=X,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var n=i;e=n.fetch,e.default=n.fetch,e.fetch=n.fetch,e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response,t.exports=e})(zn,zn.exports);var tc=Dc(zn.exports);const rc={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},ic=10;class gr{constructor(e){if(this.url=e,this.events=new it.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!da(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=Fr(e),s=await(await tc(this.url,Object.assign(Object.assign({},rc),{body:i}))).json();this.onPayload({data:s})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!da(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const r=Fr({id:1,jsonrpc:"2.0",method:"test",params:[]});await tc(e,Object.assign(Object.assign({},rc),{body:r})),this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Zi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=_i(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return oa(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ic&&this.events.setMaxListeners(ic)}}const nc="error",R_="wss://relay.walletconnect.com",F_="wc",$_="universal_provider",sc=`${F_}@${2}:${$_}:`,L_="https://rpc.walletconnect.com/v1",Qt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var U_=Object.defineProperty,oc=Object.getOwnPropertySymbols,M_=Object.prototype.hasOwnProperty,j_=Object.prototype.propertyIsEnumerable,ac=(t,e,r)=>e in t?U_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kn=(t,e)=>{for(var r in e||(e={}))M_.call(e,r)&&ac(t,r,e[r]);if(oc)for(var r of oc(e))j_.call(e,r)&&ac(t,r,e[r]);return t};function Pt(t,e,r){let i;const n=Vn(t);return e.rpcMap&&(i=e.rpcMap[n]),i||(i=`${L_}?chainId=eip155:${n}&projectId=${r}`),i}function Vn(t){return t.includes("eip155")?Number(t.split(":")[1]):Number(t)}function H_(t,e){if(!e.includes(t))throw new Error(`Chain '${t}' not approved. Please use one of the following: ${e.toString()}`)}function B_(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function q_(t,e){const r=Object.keys(e.namespaces).filter(n=>n.includes(t));if(!r.length)return[];const i=[];return r.forEach(n=>{const s=e.namespaces[n].accounts;i.push(...s)}),i}function z_(t,e={}){const r=cc(t),i=cc(e);return Kn({},Object.assign(r,i))}function cc(t){var e,r,i,n;const s={};if(!pr(t))return s;for(const[o,c]of Object.entries(t)){const l=uc(o)?[o]:c.chains,h=c.methods||[],f=c.events||[],_=hc(o);s[_]={chains:Gn(l,(e=s[_])==null?void 0:e.chains),methods:Gn(h,(r=s[_])==null?void 0:r.methods),events:Gn(f,(i=s[_])==null?void 0:i.events),rpcMap:Kn(Kn({},(n=s[_])==null?void 0:n.rpcMap),c.rpcMap)}}return s}function uc(t){return t.includes(":")}function hc(t){return uc(t)?t.split(":")[0]:t}function Gn(t=[],e=[]){return[...new Set([...t,...e])]}const yr=(t,e)=>{const r=i=>{i.request!==e.request||i.topic!==e.topic||(t.events.removeListener("session_request_sent",r),K_(e))};t.on("session_request_sent",r)};function K_(t){if(typeof window<"u")try{const e=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(e){const r=JSON.parse(e),i=r?.href;if(typeof i=="string"){i.endsWith("/")&&i.slice(0,-1);const n=`${i}/wc?requestId=${t.id}&sessionTopic=${t.topic}`;window.open(n,"_self","noreferrer noopener")}}}catch(e){console.error(e)}}class V_{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(yr(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){const i=Vn(e);if(!this.httpProviders[i]){const n=r||Pt(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const i=r||Pt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Zt(new gr(i))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=Vn(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}handleSwitchChain(e){const r=parseInt(e,16),i=`${this.name}:${r}`;H_(i,this.namespace.chains),this.setDefaultChain(`${r}`)}}class G_{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(yr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||Pt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(Qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Pt(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Zt(new gr(i))}}class k_{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(yr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||Pt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Pt(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Zt(new gr(i))}}class W_{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(yr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(Qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const i=this.getCardanoRPCUrl(r);e[r]=this.createHttpProvider(r,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||this.getCardanoRPCUrl(e);return typeof i>"u"?void 0:new Zt(new gr(i))}}class Y_{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(yr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||Pt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(Qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Pt(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Zt(new gr(i))}}class J_{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(yr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||Pt(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(Qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||Pt(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new Zt(new gr(i))}}var X_=Object.defineProperty,Z_=Object.defineProperties,Q_=Object.getOwnPropertyDescriptors,lc=Object.getOwnPropertySymbols,eb=Object.prototype.hasOwnProperty,tb=Object.prototype.propertyIsEnumerable,fc=(t,e,r)=>e in t?X_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ei=(t,e)=>{for(var r in e||(e={}))eb.call(e,r)&&fc(t,r,e[r]);if(lc)for(var r of lc(e))tb.call(e,r)&&fc(t,r,e[r]);return t},kn=(t,e)=>Z_(t,Q_(e));class Di{constructor(e){this.events=new it.exports,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:br(Se.getDefaultLoggerOptions({level:e?.logger||nc}))}static async init(e){const r=new Di(e);return await r.initialize(),r}async request(e,r){const[i,n]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Ei({},e),chainId:`${i}:${n}`,topic:this.session.topic})}sendAsync(e,r,i){this.request(e,i).then(n=>r(null,n)).catch(n=>r(n,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Le("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await n().then(s=>{this.session=s}).catch(s=>{if(s.message!==Za)throw s;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{const[i,n]=this.validateChain(e);this.getProvider(i).setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(dr(r)){for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await qn.init({logger:this.providerOpts.logger||nc,relayUrl:this.providerOpts.relayUrl||R_,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");[...new Set(Object.keys(this.session.namespaces).map(e=>hc(e)))].forEach(e=>{if(!this.session)return;const r=q_(e,this.session),i=B_(r),n=z_(this.namespaces,this.optionalNamespaces),s=kn(Ei({},n[e]),{accounts:r,chains:i});switch(e){case"eip155":this.rpcProviders[e]=new V_({client:this.client,namespace:s,events:this.events});break;case"solana":this.rpcProviders[e]=new G_({client:this.client,namespace:s,events:this.events});break;case"cosmos":this.rpcProviders[e]=new k_({client:this.client,namespace:s,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new W_({client:this.client,namespace:s,events:this.events});break;case"elrond":this.rpcProviders[e]=new Y_({client:this.client,namespace:s,events:this.events});break;case"multiversx":this.rpcProviders[e]=new J_({client:this.client,namespace:s,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:i}=r;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(r.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,s=(i=this.client)==null?void 0:i.session.get(e);this.session=kn(Ei({},s),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",kn(Ei({},Le("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Qt.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:i,sessionProperties:n}=e;if(!r||!Object.keys(r).length)throw new Error("Namespaces must be not empty");this.namespaces=r,this.optionalNamespaces=i,this.sessionProperties=n,this.persist("namespaces",r),this.persist("optionalNamespaces",i)}validateChain(e){const[r,i]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&i)return[r,i];const n=Object.keys(this.namespaces)[0],s=this.rpcProviders[n].getDefaultChain();return[n,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){const[i,n]=this.validateChain(e);r||this.getProvider(i).setDefaultChain(n),this.namespaces[i].defaultChain=n,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${sc}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${sc}/${e}`)}}const rb=Di;qt.UniversalProvider=rb,qt.default=Di,Object.defineProperty(qt,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map

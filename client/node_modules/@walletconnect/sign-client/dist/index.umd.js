(function(xe,et){typeof exports=="object"&&typeof module<"u"?et(exports):typeof define=="function"&&define.amd?define(["exports"],et):(xe=typeof globalThis<"u"?globalThis:xe||self,et(xe["@walletconnect/sign-client"]={}))})(this,function(xe){"use strict";var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}function ec(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var tc=rc;function rc(t,e,r){var n=r&&r.stringify||ec,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var a=new Array(s);a[0]=n(t);for(var c=1;c<s;c++)a[c]=n(e[c]);return a.join(" ")}if(typeof t!="string")return t;var l=e.length;if(l===0)return t;for(var h="",f=1-i,y=-1,b=t&&t.length||0,v=0;v<b;){if(t.charCodeAt(v)===37&&v+1<b){switch(y=y>-1?y:0,t.charCodeAt(v+1)){case 100:case 102:if(f>=l||e[f]==null)break;y<v&&(h+=t.slice(y,v)),h+=Number(e[f]),y=v+2,v++;break;case 105:if(f>=l||e[f]==null)break;y<v&&(h+=t.slice(y,v)),h+=Math.floor(Number(e[f])),y=v+2,v++;break;case 79:case 111:case 106:if(f>=l||e[f]===void 0)break;y<v&&(h+=t.slice(y,v));var E=typeof e[f];if(E==="string"){h+="'"+e[f]+"'",y=v+2,v++;break}if(E==="function"){h+=e[f].name||"<anonymous>",y=v+2,v++;break}h+=n(e[f]),y=v+2,v++;break;case 115:if(f>=l)break;y<v&&(h+=t.slice(y,v)),h+=String(e[f]),y=v+2,v++;break;case 37:y<v&&(h+=t.slice(y,v)),h+="%",y=v+2,v++,f--;break}++f}++v}return y===-1?t:(y<b&&(h+=t.slice(y)),h)}const ji=tc;var Kr=Dt;const fr=fc().console||{},nc={mapHttpRequest:Vr,mapHttpResponse:Vr,wrapRequestSerializer:Tn,wrapResponseSerializer:Tn,wrapErrorSerializer:Tn,req:Vr,res:Vr,err:cc};function ic(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Dt(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||fr;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=ic(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const a=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const c=t.level||"info",l=Object.create(r);l.log||(l.log=dr),Object.defineProperty(l,"levelVal",{get:f}),Object.defineProperty(l,"level",{get:y,set:b});const h={transmit:e,serialize:i,asObject:t.browser.asObject,levels:a,timestamp:uc(t)};l.levels=Dt.levels,l.level=c,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=dr,l.serializers=n,l._serialize=i,l._stdErrSerialize=s,l.child=v,e&&(l._logEvent=In());function f(){return this.level==="silent"?1/0:this.levels.values[this.level]}function y(){return this._level}function b(E){if(E!=="silent"&&!this.levels.values[E])throw Error("unknown level "+E);this._level=E,tr(h,l,"error","log"),tr(h,l,"fatal","error"),tr(h,l,"warn","error"),tr(h,l,"info","log"),tr(h,l,"debug","log"),tr(h,l,"trace","log")}function v(E,A){if(!E)throw new Error("missing bindings for child Pino");A=A||{},i&&E.serializers&&(A.serializers=E.serializers);const R=A.serializers;if(i&&R){var j=Object.assign({},n,R),S=t.browser.serialize===!0?Object.keys(j):i;delete E.serializers,Hr([E],S,j,this._stdErrSerialize)}function x(g){this._childLevel=(g._childLevel|0)+1,this.error=rr(g,E,"error"),this.fatal=rr(g,E,"fatal"),this.warn=rr(g,E,"warn"),this.info=rr(g,E,"info"),this.debug=rr(g,E,"debug"),this.trace=rr(g,E,"trace"),j&&(this.serializers=j,this._serialize=S),e&&(this._logEvent=In([].concat(g._logEvent.bindings,E)))}return x.prototype=this,new x(this)}return l}Dt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Dt.stdSerializers=nc,Dt.stdTimeFunctions=Object.assign({},{nullTime:Bi,epochTime:zi,unixTime:hc,isoTime:lc});function tr(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?dr:i[r]?i[r]:fr[r]||fr[n]||dr,sc(t,e,r)}function sc(t,e,r){!t.transmit&&e[r]===dr||(e[r]=function(n){return function(){const s=t.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===fr?fr:this;for(var l=0;l<a.length;l++)a[l]=arguments[l];if(t.serialize&&!t.asObject&&Hr(a,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(c,oc(this,r,a,s)):n.apply(c,a),t.transmit){const h=t.transmit.level||e.level,f=Dt.levels.values[h],y=Dt.levels.values[r];if(y<f)return;ac(this,{ts:s,methodLevel:r,methodValue:y,transmitLevel:h,transmitValue:Dt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},a)}}}(e[r]))}function oc(t,e,r,n){t._serialize&&Hr(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const a={};n&&(a.time=n),a.level=Dt.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof i[0]=="object";)Object.assign(a,i.shift());s=i.length?ji(i.shift(),i):void 0}else typeof s=="string"&&(s=ji(i.shift(),i));return s!==void 0&&(a.msg=s),a}function Hr(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=Dt.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function rr(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function ac(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,a=e.methodValue,c=e.val,l=t._logEvent.bindings;Hr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(h){return l.indexOf(h)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=a,n(s,t._logEvent,c),t._logEvent=In(l)}function In(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function cc(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function uc(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Bi:zi}function Vr(){return{}}function Tn(t){return t}function dr(){}function Bi(){return!1}function zi(){return Date.now()}function hc(){return Math.round(Date.now()/1e3)}function lc(){return new Date(Date.now()).toISOString()}function fc(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var lt={exports:{}},nr=typeof Reflect=="object"?Reflect:null,qi=nr&&typeof nr.apply=="function"?nr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Gr;nr&&typeof nr.ownKeys=="function"?Gr=nr.ownKeys:Object.getOwnPropertySymbols?Gr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Gr=function(e){return Object.getOwnPropertyNames(e)};function dc(t){console&&console.warn&&console.warn(t)}var Ki=Number.isNaN||function(e){return e!==e};function De(){De.init.call(this)}lt.exports=De,lt.exports.once=yc,De.EventEmitter=De,De.prototype._events=void 0,De.prototype._eventsCount=0,De.prototype._maxListeners=void 0;var Hi=10;function Wr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(De,"defaultMaxListeners",{enumerable:!0,get:function(){return Hi},set:function(t){if(typeof t!="number"||t<0||Ki(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Hi=t}}),De.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},De.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ki(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Vi(t){return t._maxListeners===void 0?De.defaultMaxListeners:t._maxListeners}De.prototype.getMaxListeners=function(){return Vi(this)},De.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")qi(l,this,r);else for(var h=l.length,f=Xi(l,h),n=0;n<h;++n)qi(f[n],this,r);return!0};function Gi(t,e,r,n){var i,s,a;if(Wr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),a=s[e]),a===void 0)a=s[e]=r,++t._eventsCount;else if(typeof a=="function"?a=s[e]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),i=Vi(t),i>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,dc(c)}return t}De.prototype.addListener=function(e,r){return Gi(this,e,r,!1)},De.prototype.on=De.prototype.addListener,De.prototype.prependListener=function(e,r){return Gi(this,e,r,!0)};function pc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Wi(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=pc.bind(n);return i.listener=r,n.wrapFn=i,i}De.prototype.once=function(e,r){return Wr(r),this.on(e,Wi(this,e,r)),this},De.prototype.prependOnceListener=function(e,r){return Wr(r),this.prependListener(e,Wi(this,e,r)),this},De.prototype.removeListener=function(e,r){var n,i,s,a,c;if(Wr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===r||n[a].listener===r){c=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():gc(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this},De.prototype.off=De.prototype.removeListener,De.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Yi(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?_c(i):Xi(i,i.length)}De.prototype.listeners=function(e){return Yi(this,e,!0)},De.prototype.rawListeners=function(e){return Yi(this,e,!1)},De.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ki.call(t,e)},De.prototype.listenerCount=ki;function ki(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}De.prototype.eventNames=function(){return this._eventsCount>0?Gr(this._events):[]};function Xi(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function gc(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function _c(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function yc(t,e){return new Promise(function(r,n){function i(a){t.removeListener(e,s),n(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Ji(t,e,s,{once:!0}),e!=="error"&&bc(t,i,{once:!0})})}function bc(t,e,r){typeof t.on=="function"&&Ji(t,"error",e,r)}function Ji(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Yr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Nn=function(t,e){return Nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Nn(t,e)};function wc(t,e){Nn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Pn=function(){return Pn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Pn.apply(this,arguments)};function vc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function mc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Ec(t,e){return function(r,n){e(r,n,t)}}function Sc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Dc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{h(n.next(f))}catch(y){a(y)}}function l(f){try{h(n.throw(f))}catch(y){a(y)}}function h(f){f.done?s(f.value):i(f.value).then(c,l)}h((n=n.apply(t,e||[])).next())})}function Oc(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(h){return function(f){return l([h,f])}}function l(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function xc(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ic(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function An(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zi(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Tc(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Zi(arguments[e]));return t}function Nc(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function pr(t){return this instanceof pr?(this.v=t,this):new pr(t)}function Pc(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(v){return new Promise(function(E,A){s.push([b,v,E,A])>1||c(b,v)})})}function c(b,v){try{l(n[b](v))}catch(E){y(s[0][3],E)}}function l(b){b.value instanceof pr?Promise.resolve(b.value.v).then(h,f):y(s[0][2],b)}function h(b){c("next",b)}function f(b){c("throw",b)}function y(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ac(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:pr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function Rc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof An=="function"?An(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,l){a=t[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},a)}}function Cc(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Fc(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Lc(t){return t&&t.__esModule?t:{default:t}}function Uc(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function $c(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Mc=Object.freeze({__proto__:null,__extends:wc,get __assign(){return Pn},__rest:vc,__decorate:mc,__param:Ec,__metadata:Sc,__awaiter:Dc,__generator:Oc,__createBinding:xc,__exportStar:Ic,__values:An,__read:Zi,__spread:Tc,__spreadArrays:Nc,__await:pr,__asyncGenerator:Pc,__asyncDelegator:Ac,__asyncValues:Rc,__makeTemplateObject:Cc,__importStar:Fc,__importDefault:Lc,__classPrivateFieldGet:Uc,__classPrivateFieldSet:$c}),Qi=qt(Mc),gr={};Object.defineProperty(gr,"__esModule",{value:!0});function jc(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}gr.safeJsonParse=jc;function Bc(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}gr.safeJsonStringify=Bc;var _r={exports:{}},es;function zc(){return es||(es=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof et<"u"&&et.localStorage?_r.exports=et.localStorage:typeof window<"u"&&window.localStorage?_r.exports=window.localStorage:_r.exports=new e}()),_r.exports}var Rn={},yr={},ts;function qc(){if(ts)return yr;ts=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.IKeyValueStorage=void 0;class t{}return yr.IKeyValueStorage=t,yr}var br={},rs;function Kc(){if(rs)return br;rs=1,Object.defineProperty(br,"__esModule",{value:!0}),br.parseEntry=void 0;const t=gr;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return br.parseEntry=e,br}var ns;function Hc(){return ns||(ns=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qi;e.__exportStar(qc(),t),e.__exportStar(Kc(),t)}(Rn)),Rn}Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.KeyValueStorage=void 0;const ir=Qi,is=gr,Vc=ir.__importDefault(zc()),Gc=Hc();class ss{constructor(){this.localStorage=Vc.default}getKeys(){return ir.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return ir.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Gc.parseEntry)})}getItem(e){return ir.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return is.safeJsonParse(r)})}setItem(e,r){return ir.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,is.safeJsonStringify(r))})}removeItem(e){return ir.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Yr.KeyValueStorage=ss;var Wc=Yr.default=ss,wr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Cn=function(t,e){return Cn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Cn(t,e)};function Yc(t,e){Cn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fn=function(){return Fn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fn.apply(this,arguments)};function kc(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Xc(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Jc(t,e){return function(r,n){e(r,n,t)}}function Zc(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Qc(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{h(n.next(f))}catch(y){a(y)}}function l(f){try{h(n.throw(f))}catch(y){a(y)}}function h(f){f.done?s(f.value):i(f.value).then(c,l)}h((n=n.apply(t,e||[])).next())})}function eu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(h){return function(f){return l([h,f])}}function l(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function tu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function ru(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ln(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function os(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function nu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(os(arguments[e]));return t}function iu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function vr(t){return this instanceof vr?(this.v=t,this):new vr(t)}function su(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(v){return new Promise(function(E,A){s.push([b,v,E,A])>1||c(b,v)})})}function c(b,v){try{l(n[b](v))}catch(E){y(s[0][3],E)}}function l(b){b.value instanceof vr?Promise.resolve(b.value.v).then(h,f):y(s[0][2],b)}function h(b){c("next",b)}function f(b){c("throw",b)}function y(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ou(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:vr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function au(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ln=="function"?Ln(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,l){a=t[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},a)}}function cu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function uu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function hu(t){return t&&t.__esModule?t:{default:t}}function lu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function fu(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var du=Object.freeze({__proto__:null,__extends:Yc,get __assign(){return Fn},__rest:kc,__decorate:Xc,__param:Jc,__metadata:Zc,__awaiter:Qc,__generator:eu,__createBinding:tu,__exportStar:ru,__values:Ln,__read:os,__spread:nu,__spreadArrays:iu,__await:vr,__asyncGenerator:su,__asyncDelegator:ou,__asyncValues:au,__makeTemplateObject:cu,__importStar:uu,__importDefault:hu,__classPrivateFieldGet:lu,__classPrivateFieldSet:fu}),kr=qt(du),mr={},Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Un=function(t,e){return Un=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Un(t,e)};function pu(t,e){Un(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var $n=function(){return $n=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},$n.apply(this,arguments)};function gu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function _u(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function yu(t,e){return function(r,n){e(r,n,t)}}function bu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function wu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{h(n.next(f))}catch(y){a(y)}}function l(f){try{h(n.throw(f))}catch(y){a(y)}}function h(f){f.done?s(f.value):i(f.value).then(c,l)}h((n=n.apply(t,e||[])).next())})}function vu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(h){return function(f){return l([h,f])}}function l(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function mu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Eu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Mn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function as(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Su(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(as(arguments[e]));return t}function Du(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function Er(t){return this instanceof Er?(this.v=t,this):new Er(t)}function Ou(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(v){return new Promise(function(E,A){s.push([b,v,E,A])>1||c(b,v)})})}function c(b,v){try{l(n[b](v))}catch(E){y(s[0][3],E)}}function l(b){b.value instanceof Er?Promise.resolve(b.value.v).then(h,f):y(s[0][2],b)}function h(b){c("next",b)}function f(b){c("throw",b)}function y(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function xu(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:Er(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function Iu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Mn=="function"?Mn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,l){a=t[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},a)}}function Tu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Nu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Pu(t){return t&&t.__esModule?t:{default:t}}function Au(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ru(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Cu=Object.freeze({__proto__:null,__extends:pu,get __assign(){return $n},__rest:gu,__decorate:_u,__param:yu,__metadata:bu,__awaiter:wu,__generator:vu,__createBinding:mu,__exportStar:Eu,__values:Mn,__read:as,__spread:Su,__spreadArrays:Du,__await:Er,__asyncGenerator:Ou,__asyncDelegator:xu,__asyncValues:Iu,__makeTemplateObject:Tu,__importStar:Nu,__importDefault:Pu,__classPrivateFieldGet:Au,__classPrivateFieldSet:Ru}),Xr=qt(Cu),jn={},Sr={},cs;function Fu(){if(cs)return Sr;cs=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Sr.delay=t,Sr}var Kt={},Bn={},Ht={},us;function Lu(){return us||(us=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.ONE_THOUSAND=Ht.ONE_HUNDRED=void 0,Ht.ONE_HUNDRED=100,Ht.ONE_THOUSAND=1e3),Ht}var zn={},hs;function Uu(){return hs||(hs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(zn)),zn}var ls;function fs(){return ls||(ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Xr;e.__exportStar(Lu(),t),e.__exportStar(Uu(),t)}(Bn)),Bn}var ds;function $u(){if(ds)return Kt;ds=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.fromMiliseconds=Kt.toMiliseconds=void 0;const t=fs();function e(n){return n*t.ONE_THOUSAND}Kt.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Kt.fromMiliseconds=r,Kt}var ps;function Mu(){return ps||(ps=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Xr;e.__exportStar(Fu(),t),e.__exportStar($u(),t)}(jn)),jn}var sr={},gs;function ju(){if(gs)return sr;gs=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return sr.Watch=t,sr.default=t,sr}var qn={},Dr={},_s;function Bu(){if(_s)return Dr;_s=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.IWatch=void 0;class t{}return Dr.IWatch=t,Dr}var ys;function zu(){return ys||(ys=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Xr.__exportStar(Bu(),t)}(qn)),qn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Xr;e.__exportStar(Mu(),t),e.__exportStar(ju(),t),e.__exportStar(zu(),t),e.__exportStar(fs(),t)})(Z);var Kn={},Or={};class Vt{}var qu=Object.freeze({__proto__:null,IEvents:Vt}),Ku=qt(qu),bs;function Hu(){if(bs)return Or;bs=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.IHeartBeat=void 0;const t=Ku;class e extends t.IEvents{constructor(n){super()}}return Or.IHeartBeat=e,Or}var ws;function vs(){return ws||(ws=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),kr.__exportStar(Hu(),t)}(Kn)),Kn}var Hn={},Gt={},ms;function Vu(){if(ms)return Gt;ms=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.HEARTBEAT_EVENTS=Gt.HEARTBEAT_INTERVAL=void 0;const t=Z;return Gt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Gt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Gt}var Es;function Ss(){return Es||(Es=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),kr.__exportStar(Vu(),t)}(Hn)),Hn}var Ds;function Gu(){if(Ds)return mr;Ds=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.HeartBeat=void 0;const t=kr,e=lt.exports,r=Z,n=vs(),i=Ss();class s extends n.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=c?.interval||i.HEARTBEAT_INTERVAL}static init(c){return t.__awaiter(this,void 0,void 0,function*(){const l=new s(c);return yield l.init(),l})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,l){this.events.on(c,l)}once(c,l){this.events.once(c,l)}off(c,l){this.events.off(c,l)}removeListener(c,l){this.events.removeListener(c,l)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return mr.HeartBeat=s,mr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=kr;e.__exportStar(Gu(),t),e.__exportStar(vs(),t),e.__exportStar(Ss(),t)})(wr);var Oe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Vn=function(t,e){return Vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Vn(t,e)};function Wu(t,e){Vn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Gn=function(){return Gn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Gn.apply(this,arguments)};function Yu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function ku(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Xu(t,e){return function(r,n){e(r,n,t)}}function Ju(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Zu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{h(n.next(f))}catch(y){a(y)}}function l(f){try{h(n.throw(f))}catch(y){a(y)}}function h(f){f.done?s(f.value):i(f.value).then(c,l)}h((n=n.apply(t,e||[])).next())})}function Qu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(h){return function(f){return l([h,f])}}function l(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function eh(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function th(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Wn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Os(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function rh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Os(arguments[e]));return t}function nh(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function xr(t){return this instanceof xr?(this.v=t,this):new xr(t)}function ih(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(v){return new Promise(function(E,A){s.push([b,v,E,A])>1||c(b,v)})})}function c(b,v){try{l(n[b](v))}catch(E){y(s[0][3],E)}}function l(b){b.value instanceof xr?Promise.resolve(b.value.v).then(h,f):y(s[0][2],b)}function h(b){c("next",b)}function f(b){c("throw",b)}function y(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function sh(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:xr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function oh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wn=="function"?Wn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,l){a=t[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},a)}}function ah(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ch(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function uh(t){return t&&t.__esModule?t:{default:t}}function hh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function lh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var fh=Object.freeze({__proto__:null,__extends:Wu,get __assign(){return Gn},__rest:Yu,__decorate:ku,__param:Xu,__metadata:Ju,__awaiter:Zu,__generator:Qu,__createBinding:eh,__exportStar:th,__values:Wn,__read:Os,__spread:rh,__spreadArrays:nh,__await:xr,__asyncGenerator:ih,__asyncDelegator:sh,__asyncValues:oh,__makeTemplateObject:ah,__importStar:ch,__importDefault:uh,__classPrivateFieldGet:hh,__classPrivateFieldSet:lh}),dh=qt(fh),Wt={},xs;function Is(){return xs||(xs=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.PINO_CUSTOM_CONTEXT_KEY=Wt.PINO_LOGGER_DEFAULTS=void 0,Wt.PINO_LOGGER_DEFAULTS={level:"info"},Wt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Wt}var ot={},Ts;function ph(){if(Ts)return ot;Ts=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const t=Is();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function r(c,l=t.PINO_CUSTOM_CONTEXT_KEY){return c[l]||""}ot.getBrowserLoggerContext=r;function n(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]=l,c}ot.setBrowserLoggerContext=n;function i(c,l=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof c.bindings>"u"?h=r(c,l):h=c.bindings().context||"",h}ot.getLoggerContext=i;function s(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const f=i(c,h);return f.trim()?`${f}/${l}`:l}ot.formatChildLoggerContext=s;function a(c,l,h=t.PINO_CUSTOM_CONTEXT_KEY){const f=s(c,l,h),y=c.child({context:f});return n(y,f,h)}return ot.generateChildLogger=a,ot}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=dh,r=e.__importDefault(Kr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Is(),t),e.__exportStar(ph(),t)})(Oe);class gh extends Vt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class _h extends Vt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class yh{constructor(e,r){this.logger=e,this.core=r}}class bh extends Vt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class wh extends Vt{constructor(e){super()}}class vh{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class mh extends Vt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Eh extends Vt{constructor(e,r){super(),this.core=e,this.logger=r}}class Sh{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class Dh{constructor(e){this.client=e}}const Oh=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),xh=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function Ns(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return xh(t)}catch{return t}}function Yn(t){return typeof t=="string"?t:Oh(t)||""}var kn={},or={},Jr={},Zr={};Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.BrowserRandomSource=void 0;const Ps=65536;class Ih{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=Ps)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Ps)));return r}}Zr.BrowserRandomSource=Ih;function Th(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Qr={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function Nh(t){for(var e=0;e<t.length;e++)t[e]=0;return t}pt.wipe=Nh;var Ph={},Ah=Object.freeze({__proto__:null,default:Ph}),Rh=qt(Ah);Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.NodeRandomSource=void 0;const Ch=pt;class Fh{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Th<"u"){const e=Rh;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Ch.wipe)(r),n}}Qr.NodeRandomSource=Fh,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.SystemRandomSource=void 0;const Lh=Zr,Uh=Qr;class $h{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Lh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Uh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}Jr.SystemRandomSource=$h;var te={},As={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,l){var h=c>>>16&65535,f=c&65535,y=l>>>16&65535,b=l&65535;return f*b+(h*b+f*y<<16>>>0)|0}t.mul=Math.imul||e;function r(c,l){return c+l|0}t.add=r;function n(c,l){return c-l|0}t.sub=n;function i(c,l){return c<<l|c>>>32-l}t.rotl=i;function s(c,l){return c<<32-l|c>>>l}t.rotr=s;function a(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(As),Object.defineProperty(te,"__esModule",{value:!0});var Rs=As;function Mh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}te.readInt16BE=Mh;function jh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}te.readUint16BE=jh;function Bh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}te.readInt16LE=Bh;function zh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}te.readUint16LE=zh;function Cs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}te.writeUint16BE=Cs,te.writeInt16BE=Cs;function Fs(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}te.writeUint16LE=Fs,te.writeInt16LE=Fs;function Xn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}te.readInt32BE=Xn;function Jn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}te.readUint32BE=Jn;function Zn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}te.readInt32LE=Zn;function Qn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}te.readUint32LE=Qn;function en(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}te.writeUint32BE=en,te.writeInt32BE=en;function tn(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}te.writeUint32LE=tn,te.writeInt32LE=tn;function qh(t,e){e===void 0&&(e=0);var r=Xn(t,e),n=Xn(t,e+4);return r*4294967296+n-(n>>31)*4294967296}te.readInt64BE=qh;function Kh(t,e){e===void 0&&(e=0);var r=Jn(t,e),n=Jn(t,e+4);return r*4294967296+n}te.readUint64BE=Kh;function Hh(t,e){e===void 0&&(e=0);var r=Zn(t,e),n=Zn(t,e+4);return n*4294967296+r-(r>>31)*4294967296}te.readInt64LE=Hh;function Vh(t,e){e===void 0&&(e=0);var r=Qn(t,e),n=Qn(t,e+4);return n*4294967296+r}te.readUint64LE=Vh;function Ls(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),en(t/4294967296>>>0,e,r),en(t>>>0,e,r+4),e}te.writeUint64BE=Ls,te.writeInt64BE=Ls;function Us(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),tn(t>>>0,e,r),tn(t/4294967296>>>0,e,r+4),e}te.writeUint64LE=Us,te.writeInt64LE=Us;function Gh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}te.readUintBE=Gh;function Wh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}te.readUintLE=Wh;function Yh(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Rs.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}te.writeUintBE=Yh;function kh(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Rs.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}te.writeUintLE=kh;function Xh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}te.readFloat32BE=Xh;function Jh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}te.readFloat32LE=Jh;function Zh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}te.readFloat64BE=Zh;function Qh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}te.readFloat64LE=Qh;function el(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}te.writeFloat32BE=el;function tl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}te.writeFloat32LE=tl;function rl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}te.writeFloat64BE=rl;function nl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}te.writeFloat64LE=nl,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=Jr,r=te,n=pt;t.defaultRandomSource=new e.SystemRandomSource;function i(h,f=t.defaultRandomSource){return f.randomBytes(h)}t.randomBytes=i;function s(h=t.defaultRandomSource){const f=i(4,h),y=(0,r.readUint32LE)(f);return(0,n.wipe)(f),y}t.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(h,f=a,y=t.defaultRandomSource){if(f.length<2)throw new Error("randomString charset is too short");if(f.length>256)throw new Error("randomString charset is too long");let b="";const v=f.length,E=256-256%v;for(;h>0;){const A=i(Math.ceil(h*256/E),y);for(let R=0;R<A.length&&h>0;R++){const j=A[R];j<E&&(b+=f.charAt(j%v),h--)}(0,n.wipe)(A)}return b}t.randomString=c;function l(h,f=a,y=t.defaultRandomSource){const b=Math.ceil(h/(Math.log(f.length)/Math.LN2));return c(b,f,y)}t.randomStringForEntropy=l}(or);var $s={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=pt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var f=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=l[f++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(f=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,l,f,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[f++],h--;return this},c.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,f=this._bufferLength,y=h/536870912|0,b=h<<3,v=h%128<112?128:256;this._buffer[f]=128;for(var E=f+1;E<v-8;E++)this._buffer[E]=0;e.writeUint32BE(y,this._buffer,v-8),e.writeUint32BE(b,this._buffer,v-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(var E=0;E<this.digestLength/8;E++)e.writeUint32BE(this._stateHi[E],l,E*8),e.writeUint32BE(this._stateLo[E],l,E*8+4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._stateHi.set(l.stateHi),this._stateLo.set(l.stateLo),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.stateHi),r.wipe(l.stateLo),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,l,h,f,y,b,v){for(var E=h[0],A=h[1],R=h[2],j=h[3],S=h[4],x=h[5],g=h[6],m=h[7],w=f[0],o=f[1],p=f[2],L=f[3],B=f[4],k=f[5],X=f[6],J=f[7],P,N,W,M,F,U,$,z;v>=128;){for(var ne=0;ne<16;ne++){var q=8*ne+b;c[ne]=e.readUint32BE(y,q),l[ne]=e.readUint32BE(y,q+4)}for(var ne=0;ne<80;ne++){var Q=E,Y=A,ae=R,T=j,I=S,D=x,u=g,_=m,K=w,V=o,le=p,ye=L,de=B,ve=k,Le=X,Ae=J;if(P=m,N=J,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=(S>>>14|B<<32-14)^(S>>>18|B<<32-18)^(B>>>41-32|S<<32-(41-32)),N=(B>>>14|S<<32-14)^(B>>>18|S<<32-18)^(S>>>41-32|B<<32-(41-32)),F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,P=S&x^~S&g,N=B&k^~B&X,F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,P=i[ne*2],N=i[ne*2+1],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,P=c[ne%16],N=l[ne%16],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,W=$&65535|z<<16,M=F&65535|U<<16,P=W,N=M,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=(E>>>28|w<<32-28)^(w>>>34-32|E<<32-(34-32))^(w>>>39-32|E<<32-(39-32)),N=(w>>>28|E<<32-28)^(E>>>34-32|w<<32-(34-32))^(E>>>39-32|w<<32-(39-32)),F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,P=E&A^E&R^A&R,N=w&o^w&p^o&p,F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,_=$&65535|z<<16,Ae=F&65535|U<<16,P=T,N=ye,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=W,N=M,F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,T=$&65535|z<<16,ye=F&65535|U<<16,A=Q,R=Y,j=ae,S=T,x=I,g=D,m=u,E=_,o=K,p=V,L=le,B=ye,k=de,X=ve,J=Le,w=Ae,ne%16===15)for(var q=0;q<16;q++)P=c[q],N=l[q],F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=c[(q+9)%16],N=l[(q+9)%16],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,W=c[(q+1)%16],M=l[(q+1)%16],P=(W>>>1|M<<32-1)^(W>>>8|M<<32-8)^W>>>7,N=(M>>>1|W<<32-1)^(M>>>8|W<<32-8)^(M>>>7|W<<32-7),F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,W=c[(q+14)%16],M=l[(q+14)%16],P=(W>>>19|M<<32-19)^(M>>>61-32|W<<32-(61-32))^W>>>6,N=(M>>>19|W<<32-19)^(W>>>61-32|M<<32-(61-32))^(M>>>6|W<<32-6),F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,c[q]=$&65535|z<<16,l[q]=F&65535|U<<16}P=E,N=w,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[0],N=f[0],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[0]=E=$&65535|z<<16,f[0]=w=F&65535|U<<16,P=A,N=o,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[1],N=f[1],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[1]=A=$&65535|z<<16,f[1]=o=F&65535|U<<16,P=R,N=p,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[2],N=f[2],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[2]=R=$&65535|z<<16,f[2]=p=F&65535|U<<16,P=j,N=L,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[3],N=f[3],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[3]=j=$&65535|z<<16,f[3]=L=F&65535|U<<16,P=S,N=B,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[4],N=f[4],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[4]=S=$&65535|z<<16,f[4]=B=F&65535|U<<16,P=x,N=k,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[5],N=f[5],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[5]=x=$&65535|z<<16,f[5]=k=F&65535|U<<16,P=g,N=X,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[6],N=f[6],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[6]=g=$&65535|z<<16,f[6]=X=F&65535|U<<16,P=m,N=J,F=N&65535,U=N>>>16,$=P&65535,z=P>>>16,P=h[7],N=f[7],F+=N&65535,U+=N>>>16,$+=P&65535,z+=P>>>16,U+=F>>>16,$+=U>>>16,z+=$>>>16,h[7]=m=$&65535|z<<16,f[7]=J=F&65535|U<<16,b+=128,v-=128}return b}function a(c){var l=new n;l.update(c);var h=l.digest();return l.clean(),h}t.hash=a})($s),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=or,r=$s,n=pt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(T){const I=new Float64Array(16);if(T)for(let D=0;D<T.length;D++)I[D]=T[D];return I}const s=new Uint8Array(32);s[0]=9;const a=i(),c=i([1]),l=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(T,I){for(let D=0;D<16;D++)T[D]=I[D]|0}function E(T){let I=1;for(let D=0;D<16;D++){let u=T[D]+I+65535;I=Math.floor(u/65536),T[D]=u-I*65536}T[0]+=I-1+37*(I-1)}function A(T,I,D){const u=~(D-1);for(let _=0;_<16;_++){const K=u&(T[_]^I[_]);T[_]^=K,I[_]^=K}}function R(T,I){const D=i(),u=i();for(let _=0;_<16;_++)u[_]=I[_];E(u),E(u),E(u);for(let _=0;_<2;_++){D[0]=u[0]-65517;for(let V=1;V<15;V++)D[V]=u[V]-65535-(D[V-1]>>16&1),D[V-1]&=65535;D[15]=u[15]-32767-(D[14]>>16&1);const K=D[15]>>16&1;D[14]&=65535,A(u,D,1-K)}for(let _=0;_<16;_++)T[2*_]=u[_]&255,T[2*_+1]=u[_]>>8}function j(T,I){let D=0;for(let u=0;u<32;u++)D|=T[u]^I[u];return(1&D-1>>>8)-1}function S(T,I){const D=new Uint8Array(32),u=new Uint8Array(32);return R(D,T),R(u,I),j(D,u)}function x(T){const I=new Uint8Array(32);return R(I,T),I[0]&1}function g(T,I){for(let D=0;D<16;D++)T[D]=I[2*D]+(I[2*D+1]<<8);T[15]&=32767}function m(T,I,D){for(let u=0;u<16;u++)T[u]=I[u]+D[u]}function w(T,I,D){for(let u=0;u<16;u++)T[u]=I[u]-D[u]}function o(T,I,D){let u,_,K=0,V=0,le=0,ye=0,de=0,ve=0,Le=0,Ae=0,_e=0,pe=0,fe=0,ue=0,ce=0,oe=0,se=0,ee=0,he=0,ge=0,re=0,be=0,we=0,Ee=0,Se=0,me=0,Et=0,Nt=0,Mt=0,gt=0,Jt=0,Br=0,vn=0,$e=D[0],Re=D[1],Me=D[2],je=D[3],Be=D[4],Ce=D[5],Ge=D[6],We=D[7],Ye=D[8],ke=D[9],Xe=D[10],qe=D[11],ze=D[12],Ne=D[13],Je=D[14],Ze=D[15];u=I[0],K+=u*$e,V+=u*Re,le+=u*Me,ye+=u*je,de+=u*Be,ve+=u*Ce,Le+=u*Ge,Ae+=u*We,_e+=u*Ye,pe+=u*ke,fe+=u*Xe,ue+=u*qe,ce+=u*ze,oe+=u*Ne,se+=u*Je,ee+=u*Ze,u=I[1],V+=u*$e,le+=u*Re,ye+=u*Me,de+=u*je,ve+=u*Be,Le+=u*Ce,Ae+=u*Ge,_e+=u*We,pe+=u*Ye,fe+=u*ke,ue+=u*Xe,ce+=u*qe,oe+=u*ze,se+=u*Ne,ee+=u*Je,he+=u*Ze,u=I[2],le+=u*$e,ye+=u*Re,de+=u*Me,ve+=u*je,Le+=u*Be,Ae+=u*Ce,_e+=u*Ge,pe+=u*We,fe+=u*Ye,ue+=u*ke,ce+=u*Xe,oe+=u*qe,se+=u*ze,ee+=u*Ne,he+=u*Je,ge+=u*Ze,u=I[3],ye+=u*$e,de+=u*Re,ve+=u*Me,Le+=u*je,Ae+=u*Be,_e+=u*Ce,pe+=u*Ge,fe+=u*We,ue+=u*Ye,ce+=u*ke,oe+=u*Xe,se+=u*qe,ee+=u*ze,he+=u*Ne,ge+=u*Je,re+=u*Ze,u=I[4],de+=u*$e,ve+=u*Re,Le+=u*Me,Ae+=u*je,_e+=u*Be,pe+=u*Ce,fe+=u*Ge,ue+=u*We,ce+=u*Ye,oe+=u*ke,se+=u*Xe,ee+=u*qe,he+=u*ze,ge+=u*Ne,re+=u*Je,be+=u*Ze,u=I[5],ve+=u*$e,Le+=u*Re,Ae+=u*Me,_e+=u*je,pe+=u*Be,fe+=u*Ce,ue+=u*Ge,ce+=u*We,oe+=u*Ye,se+=u*ke,ee+=u*Xe,he+=u*qe,ge+=u*ze,re+=u*Ne,be+=u*Je,we+=u*Ze,u=I[6],Le+=u*$e,Ae+=u*Re,_e+=u*Me,pe+=u*je,fe+=u*Be,ue+=u*Ce,ce+=u*Ge,oe+=u*We,se+=u*Ye,ee+=u*ke,he+=u*Xe,ge+=u*qe,re+=u*ze,be+=u*Ne,we+=u*Je,Ee+=u*Ze,u=I[7],Ae+=u*$e,_e+=u*Re,pe+=u*Me,fe+=u*je,ue+=u*Be,ce+=u*Ce,oe+=u*Ge,se+=u*We,ee+=u*Ye,he+=u*ke,ge+=u*Xe,re+=u*qe,be+=u*ze,we+=u*Ne,Ee+=u*Je,Se+=u*Ze,u=I[8],_e+=u*$e,pe+=u*Re,fe+=u*Me,ue+=u*je,ce+=u*Be,oe+=u*Ce,se+=u*Ge,ee+=u*We,he+=u*Ye,ge+=u*ke,re+=u*Xe,be+=u*qe,we+=u*ze,Ee+=u*Ne,Se+=u*Je,me+=u*Ze,u=I[9],pe+=u*$e,fe+=u*Re,ue+=u*Me,ce+=u*je,oe+=u*Be,se+=u*Ce,ee+=u*Ge,he+=u*We,ge+=u*Ye,re+=u*ke,be+=u*Xe,we+=u*qe,Ee+=u*ze,Se+=u*Ne,me+=u*Je,Et+=u*Ze,u=I[10],fe+=u*$e,ue+=u*Re,ce+=u*Me,oe+=u*je,se+=u*Be,ee+=u*Ce,he+=u*Ge,ge+=u*We,re+=u*Ye,be+=u*ke,we+=u*Xe,Ee+=u*qe,Se+=u*ze,me+=u*Ne,Et+=u*Je,Nt+=u*Ze,u=I[11],ue+=u*$e,ce+=u*Re,oe+=u*Me,se+=u*je,ee+=u*Be,he+=u*Ce,ge+=u*Ge,re+=u*We,be+=u*Ye,we+=u*ke,Ee+=u*Xe,Se+=u*qe,me+=u*ze,Et+=u*Ne,Nt+=u*Je,Mt+=u*Ze,u=I[12],ce+=u*$e,oe+=u*Re,se+=u*Me,ee+=u*je,he+=u*Be,ge+=u*Ce,re+=u*Ge,be+=u*We,we+=u*Ye,Ee+=u*ke,Se+=u*Xe,me+=u*qe,Et+=u*ze,Nt+=u*Ne,Mt+=u*Je,gt+=u*Ze,u=I[13],oe+=u*$e,se+=u*Re,ee+=u*Me,he+=u*je,ge+=u*Be,re+=u*Ce,be+=u*Ge,we+=u*We,Ee+=u*Ye,Se+=u*ke,me+=u*Xe,Et+=u*qe,Nt+=u*ze,Mt+=u*Ne,gt+=u*Je,Jt+=u*Ze,u=I[14],se+=u*$e,ee+=u*Re,he+=u*Me,ge+=u*je,re+=u*Be,be+=u*Ce,we+=u*Ge,Ee+=u*We,Se+=u*Ye,me+=u*ke,Et+=u*Xe,Nt+=u*qe,Mt+=u*ze,gt+=u*Ne,Jt+=u*Je,Br+=u*Ze,u=I[15],ee+=u*$e,he+=u*Re,ge+=u*Me,re+=u*je,be+=u*Be,we+=u*Ce,Ee+=u*Ge,Se+=u*We,me+=u*Ye,Et+=u*ke,Nt+=u*Xe,Mt+=u*qe,gt+=u*ze,Jt+=u*Ne,Br+=u*Je,vn+=u*Ze,K+=38*he,V+=38*ge,le+=38*re,ye+=38*be,de+=38*we,ve+=38*Ee,Le+=38*Se,Ae+=38*me,_e+=38*Et,pe+=38*Nt,fe+=38*Mt,ue+=38*gt,ce+=38*Jt,oe+=38*Br,se+=38*vn,_=1,u=K+_+65535,_=Math.floor(u/65536),K=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Le+_+65535,_=Math.floor(u/65536),Le=u-_*65536,u=Ae+_+65535,_=Math.floor(u/65536),Ae=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=fe+_+65535,_=Math.floor(u/65536),fe=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,K+=_-1+37*(_-1),_=1,u=K+_+65535,_=Math.floor(u/65536),K=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Le+_+65535,_=Math.floor(u/65536),Le=u-_*65536,u=Ae+_+65535,_=Math.floor(u/65536),Ae=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=fe+_+65535,_=Math.floor(u/65536),fe=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,K+=_-1+37*(_-1),T[0]=K,T[1]=V,T[2]=le,T[3]=ye,T[4]=de,T[5]=ve,T[6]=Le,T[7]=Ae,T[8]=_e,T[9]=pe,T[10]=fe,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=se,T[15]=ee}function p(T,I){o(T,I,I)}function L(T,I){const D=i();let u;for(u=0;u<16;u++)D[u]=I[u];for(u=253;u>=0;u--)p(D,D),u!==2&&u!==4&&o(D,D,I);for(u=0;u<16;u++)T[u]=D[u]}function B(T,I){const D=i();let u;for(u=0;u<16;u++)D[u]=I[u];for(u=250;u>=0;u--)p(D,D),u!==1&&o(D,D,I);for(u=0;u<16;u++)T[u]=D[u]}function k(T,I){const D=i(),u=i(),_=i(),K=i(),V=i(),le=i(),ye=i(),de=i(),ve=i();w(D,T[1],T[0]),w(ve,I[1],I[0]),o(D,D,ve),m(u,T[0],T[1]),m(ve,I[0],I[1]),o(u,u,ve),o(_,T[3],I[3]),o(_,_,h),o(K,T[2],I[2]),m(K,K,K),w(V,u,D),w(le,K,_),m(ye,K,_),m(de,u,D),o(T[0],V,le),o(T[1],de,ye),o(T[2],ye,le),o(T[3],V,de)}function X(T,I,D){for(let u=0;u<4;u++)A(T[u],I[u],D)}function J(T,I){const D=i(),u=i(),_=i();L(_,I[2]),o(D,I[0],_),o(u,I[1],_),R(T,u),T[31]^=x(D)<<7}function P(T,I,D){v(T[0],a),v(T[1],c),v(T[2],c),v(T[3],a);for(let u=255;u>=0;--u){const _=D[u/8|0]>>(u&7)&1;X(T,I,_),k(I,T),k(T,T),X(T,I,_)}}function N(T,I){const D=[i(),i(),i(),i()];v(D[0],f),v(D[1],y),v(D[2],c),o(D[3],f,y),P(T,D,I)}function W(T){if(T.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const I=(0,r.hash)(T);I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(32),u=[i(),i(),i(),i()];N(u,I),J(D,u);const _=new Uint8Array(64);return _.set(T),_.set(D,32),{publicKey:D,secretKey:_}}t.generateKeyPairFromSeed=W;function M(T){const I=(0,e.randomBytes)(32,T),D=W(I);return(0,n.wipe)(I),D}t.generateKeyPair=M;function F(T){if(T.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}t.extractPublicKeyFromSecretKey=F;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function $(T,I){let D,u,_,K;for(u=63;u>=32;--u){for(D=0,_=u-32,K=u-12;_<K;++_)I[_]+=D-16*I[u]*U[_-(u-32)],D=Math.floor((I[_]+128)/256),I[_]-=D*256;I[_]+=D,I[u]=0}for(D=0,_=0;_<32;_++)I[_]+=D-(I[31]>>4)*U[_],D=I[_]>>8,I[_]&=255;for(_=0;_<32;_++)I[_]-=D*U[_];for(u=0;u<32;u++)I[u+1]+=I[u]>>8,T[u]=I[u]&255}function z(T){const I=new Float64Array(64);for(let D=0;D<64;D++)I[D]=T[D];for(let D=0;D<64;D++)T[D]=0;$(T,I)}function ne(T,I){const D=new Float64Array(64),u=[i(),i(),i(),i()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const K=new Uint8Array(64);K.set(_.subarray(32),32);const V=new r.SHA512;V.update(K.subarray(32)),V.update(I);const le=V.digest();V.clean(),z(le),N(u,le),J(K,u),V.reset(),V.update(K.subarray(0,32)),V.update(T.subarray(32)),V.update(I);const ye=V.digest();z(ye);for(let de=0;de<32;de++)D[de]=le[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)D[de+ve]+=ye[de]*_[ve];return $(K.subarray(32),D),K}t.sign=ne;function q(T,I){const D=i(),u=i(),_=i(),K=i(),V=i(),le=i(),ye=i();return v(T[2],c),g(T[1],I),p(_,T[1]),o(K,_,l),w(_,_,T[2]),m(K,T[2],K),p(V,K),p(le,V),o(ye,le,V),o(D,ye,_),o(D,D,K),B(D,D),o(D,D,_),o(D,D,K),o(D,D,K),o(T[0],D,K),p(u,T[0]),o(u,u,K),S(u,_)&&o(T[0],T[0],b),p(u,T[0]),o(u,u,K),S(u,_)?-1:(x(T[0])===I[31]>>7&&w(T[0],a,T[0]),o(T[3],T[0],T[1]),0)}function Q(T,I,D){const u=new Uint8Array(32),_=[i(),i(),i(),i()],K=[i(),i(),i(),i()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(q(K,T))return!1;const V=new r.SHA512;V.update(D.subarray(0,32)),V.update(T),V.update(I);const le=V.digest();return z(le),P(_,K,le),N(K,D.subarray(32)),k(_,K),J(u,_),!j(D,u)}t.verify=Q;function Y(T){let I=[i(),i(),i(),i()];if(q(I,T))throw new Error("Ed25519: invalid public key");let D=i(),u=i(),_=I[1];m(D,c,_),w(u,c,_),L(u,u),o(D,D,u);let K=new Uint8Array(32);return R(K,D),K}t.convertPublicKeyToX25519=Y;function ae(T){const I=(0,r.hash)(T.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(I.subarray(0,32));return(0,n.wipe)(I),D}t.convertSecretKeyToX25519=ae}(kn);const il="EdDSA",sl="JWT",Ms=".",js="base64url",ol="utf8",al="utf8",cl=":",ul="did",hl="key",Bs="base58btc",ll="z",fl="K36",dl=32;function zs(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ei(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=zs(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function pl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var c=t.length,l=t.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function y(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var A=0,R=0,j=0,S=E.length;j!==S&&E[j]===0;)j++,A++;for(var x=(S-j)*f+1>>>0,g=new Uint8Array(x);j!==S;){for(var m=E[j],w=0,o=x-1;(m!==0||w<R)&&o!==-1;o--,w++)m+=256*g[o]>>>0,g[o]=m%c>>>0,m=m/c>>>0;if(m!==0)throw new Error("Non-zero carry");R=w,j++}for(var p=x-R;p!==x&&g[p]===0;)p++;for(var L=l.repeat(A);p<x;++p)L+=t.charAt(g[p]);return L}function b(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var A=0;if(E[A]!==" "){for(var R=0,j=0;E[A]===l;)R++,A++;for(var S=(E.length-A)*h+1>>>0,x=new Uint8Array(S);E[A];){var g=r[E.charCodeAt(A)];if(g===255)return;for(var m=0,w=S-1;(g!==0||m<j)&&w!==-1;w--,m++)g+=c*x[w]>>>0,x[w]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");j=m,A++}if(E[A]!==" "){for(var o=S-j;o!==S&&x[o]===0;)o++;for(var p=new Uint8Array(R+(S-o)),L=R;o!==S;)p[L++]=x[o++];return p}}}function v(E){var A=b(E);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:b,decode:v}}var gl=pl,_l=gl;const qs=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},yl=t=>new TextEncoder().encode(t),bl=t=>new TextDecoder().decode(t);class wl{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vl{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ks(this,e)}}class ml{constructor(e){this.decoders=e}or(e){return Ks(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ks=(t,e)=>new ml({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class El{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new wl(e,r,n),this.decoder=new vl(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const rn=({name:t,prefix:e,encode:r,decode:n})=>new El(t,e,r,n),Ir=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=_l(r,e);return rn({prefix:t,name:e,encode:n,decode:s=>qs(i(s))})},Sl=(t,e,r,n)=>{const i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,l=0,h=0;for(let f=0;f<s;++f){const y=i[t[f]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|y,c+=r,c>=8&&(c-=8,a[h++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return a},Dl=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",a=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],a+=8;a>r;)a-=r,s+=e[i&c>>a];if(a&&(s+=e[i&c<<r-a]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>rn({prefix:e,name:t,encode(i){return Dl(i,n,r)},decode(i){return Sl(i,n,r,t)}}),Ol=rn({prefix:"\0",name:"identity",encode:t=>bl(t),decode:t=>yl(t)});var xl=Object.freeze({__proto__:null,identity:Ol});const Il=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Tl=Object.freeze({__proto__:null,base2:Il});const Nl=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Pl=Object.freeze({__proto__:null,base8:Nl});const Al=Ir({prefix:"9",name:"base10",alphabet:"0123456789"});var Rl=Object.freeze({__proto__:null,base10:Al});const Cl=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Fl=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ll=Object.freeze({__proto__:null,base16:Cl,base16upper:Fl});const Ul=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$l=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ml=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jl=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Bl=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zl=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ql=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kl=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hl=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Vl=Object.freeze({__proto__:null,base32:Ul,base32upper:$l,base32pad:Ml,base32padupper:jl,base32hex:Bl,base32hexupper:zl,base32hexpad:ql,base32hexpadupper:Kl,base32z:Hl});const Gl=Ir({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Wl=Ir({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Yl=Object.freeze({__proto__:null,base36:Gl,base36upper:Wl});const kl=Ir({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Xl=Ir({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Jl=Object.freeze({__proto__:null,base58btc:kl,base58flickr:Xl});const Zl=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ql=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ef=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tf=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var rf=Object.freeze({__proto__:null,base64:Zl,base64pad:Ql,base64url:ef,base64urlpad:tf});const Hs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),nf=Hs.reduce((t,e,r)=>(t[r]=e,t),[]),sf=Hs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function of(t){return t.reduce((e,r)=>(e+=nf[r],e),"")}function af(t){const e=[];for(const r of t){const n=sf[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const cf=rn({prefix:"\u{1F680}",name:"base256emoji",encode:of,decode:af});var uf=Object.freeze({__proto__:null,base256emoji:cf}),hf=Gs,Vs=128,lf=127,ff=~lf,df=Math.pow(2,31);function Gs(t,e,r){e=e||[],r=r||0;for(var n=r;t>=df;)e[r++]=t&255|Vs,t/=128;for(;t&ff;)e[r++]=t&255|Vs,t>>>=7;return e[r]=t|0,Gs.bytes=r-n+1,e}var pf=ti,gf=128,Ws=127;function ti(t,n){var r=0,n=n||0,i=0,s=n,a,c=t.length;do{if(s>=c)throw ti.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&Ws)<<i:(a&Ws)*Math.pow(2,i),i+=7}while(a>=gf);return ti.bytes=s-n,r}var _f=Math.pow(2,7),yf=Math.pow(2,14),bf=Math.pow(2,21),wf=Math.pow(2,28),vf=Math.pow(2,35),mf=Math.pow(2,42),Ef=Math.pow(2,49),Sf=Math.pow(2,56),Df=Math.pow(2,63),Of=function(t){return t<_f?1:t<yf?2:t<bf?3:t<wf?4:t<vf?5:t<mf?6:t<Ef?7:t<Sf?8:t<Df?9:10},xf={encode:hf,decode:pf,encodingLength:Of},Ys=xf;const ks=(t,e,r=0)=>(Ys.encode(t,e,r),e),Xs=t=>Ys.encodingLength(t),ri=(t,e)=>{const r=e.byteLength,n=Xs(t),i=n+Xs(r),s=new Uint8Array(i+r);return ks(t,s,0),ks(r,s,n),s.set(e,i),new If(t,r,e,s)};class If{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Js=({name:t,code:e,encode:r})=>new Tf(t,e,r);class Tf{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ri(this.code,r):r.then(n=>ri(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Zs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Nf=Js({name:"sha2-256",code:18,encode:Zs("SHA-256")}),Pf=Js({name:"sha2-512",code:19,encode:Zs("SHA-512")});var Af=Object.freeze({__proto__:null,sha256:Nf,sha512:Pf});const Qs=0,Rf="identity",eo=qs;var Cf=Object.freeze({__proto__:null,identity:{code:Qs,name:Rf,encode:eo,digest:t=>ri(Qs,eo(t))}});new TextEncoder,new TextDecoder;const to={...xl,...Tl,...Pl,...Rl,...Ll,...Vl,...Yl,...Jl,...rf,...uf};({...Af,...Cf});function ro(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const no=ro("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ni=ro("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=zs(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),io={utf8:no,"utf-8":no,hex:to.base16,latin1:ni,ascii:ni,binary:ni,...to};function at(t,e="utf8"){const r=io[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function ft(t,e="utf8"){const r=io[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function nn(t){return at(ft(Yn(t),ol),js)}function so(t){const e=ft(fl,Bs),r=ll+at(ei([e,t]),Bs);return[ul,hl,r].join(cl)}function Ff(t){return at(t,js)}function Lf(t){return ft([nn(t.header),nn(t.payload)].join(Ms),al)}function Uf(t){return[nn(t.header),nn(t.payload),Ff(t.signature)].join(Ms)}function oo(t=or.randomBytes(dl)){return kn.generateKeyPairFromSeed(t)}async function $f(t,e,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:il,typ:sl},a=so(n.publicKey),c=i+r,l={iss:a,sub:t,aud:e,iat:i,exp:c},h=Lf({header:s,payload:l}),f=kn.sign(n.secretKey,h);return Uf({header:s,payload:l,signature:f})}var ii={},sn={};Object.defineProperty(sn,"__esModule",{value:!0});var it=te,si=pt,Mf=20;function jf(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],y=r[19]<<24|r[18]<<16|r[17]<<8|r[16],b=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],E=r[31]<<24|r[30]<<16|r[29]<<8|r[28],A=e[3]<<24|e[2]<<16|e[1]<<8|e[0],R=e[7]<<24|e[6]<<16|e[5]<<8|e[4],j=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],x=n,g=i,m=s,w=a,o=c,p=l,L=h,B=f,k=y,X=b,J=v,P=E,N=A,W=R,M=j,F=S,U=0;U<Mf;U+=2)x=x+o|0,N^=x,N=N>>>32-16|N<<16,k=k+N|0,o^=k,o=o>>>32-12|o<<12,g=g+p|0,W^=g,W=W>>>32-16|W<<16,X=X+W|0,p^=X,p=p>>>32-12|p<<12,m=m+L|0,M^=m,M=M>>>32-16|M<<16,J=J+M|0,L^=J,L=L>>>32-12|L<<12,w=w+B|0,F^=w,F=F>>>32-16|F<<16,P=P+F|0,B^=P,B=B>>>32-12|B<<12,m=m+L|0,M^=m,M=M>>>32-8|M<<8,J=J+M|0,L^=J,L=L>>>32-7|L<<7,w=w+B|0,F^=w,F=F>>>32-8|F<<8,P=P+F|0,B^=P,B=B>>>32-7|B<<7,g=g+p|0,W^=g,W=W>>>32-8|W<<8,X=X+W|0,p^=X,p=p>>>32-7|p<<7,x=x+o|0,N^=x,N=N>>>32-8|N<<8,k=k+N|0,o^=k,o=o>>>32-7|o<<7,x=x+p|0,F^=x,F=F>>>32-16|F<<16,J=J+F|0,p^=J,p=p>>>32-12|p<<12,g=g+L|0,N^=g,N=N>>>32-16|N<<16,P=P+N|0,L^=P,L=L>>>32-12|L<<12,m=m+B|0,W^=m,W=W>>>32-16|W<<16,k=k+W|0,B^=k,B=B>>>32-12|B<<12,w=w+o|0,M^=w,M=M>>>32-16|M<<16,X=X+M|0,o^=X,o=o>>>32-12|o<<12,m=m+B|0,W^=m,W=W>>>32-8|W<<8,k=k+W|0,B^=k,B=B>>>32-7|B<<7,w=w+o|0,M^=w,M=M>>>32-8|M<<8,X=X+M|0,o^=X,o=o>>>32-7|o<<7,g=g+L|0,N^=g,N=N>>>32-8|N<<8,P=P+N|0,L^=P,L=L>>>32-7|L<<7,x=x+p|0,F^=x,F=F>>>32-8|F<<8,J=J+F|0,p^=J,p=p>>>32-7|p<<7;it.writeUint32LE(x+n|0,t,0),it.writeUint32LE(g+i|0,t,4),it.writeUint32LE(m+s|0,t,8),it.writeUint32LE(w+a|0,t,12),it.writeUint32LE(o+c|0,t,16),it.writeUint32LE(p+l|0,t,20),it.writeUint32LE(L+h|0,t,24),it.writeUint32LE(B+f|0,t,28),it.writeUint32LE(k+y|0,t,32),it.writeUint32LE(X+b|0,t,36),it.writeUint32LE(J+v|0,t,40),it.writeUint32LE(P+E|0,t,44),it.writeUint32LE(N+A|0,t,48),it.writeUint32LE(W+R|0,t,52),it.writeUint32LE(M+j|0,t,56),it.writeUint32LE(F+S|0,t,60)}function ao(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-e.length,s.set(e,a)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,a=i}for(var c=new Uint8Array(64),l=0;l<r.length;l+=64){jf(c,s,t);for(var h=l;h<l+64&&h<r.length;h++)n[h]=r[h]^c[h-l];zf(s,0,a)}return si.wipe(c),i===0&&si.wipe(s),n}sn.streamXOR=ao;function Bf(t,e,r,n){return n===void 0&&(n=0),si.wipe(r),ao(t,e,r,r,n)}sn.stream=Bf;function zf(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var co={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});function qf(t,e,r){return~(t-1)&e|t-1&r}Lt.select=qf;function Kf(t,e){return(t|0)-(e|0)-1>>>31&1}Lt.lessOrEqual=Kf;function uo(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Lt.compare=uo;function Hf(t,e){return t.length===0||e.length===0?!1:uo(t,e)!==0}Lt.equal=Hf,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Lt,r=pt;t.DIGEST_LENGTH=16;var n=function(){function a(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=c[0]|c[1]<<8;this._r[0]=l&8191;var h=c[2]|c[3]<<8;this._r[1]=(l>>>13|h<<3)&8191;var f=c[4]|c[5]<<8;this._r[2]=(h>>>10|f<<6)&7939;var y=c[6]|c[7]<<8;this._r[3]=(f>>>7|y<<9)&8191;var b=c[8]|c[9]<<8;this._r[4]=(y>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var v=c[10]|c[11]<<8;this._r[6]=(b>>>14|v<<2)&8191;var E=c[12]|c[13]<<8;this._r[7]=(v>>>11|E<<5)&8065;var A=c[14]|c[15]<<8;this._r[8]=(E>>>8|A<<8)&8191,this._r[9]=A>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return a.prototype._blocks=function(c,l,h){for(var f=this._fin?0:2048,y=this._h[0],b=this._h[1],v=this._h[2],E=this._h[3],A=this._h[4],R=this._h[5],j=this._h[6],S=this._h[7],x=this._h[8],g=this._h[9],m=this._r[0],w=this._r[1],o=this._r[2],p=this._r[3],L=this._r[4],B=this._r[5],k=this._r[6],X=this._r[7],J=this._r[8],P=this._r[9];h>=16;){var N=c[l+0]|c[l+1]<<8;y+=N&8191;var W=c[l+2]|c[l+3]<<8;b+=(N>>>13|W<<3)&8191;var M=c[l+4]|c[l+5]<<8;v+=(W>>>10|M<<6)&8191;var F=c[l+6]|c[l+7]<<8;E+=(M>>>7|F<<9)&8191;var U=c[l+8]|c[l+9]<<8;A+=(F>>>4|U<<12)&8191,R+=U>>>1&8191;var $=c[l+10]|c[l+11]<<8;j+=(U>>>14|$<<2)&8191;var z=c[l+12]|c[l+13]<<8;S+=($>>>11|z<<5)&8191;var ne=c[l+14]|c[l+15]<<8;x+=(z>>>8|ne<<8)&8191,g+=ne>>>5|f;var q=0,Q=q;Q+=y*m,Q+=b*(5*P),Q+=v*(5*J),Q+=E*(5*X),Q+=A*(5*k),q=Q>>>13,Q&=8191,Q+=R*(5*B),Q+=j*(5*L),Q+=S*(5*p),Q+=x*(5*o),Q+=g*(5*w),q+=Q>>>13,Q&=8191;var Y=q;Y+=y*w,Y+=b*m,Y+=v*(5*P),Y+=E*(5*J),Y+=A*(5*X),q=Y>>>13,Y&=8191,Y+=R*(5*k),Y+=j*(5*B),Y+=S*(5*L),Y+=x*(5*p),Y+=g*(5*o),q+=Y>>>13,Y&=8191;var ae=q;ae+=y*o,ae+=b*w,ae+=v*m,ae+=E*(5*P),ae+=A*(5*J),q=ae>>>13,ae&=8191,ae+=R*(5*X),ae+=j*(5*k),ae+=S*(5*B),ae+=x*(5*L),ae+=g*(5*p),q+=ae>>>13,ae&=8191;var T=q;T+=y*p,T+=b*o,T+=v*w,T+=E*m,T+=A*(5*P),q=T>>>13,T&=8191,T+=R*(5*J),T+=j*(5*X),T+=S*(5*k),T+=x*(5*B),T+=g*(5*L),q+=T>>>13,T&=8191;var I=q;I+=y*L,I+=b*p,I+=v*o,I+=E*w,I+=A*m,q=I>>>13,I&=8191,I+=R*(5*P),I+=j*(5*J),I+=S*(5*X),I+=x*(5*k),I+=g*(5*B),q+=I>>>13,I&=8191;var D=q;D+=y*B,D+=b*L,D+=v*p,D+=E*o,D+=A*w,q=D>>>13,D&=8191,D+=R*m,D+=j*(5*P),D+=S*(5*J),D+=x*(5*X),D+=g*(5*k),q+=D>>>13,D&=8191;var u=q;u+=y*k,u+=b*B,u+=v*L,u+=E*p,u+=A*o,q=u>>>13,u&=8191,u+=R*w,u+=j*m,u+=S*(5*P),u+=x*(5*J),u+=g*(5*X),q+=u>>>13,u&=8191;var _=q;_+=y*X,_+=b*k,_+=v*B,_+=E*L,_+=A*p,q=_>>>13,_&=8191,_+=R*o,_+=j*w,_+=S*m,_+=x*(5*P),_+=g*(5*J),q+=_>>>13,_&=8191;var K=q;K+=y*J,K+=b*X,K+=v*k,K+=E*B,K+=A*L,q=K>>>13,K&=8191,K+=R*p,K+=j*o,K+=S*w,K+=x*m,K+=g*(5*P),q+=K>>>13,K&=8191;var V=q;V+=y*P,V+=b*J,V+=v*X,V+=E*k,V+=A*B,q=V>>>13,V&=8191,V+=R*L,V+=j*p,V+=S*o,V+=x*w,V+=g*m,q+=V>>>13,V&=8191,q=(q<<2)+q|0,q=q+Q|0,Q=q&8191,q=q>>>13,Y+=q,y=Q,b=Y,v=ae,E=T,A=I,R=D,j=u,S=_,x=K,g=V,l+=16,h-=16}this._h[0]=y,this._h[1]=b,this._h[2]=v,this._h[3]=E,this._h[4]=A,this._h[5]=R,this._h[6]=j,this._h[7]=S,this._h[8]=x,this._h[9]=g},a.prototype.finish=function(c,l){l===void 0&&(l=0);var h=new Uint16Array(10),f,y,b,v;if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(f=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=f,f=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=f*5,f=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=f,f=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=f,h[0]=this._h[0]+5,f=h[0]>>>13,h[0]&=8191,v=1;v<10;v++)h[v]=this._h[v]+f,f=h[v]>>>13,h[v]&=8191;for(h[9]-=1<<13,y=(f^1)-1,v=0;v<10;v++)h[v]&=y;for(y=~y,v=0;v<10;v++)this._h[v]=this._h[v]&y|h[v];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,v=1;v<8;v++)b=(this._h[v]+this._pad[v]|0)+(b>>>16)|0,this._h[v]=b&65535;return c[l+0]=this._h[0]>>>0,c[l+1]=this._h[0]>>>8,c[l+2]=this._h[1]>>>0,c[l+3]=this._h[1]>>>8,c[l+4]=this._h[2]>>>0,c[l+5]=this._h[2]>>>8,c[l+6]=this._h[3]>>>0,c[l+7]=this._h[3]>>>8,c[l+8]=this._h[4]>>>0,c[l+9]=this._h[4]>>>8,c[l+10]=this._h[5]>>>0,c[l+11]=this._h[5]>>>8,c[l+12]=this._h[6]>>>0,c[l+13]=this._h[6]>>>8,c[l+14]=this._h[7]>>>0,c[l+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(c){var l=0,h=c.length,f;if(this._leftover){f=16-this._leftover,f>h&&(f=h);for(var y=0;y<f;y++)this._buffer[this._leftover+y]=c[l+y];if(h-=f,l+=f,this._leftover+=f,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(f=h-h%16,this._blocks(c,l,f),l+=f,h-=f),h){for(var y=0;y<h;y++)this._buffer[this._leftover+y]=c[l+y];this._leftover+=h}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();t.Poly1305=n;function i(a,c){var l=new n(a);l.update(c);var h=l.digest();return l.clean(),h}t.oneTimeAuth=i;function s(a,c){return a.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(a,c)}t.equal=s}(co),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=sn,r=co,n=pt,i=te,s=Lt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var a=new Uint8Array(16),c=function(){function l(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return l.prototype.seal=function(h,f,y,b){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(h,v.length-h.length);var E=new Uint8Array(32);e.stream(this._key,v,E,4);var A=f.length+this.tagLength,R;if(b){if(b.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");R=b}else R=new Uint8Array(A);return e.streamXOR(this._key,v,f,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),E,R.subarray(0,R.length-this.tagLength),y),n.wipe(v),R},l.prototype.open=function(h,f,y,b){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(f.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(h,v.length-h.length);var E=new Uint8Array(32);e.stream(this._key,v,E,4);var A=new Uint8Array(this.tagLength);if(this._authenticate(A,E,f.subarray(0,f.length-this.tagLength),y),!s.equal(A,f.subarray(f.length-this.tagLength,f.length)))return null;var R=f.length-this.tagLength,j;if(b){if(b.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");j=b}else j=new Uint8Array(R);return e.streamXOR(this._key,v,f.subarray(0,f.length-this.tagLength),j,4),n.wipe(v),j},l.prototype.clean=function(){return n.wipe(this._key),this},l.prototype._authenticate=function(h,f,y,b){var v=new r.Poly1305(f);b&&(v.update(b),b.length%16>0&&v.update(a.subarray(b.length%16))),v.update(y),y.length%16>0&&v.update(a.subarray(y.length%16));var E=new Uint8Array(8);b&&i.writeUint64LE(b.length,E),v.update(E),i.writeUint64LE(y.length,E),v.update(E);for(var A=v.digest(),R=0;R<A.length;R++)h[R]=A[R];v.clean(),n.wipe(A),n.wipe(E)},l}();t.ChaCha20Poly1305=c}(ii);var ho={},Tr={},oi={};Object.defineProperty(oi,"__esModule",{value:!0});function Vf(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}oi.isSerializableHash=Vf,Object.defineProperty(Tr,"__esModule",{value:!0});var Ot=oi,Gf=Lt,Wf=pt,lo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Ot.isSerializableHash(this._inner)&&Ot.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Wf.wipe(n)}return t.prototype.reset=function(){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ot.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ot.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Tr.HMAC=lo;function Yf(t,e,r){var n=new lo(t,e);n.update(r);var i=n.digest();return n.clean(),i}Tr.hmac=Yf,Tr.equal=Gf.equal,Object.defineProperty(ho,"__esModule",{value:!0});var fo=Tr,po=pt,kf=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=fo.hmac(this._hash,n,r);this._hmac=new fo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),po.wipe(this._buffer),po.wipe(this._counter),this._bufpos=0},t}(),Xf=ho.HKDF=kf,on={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=pt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(l,h){if(h===void 0&&(h=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var f=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=l[f++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(f=s(this._temp,this._state,l,f,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=l[f++],h--;return this},c.prototype.finish=function(l){if(!this._finished){var h=this._bytesHashed,f=this._bufferLength,y=h/536870912|0,b=h<<3,v=h%64<56?64:128;this._buffer[f]=128;for(var E=f+1;E<v-8;E++)this._buffer[E]=0;e.writeUint32BE(y,this._buffer,v-8),e.writeUint32BE(b,this._buffer,v-4),s(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(var E=0;E<this.digestLength/4;E++)e.writeUint32BE(this._state[E],l,E*4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,l,h,f,y){for(;y>=64;){for(var b=l[0],v=l[1],E=l[2],A=l[3],R=l[4],j=l[5],S=l[6],x=l[7],g=0;g<16;g++){var m=f+g*4;c[g]=e.readUint32BE(h,m)}for(var g=16;g<64;g++){var w=c[g-2],o=(w>>>17|w<<32-17)^(w>>>19|w<<32-19)^w>>>10;w=c[g-15];var p=(w>>>7|w<<32-7)^(w>>>18|w<<32-18)^w>>>3;c[g]=(o+c[g-7]|0)+(p+c[g-16]|0)}for(var g=0;g<64;g++){var o=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&j^~R&S)|0)+(x+(i[g]+c[g]|0)|0)|0,p=((b>>>2|b<<32-2)^(b>>>13|b<<32-13)^(b>>>22|b<<32-22))+(b&v^b&E^v&E)|0;x=S,S=j,j=R,R=A+o|0,A=E,E=v,v=b,b=o+p|0}l[0]+=b,l[1]+=v,l[2]+=E,l[3]+=A,l[4]+=R,l[5]+=j,l[6]+=S,l[7]+=x,f+=64,y-=64}return f}function a(c){var l=new n;l.update(c);var h=l.digest();return l.clean(),h}t.hash=a})(on);var ai={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=or,r=pt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(g){const m=new Float64Array(16);if(g)for(let w=0;w<g.length;w++)m[w]=g[w];return m}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function a(g){let m=1;for(let w=0;w<16;w++){let o=g[w]+m+65535;m=Math.floor(o/65536),g[w]=o-m*65536}g[0]+=m-1+37*(m-1)}function c(g,m,w){const o=~(w-1);for(let p=0;p<16;p++){const L=o&(g[p]^m[p]);g[p]^=L,m[p]^=L}}function l(g,m){const w=n(),o=n();for(let p=0;p<16;p++)o[p]=m[p];a(o),a(o),a(o);for(let p=0;p<2;p++){w[0]=o[0]-65517;for(let B=1;B<15;B++)w[B]=o[B]-65535-(w[B-1]>>16&1),w[B-1]&=65535;w[15]=o[15]-32767-(w[14]>>16&1);const L=w[15]>>16&1;w[14]&=65535,c(o,w,1-L)}for(let p=0;p<16;p++)g[2*p]=o[p]&255,g[2*p+1]=o[p]>>8}function h(g,m){for(let w=0;w<16;w++)g[w]=m[2*w]+(m[2*w+1]<<8);g[15]&=32767}function f(g,m,w){for(let o=0;o<16;o++)g[o]=m[o]+w[o]}function y(g,m,w){for(let o=0;o<16;o++)g[o]=m[o]-w[o]}function b(g,m,w){let o,p,L=0,B=0,k=0,X=0,J=0,P=0,N=0,W=0,M=0,F=0,U=0,$=0,z=0,ne=0,q=0,Q=0,Y=0,ae=0,T=0,I=0,D=0,u=0,_=0,K=0,V=0,le=0,ye=0,de=0,ve=0,Le=0,Ae=0,_e=w[0],pe=w[1],fe=w[2],ue=w[3],ce=w[4],oe=w[5],se=w[6],ee=w[7],he=w[8],ge=w[9],re=w[10],be=w[11],we=w[12],Ee=w[13],Se=w[14],me=w[15];o=m[0],L+=o*_e,B+=o*pe,k+=o*fe,X+=o*ue,J+=o*ce,P+=o*oe,N+=o*se,W+=o*ee,M+=o*he,F+=o*ge,U+=o*re,$+=o*be,z+=o*we,ne+=o*Ee,q+=o*Se,Q+=o*me,o=m[1],B+=o*_e,k+=o*pe,X+=o*fe,J+=o*ue,P+=o*ce,N+=o*oe,W+=o*se,M+=o*ee,F+=o*he,U+=o*ge,$+=o*re,z+=o*be,ne+=o*we,q+=o*Ee,Q+=o*Se,Y+=o*me,o=m[2],k+=o*_e,X+=o*pe,J+=o*fe,P+=o*ue,N+=o*ce,W+=o*oe,M+=o*se,F+=o*ee,U+=o*he,$+=o*ge,z+=o*re,ne+=o*be,q+=o*we,Q+=o*Ee,Y+=o*Se,ae+=o*me,o=m[3],X+=o*_e,J+=o*pe,P+=o*fe,N+=o*ue,W+=o*ce,M+=o*oe,F+=o*se,U+=o*ee,$+=o*he,z+=o*ge,ne+=o*re,q+=o*be,Q+=o*we,Y+=o*Ee,ae+=o*Se,T+=o*me,o=m[4],J+=o*_e,P+=o*pe,N+=o*fe,W+=o*ue,M+=o*ce,F+=o*oe,U+=o*se,$+=o*ee,z+=o*he,ne+=o*ge,q+=o*re,Q+=o*be,Y+=o*we,ae+=o*Ee,T+=o*Se,I+=o*me,o=m[5],P+=o*_e,N+=o*pe,W+=o*fe,M+=o*ue,F+=o*ce,U+=o*oe,$+=o*se,z+=o*ee,ne+=o*he,q+=o*ge,Q+=o*re,Y+=o*be,ae+=o*we,T+=o*Ee,I+=o*Se,D+=o*me,o=m[6],N+=o*_e,W+=o*pe,M+=o*fe,F+=o*ue,U+=o*ce,$+=o*oe,z+=o*se,ne+=o*ee,q+=o*he,Q+=o*ge,Y+=o*re,ae+=o*be,T+=o*we,I+=o*Ee,D+=o*Se,u+=o*me,o=m[7],W+=o*_e,M+=o*pe,F+=o*fe,U+=o*ue,$+=o*ce,z+=o*oe,ne+=o*se,q+=o*ee,Q+=o*he,Y+=o*ge,ae+=o*re,T+=o*be,I+=o*we,D+=o*Ee,u+=o*Se,_+=o*me,o=m[8],M+=o*_e,F+=o*pe,U+=o*fe,$+=o*ue,z+=o*ce,ne+=o*oe,q+=o*se,Q+=o*ee,Y+=o*he,ae+=o*ge,T+=o*re,I+=o*be,D+=o*we,u+=o*Ee,_+=o*Se,K+=o*me,o=m[9],F+=o*_e,U+=o*pe,$+=o*fe,z+=o*ue,ne+=o*ce,q+=o*oe,Q+=o*se,Y+=o*ee,ae+=o*he,T+=o*ge,I+=o*re,D+=o*be,u+=o*we,_+=o*Ee,K+=o*Se,V+=o*me,o=m[10],U+=o*_e,$+=o*pe,z+=o*fe,ne+=o*ue,q+=o*ce,Q+=o*oe,Y+=o*se,ae+=o*ee,T+=o*he,I+=o*ge,D+=o*re,u+=o*be,_+=o*we,K+=o*Ee,V+=o*Se,le+=o*me,o=m[11],$+=o*_e,z+=o*pe,ne+=o*fe,q+=o*ue,Q+=o*ce,Y+=o*oe,ae+=o*se,T+=o*ee,I+=o*he,D+=o*ge,u+=o*re,_+=o*be,K+=o*we,V+=o*Ee,le+=o*Se,ye+=o*me,o=m[12],z+=o*_e,ne+=o*pe,q+=o*fe,Q+=o*ue,Y+=o*ce,ae+=o*oe,T+=o*se,I+=o*ee,D+=o*he,u+=o*ge,_+=o*re,K+=o*be,V+=o*we,le+=o*Ee,ye+=o*Se,de+=o*me,o=m[13],ne+=o*_e,q+=o*pe,Q+=o*fe,Y+=o*ue,ae+=o*ce,T+=o*oe,I+=o*se,D+=o*ee,u+=o*he,_+=o*ge,K+=o*re,V+=o*be,le+=o*we,ye+=o*Ee,de+=o*Se,ve+=o*me,o=m[14],q+=o*_e,Q+=o*pe,Y+=o*fe,ae+=o*ue,T+=o*ce,I+=o*oe,D+=o*se,u+=o*ee,_+=o*he,K+=o*ge,V+=o*re,le+=o*be,ye+=o*we,de+=o*Ee,ve+=o*Se,Le+=o*me,o=m[15],Q+=o*_e,Y+=o*pe,ae+=o*fe,T+=o*ue,I+=o*ce,D+=o*oe,u+=o*se,_+=o*ee,K+=o*he,V+=o*ge,le+=o*re,ye+=o*be,de+=o*we,ve+=o*Ee,Le+=o*Se,Ae+=o*me,L+=38*Y,B+=38*ae,k+=38*T,X+=38*I,J+=38*D,P+=38*u,N+=38*_,W+=38*K,M+=38*V,F+=38*le,U+=38*ye,$+=38*de,z+=38*ve,ne+=38*Le,q+=38*Ae,p=1,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=P+p+65535,p=Math.floor(o/65536),P=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=ne+p+65535,p=Math.floor(o/65536),ne=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,L+=p-1+37*(p-1),p=1,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=P+p+65535,p=Math.floor(o/65536),P=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=ne+p+65535,p=Math.floor(o/65536),ne=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,L+=p-1+37*(p-1),g[0]=L,g[1]=B,g[2]=k,g[3]=X,g[4]=J,g[5]=P,g[6]=N,g[7]=W,g[8]=M,g[9]=F,g[10]=U,g[11]=$,g[12]=z,g[13]=ne,g[14]=q,g[15]=Q}function v(g,m){b(g,m,m)}function E(g,m){const w=n();for(let o=0;o<16;o++)w[o]=m[o];for(let o=253;o>=0;o--)v(w,w),o!==2&&o!==4&&b(w,w,m);for(let o=0;o<16;o++)g[o]=w[o]}function A(g,m){const w=new Uint8Array(32),o=new Float64Array(80),p=n(),L=n(),B=n(),k=n(),X=n(),J=n();for(let M=0;M<31;M++)w[M]=g[M];w[31]=g[31]&127|64,w[0]&=248,h(o,m);for(let M=0;M<16;M++)L[M]=o[M];p[0]=k[0]=1;for(let M=254;M>=0;--M){const F=w[M>>>3]>>>(M&7)&1;c(p,L,F),c(B,k,F),f(X,p,B),y(p,p,B),f(B,L,k),y(L,L,k),v(k,X),v(J,p),b(p,B,p),b(B,L,X),f(X,p,B),y(p,p,B),v(L,p),y(B,k,J),b(p,B,s),f(p,p,k),b(B,B,p),b(p,k,J),b(k,L,o),v(L,X),c(p,L,F),c(B,k,F)}for(let M=0;M<16;M++)o[M+16]=p[M],o[M+32]=B[M],o[M+48]=L[M],o[M+64]=k[M];const P=o.subarray(32),N=o.subarray(16);E(P,P),b(N,N,P);const W=new Uint8Array(32);return l(W,N),W}t.scalarMult=A;function R(g){return A(g,i)}t.scalarMultBase=R;function j(g){if(g.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const m=new Uint8Array(g);return{publicKey:R(m),secretKey:m}}t.generateKeyPairFromSeed=j;function S(g){const m=(0,e.randomBytes)(32,g),w=j(m);return(0,r.wipe)(m),w}t.generateKeyPair=S;function x(g,m,w=!1){if(g.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(m.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=A(g,m);if(w){let p=0;for(let L=0;L<o.length;L++)p|=o[L];if(p===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=x})(ai);var go=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Jf=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),Zf=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Qf=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),ed=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),td=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),rd=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,nd=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,_o=3,id=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",rd]],yo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function sd(t){return t?bo(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new td:typeof navigator<"u"?bo(navigator.userAgent):cd()}function od(t){return t!==""&&id.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function bo(t){var e=od(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new ed;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<_o&&(i=go(go([],i,!0),ud(_o-i.length),!0)):i=[];var s=i.join("."),a=ad(t),c=nd.exec(t);return c&&c[1]?new Qf(r,s,a,c[1]):new Jf(r,s,a)}function ad(t){for(var e=0,r=yo.length;e<r;e++){var n=yo[e],i=n[0],s=n[1],a=s.exec(t);if(a)return i}return null}function cd(){var t=typeof process<"u"&&process.version;return t?new Zf(process.version.slice(1)):null}function ud(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ie={};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getLocalStorage=Ie.getLocalStorageOrThrow=Ie.getCrypto=Ie.getCryptoOrThrow=vo=Ie.getLocation=Ie.getLocationOrThrow=ci=Ie.getNavigator=Ie.getNavigatorOrThrow=wo=Ie.getDocument=Ie.getDocumentOrThrow=Ie.getFromWindowOrThrow=Ie.getFromWindow=void 0;function Yt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ie.getFromWindow=Yt;function ar(t){const e=Yt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ie.getFromWindowOrThrow=ar;function hd(){return ar("document")}Ie.getDocumentOrThrow=hd;function ld(){return Yt("document")}var wo=Ie.getDocument=ld;function fd(){return ar("navigator")}Ie.getNavigatorOrThrow=fd;function dd(){return Yt("navigator")}var ci=Ie.getNavigator=dd;function pd(){return ar("location")}Ie.getLocationOrThrow=pd;function gd(){return Yt("location")}var vo=Ie.getLocation=gd;function _d(){return ar("crypto")}Ie.getCryptoOrThrow=_d;function yd(){return Yt("crypto")}Ie.getCrypto=yd;function bd(){return ar("localStorage")}Ie.getLocalStorageOrThrow=bd;function wd(){return Yt("localStorage")}Ie.getLocalStorage=wd;var ui={};Object.defineProperty(ui,"__esModule",{value:!0});var mo=ui.getWindowMetadata=void 0;const Eo=Ie;function vd(){let t,e;try{t=Eo.getDocumentOrThrow(),e=Eo.getLocationOrThrow()}catch{return null}function r(){const y=t.getElementsByTagName("link"),b=[];for(let v=0;v<y.length;v++){const E=y[v],A=E.getAttribute("rel");if(A&&A.toLowerCase().indexOf("icon")>-1){const R=E.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let j=e.protocol+"//"+e.host;if(R.indexOf("/")===0)j+=R;else{const S=e.pathname.split("/");S.pop();const x=S.join("/");j+=x+"/"+R}b.push(j)}else if(R.indexOf("//")===0){const j=e.protocol+R;b.push(j)}else b.push(R)}}return b}function n(...y){const b=t.getElementsByTagName("meta");for(let v=0;v<b.length;v++){const E=b[v],A=["itemprop","property","name"].map(R=>E.getAttribute(R)).filter(R=>R?y.includes(R):!1);if(A.length&&A){const R=E.getAttribute("content");if(R)return R}}return""}function i(){let y=n("name","og:site_name","og:title","twitter:title");return y||(y=t.title),y}function s(){return n("description","og:description","twitter:description","keywords")}const a=i(),c=s(),l=e.origin,h=r();return{description:c,url:l,icons:h,name:a}}mo=ui.getWindowMetadata=vd;var Nr={},md=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),So="%[a-f0-9]{2}",Do=new RegExp("("+So+")|([^%]+?)","gi"),Oo=new RegExp("("+So+")+","gi");function hi(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],hi(r),hi(n))}function Ed(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Do)||[],r=1;r<e.length;r++)t=hi(e,r).join(""),e=t.match(Do)||[];return t}}function Sd(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Oo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=Ed(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Oo.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var a=i[s];t=t.replace(new RegExp(a,"g"),e[a])}return t}var Dd=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Sd(t)}},Od=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},xd=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var a=n[s],c=t[a];(i?e.indexOf(a)!==-1:e(a,c,t))&&(r[a]=c)}return r};(function(t){const e=md,r=Dd,n=Od,i=xd,s=S=>S==null,a=Symbol("encodeFragmentIdentifier");function c(S){switch(S.arrayFormat){case"index":return x=>(g,m)=>{const w=g.length;return m===void 0||S.skipNull&&m===null||S.skipEmptyString&&m===""?g:m===null?[...g,[f(x,S),"[",w,"]"].join("")]:[...g,[f(x,S),"[",f(w,S),"]=",f(m,S)].join("")]};case"bracket":return x=>(g,m)=>m===void 0||S.skipNull&&m===null||S.skipEmptyString&&m===""?g:m===null?[...g,[f(x,S),"[]"].join("")]:[...g,[f(x,S),"[]=",f(m,S)].join("")];case"colon-list-separator":return x=>(g,m)=>m===void 0||S.skipNull&&m===null||S.skipEmptyString&&m===""?g:m===null?[...g,[f(x,S),":list="].join("")]:[...g,[f(x,S),":list=",f(m,S)].join("")];case"comma":case"separator":case"bracket-separator":{const x=S.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(m,w)=>w===void 0||S.skipNull&&w===null||S.skipEmptyString&&w===""?m:(w=w===null?"":w,m.length===0?[[f(g,S),x,f(w,S)].join("")]:[[m,f(w,S)].join(S.arrayFormatSeparator)])}default:return x=>(g,m)=>m===void 0||S.skipNull&&m===null||S.skipEmptyString&&m===""?g:m===null?[...g,f(x,S)]:[...g,[f(x,S),"=",f(m,S)].join("")]}}function l(S){let x;switch(S.arrayFormat){case"index":return(g,m,w)=>{if(x=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!x){w[g]=m;return}w[g]===void 0&&(w[g]={}),w[g][x[1]]=m};case"bracket":return(g,m,w)=>{if(x=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!x){w[g]=m;return}if(w[g]===void 0){w[g]=[m];return}w[g]=[].concat(w[g],m)};case"colon-list-separator":return(g,m,w)=>{if(x=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!x){w[g]=m;return}if(w[g]===void 0){w[g]=[m];return}w[g]=[].concat(w[g],m)};case"comma":case"separator":return(g,m,w)=>{const o=typeof m=="string"&&m.includes(S.arrayFormatSeparator),p=typeof m=="string"&&!o&&y(m,S).includes(S.arrayFormatSeparator);m=p?y(m,S):m;const L=o||p?m.split(S.arrayFormatSeparator).map(B=>y(B,S)):m===null?m:y(m,S);w[g]=L};case"bracket-separator":return(g,m,w)=>{const o=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!o){w[g]=m&&y(m,S);return}const p=m===null?[]:m.split(S.arrayFormatSeparator).map(L=>y(L,S));if(w[g]===void 0){w[g]=p;return}w[g]=[].concat(w[g],p)};default:return(g,m,w)=>{if(w[g]===void 0){w[g]=m;return}w[g]=[].concat(w[g],m)}}}function h(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function f(S,x){return x.encode?x.strict?e(S):encodeURIComponent(S):S}function y(S,x){return x.decode?r(S):S}function b(S){return Array.isArray(S)?S.sort():typeof S=="object"?b(Object.keys(S)).sort((x,g)=>Number(x)-Number(g)).map(x=>S[x]):S}function v(S){const x=S.indexOf("#");return x!==-1&&(S=S.slice(0,x)),S}function E(S){let x="";const g=S.indexOf("#");return g!==-1&&(x=S.slice(g)),x}function A(S){S=v(S);const x=S.indexOf("?");return x===-1?"":S.slice(x+1)}function R(S,x){return x.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):x.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function j(S,x){x=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},x),h(x.arrayFormatSeparator);const g=l(x),m=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return m;for(const w of S.split("&")){if(w==="")continue;let[o,p]=n(x.decode?w.replace(/\+/g," "):w,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(x.arrayFormat)?p:y(p,x),g(y(o,x),p,m)}for(const w of Object.keys(m)){const o=m[w];if(typeof o=="object"&&o!==null)for(const p of Object.keys(o))o[p]=R(o[p],x);else m[w]=R(o,x)}return x.sort===!1?m:(x.sort===!0?Object.keys(m).sort():Object.keys(m).sort(x.sort)).reduce((w,o)=>{const p=m[o];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?w[o]=b(p):w[o]=p,w},Object.create(null))}t.extract=A,t.parse=j,t.stringify=(S,x)=>{if(!S)return"";x=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},x),h(x.arrayFormatSeparator);const g=p=>x.skipNull&&s(S[p])||x.skipEmptyString&&S[p]==="",m=c(x),w={};for(const p of Object.keys(S))g(p)||(w[p]=S[p]);const o=Object.keys(w);return x.sort!==!1&&o.sort(x.sort),o.map(p=>{const L=S[p];return L===void 0?"":L===null?f(p,x):Array.isArray(L)?L.length===0&&x.arrayFormat==="bracket-separator"?f(p,x)+"[]":L.reduce(m(p),[]).join("&"):f(p,x)+"="+f(L,x)}).filter(p=>p.length>0).join("&")},t.parseUrl=(S,x)=>{x=Object.assign({decode:!0},x);const[g,m]=n(S,"#");return Object.assign({url:g.split("?")[0]||"",query:j(A(S),x)},x&&x.parseFragmentIdentifier&&m?{fragmentIdentifier:y(m,x)}:{})},t.stringifyUrl=(S,x)=>{x=Object.assign({encode:!0,strict:!0,[a]:!0},x);const g=v(S.url).split("?")[0]||"",m=t.extract(S.url),w=t.parse(m,{sort:!1}),o=Object.assign(w,S.query);let p=t.stringify(o,x);p&&(p=`?${p}`);let L=E(S.url);return S.fragmentIdentifier&&(L=`#${x[a]?f(S.fragmentIdentifier,x):S.fragmentIdentifier}`),`${g}${p}${L}`},t.pick=(S,x,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[a]:!1},g);const{url:m,query:w,fragmentIdentifier:o}=t.parseUrl(S,g);return t.stringifyUrl({url:m,query:i(w,x),fragmentIdentifier:o},g)},t.exclude=(S,x,g)=>{const m=Array.isArray(x)?w=>!x.includes(w):(w,o)=>!x(w,o);return t.pick(S,m,g)}})(Nr);const Id={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function xo(t,e){return t.includes(":")?[t]:e.chains||[]}const Io="base10",ct="base16",li="base64pad",fi="utf8",To=0,kt=1,Td=0,No=1,di=12,pi=32;function Nd(){const t=ai.generateKeyPair();return{privateKey:at(t.secretKey,ct),publicKey:at(t.publicKey,ct)}}function gi(){const t=or.randomBytes(pi);return at(t,ct)}function Pd(t,e){const r=ai.sharedKey(ft(t,ct),ft(e,ct)),n=new Xf(on.SHA256,r).expand(pi);return at(n,ct)}function Ad(t){const e=on.hash(ft(t,ct));return at(e,ct)}function an(t){const e=on.hash(ft(t,fi));return at(e,ct)}function Rd(t){return ft(`${t}`,Io)}function Pr(t){return Number(at(t,Io))}function Cd(t){const e=Rd(typeof t.type<"u"?t.type:To);if(Pr(e)===kt&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ft(t.senderPublicKey,ct):void 0,n=typeof t.iv<"u"?ft(t.iv,ct):or.randomBytes(di),i=new ii.ChaCha20Poly1305(ft(t.symKey,ct)).seal(n,ft(t.message,fi));return Ld({type:e,sealed:i,iv:n,senderPublicKey:r})}function Fd(t){const e=new ii.ChaCha20Poly1305(ft(t.symKey,ct)),{sealed:r,iv:n}=cn(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return at(i,fi)}function Ld(t){if(Pr(t.type)===kt){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return at(ei([t.type,t.senderPublicKey,t.iv,t.sealed]),li)}return at(ei([t.type,t.iv,t.sealed]),li)}function cn(t){const e=ft(t,li),r=e.slice(Td,No),n=No;if(Pr(r)===kt){const c=n+pi,l=c+di,h=e.slice(n,c),f=e.slice(c,l),y=e.slice(l);return{type:r,sealed:y,iv:f,senderPublicKey:h}}const i=n+di,s=e.slice(n,i),a=e.slice(i);return{type:r,sealed:a,iv:s}}function Ud(t,e){const r=cn(t);return Po({type:Pr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?at(r.senderPublicKey,ct):void 0,receiverPublicKey:e?.receiverPublicKey})}function Po(t){const e=t?.type||To;if(e===kt){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ao(t){return t.type===kt&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var $d=Object.defineProperty,Ro=Object.getOwnPropertySymbols,Md=Object.prototype.hasOwnProperty,jd=Object.prototype.propertyIsEnumerable,Co=(t,e,r)=>e in t?$d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fo=(t,e)=>{for(var r in e||(e={}))Md.call(e,r)&&Co(t,r,e[r]);if(Ro)for(var r of Ro(e))jd.call(e,r)&&Co(t,r,e[r]);return t};const Bd="ReactNative",Ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},zd="js";function Lo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function qd(){return!wo()&&!!ci()&&navigator.product===Bd}function Kd(){return!Lo()&&!!ci()}function Hd(){return qd()?Ar.reactNative:Lo()?Ar.node:Kd()?Ar.browser:Ar.unknown}function Vd(t,e){let r=Nr.parse(t);return r=Fo(Fo({},r),e),t=Nr.stringify(r),t}function Gd(){return mo()||{name:"",description:"",url:"",icons:[""]}}function Wd(){const t=sd();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Yd(){var t;const e=Hd();return e===Ar.browser?[e,((t=vo())==null?void 0:t.host)||"unknown"].join(":"):e}function kd(t,e,r){const n=Wd(),i=Yd();return[[t,e].join("-"),[zd,r].join("-"),n,i].join("/")}function Xd({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:a}){const c=r.split("?"),l=kd(t,e,n),h={auth:i,ua:l,projectId:s,useOnCloseEvent:a||void 0},f=Vd(c[1]||"",h);return c[0]+"?"+f}function Xt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Uo(t){return Object.fromEntries(t.entries())}function $o(t){return new Map(Object.entries(t))}function cr(t=Z.FIVE_MINUTES,e){const r=Z.toMiliseconds(t||Z.FIVE_MINUTES);let n,i,s;return{resolve:a=>{s&&n&&(clearTimeout(s),n(a))},reject:a=>{s&&i&&(clearTimeout(s),i(a))},done:()=>new Promise((a,c)=>{s=setTimeout(()=>{c(new Error(e))},r),n=a,i=c})}}function un(t,e,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),e);try{const a=await t;n(a)}catch(a){i(a)}clearTimeout(s)})}function Mo(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Jd(t){return Mo("topic",t)}function Zd(t){return Mo("id",t)}function jo(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function xt(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function Ut(t){return Date.now()>=Z.toMiliseconds(t)}function Ue(t,e){return`${t}${e?`:${e}`:""}`}const Qd="irn";function _i(t){return t?.relay||{protocol:Qd}}function hn(t){const e=Id[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var ep=Object.defineProperty,Bo=Object.getOwnPropertySymbols,tp=Object.prototype.hasOwnProperty,rp=Object.prototype.propertyIsEnumerable,zo=(t,e,r)=>e in t?ep(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,np=(t,e)=>{for(var r in e||(e={}))tp.call(e,r)&&zo(t,r,e[r]);if(Bo)for(var r of Bo(e))rp.call(e,r)&&zo(t,r,e[r]);return t};function ip(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),a=t[i];r[s]=a}}),r}function sp(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=Nr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:a.symKey,relay:ip(a)}}function op(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function ap(t){return`${t.protocol}:${t.topic}@${t.version}?`+Nr.stringify(np({symKey:t.symKey},op(t.relay)))}function ur(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function cp(t){const e=[];return Object.values(t).forEach(r=>{e.push(...ur(r.accounts))}),e}function up(t,e){const r=[];return Object.values(t).forEach(n=>{ur(n.accounts).includes(e)&&r.push(...n.methods)}),r}function hp(t,e){const r=[];return Object.values(t).forEach(n=>{ur(n.accounts).includes(e)&&r.push(...n.events)}),r}function lp(t,e){const r=ln(t,e);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(t))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return n}const fp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},dp={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(t,e){const{message:r,code:n}=dp[t];return{message:e?`${r} ${e}`:r,code:n}}function Ke(t,e){const{message:r,code:n}=fp[t];return{message:e?`${r} ${e}`:r,code:n}}function Rr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Cr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function ut(t){return typeof t>"u"}function He(t,e){return e&&ut(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function yi(t,e){return e&&ut(t)?!0:typeof t=="number"&&!isNaN(t)}function pp(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return Xt(i,n)?(n.forEach(a=>{const{accounts:c,methods:l,events:h}=t.namespaces[a],f=ur(c),y=r[a];(!Xt(xo(a,y),f)||!Xt(y.methods,l)||!Xt(y.events,h))&&(s=!1)}),s):!1}function bi(t){return He(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function gp(t){if(He(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&bi(r)}}return!1}function _p(t){if(He(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function yp(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function bp(t){return t?.topic}function wp(t,e){let r=null;return He(t?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function qo(t){let e=!0;return Rr(t)?t.length&&(e=t.every(r=>He(r,!1))):e=!1,e}function vp(t,e,r){let n=null;return Rr(e)?e.forEach(i=>{n||(!bi(i)||!i.includes(t))&&(n=Ke("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ke("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function mp(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const s=vp(n,xo(n,i),`${e} requiredNamespace`);s&&(r=s)}),r}function Ep(t,e){let r=null;return Rr(t)?t.forEach(n=>{r||gp(n)||(r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Ke("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Sp(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Ep(n?.accounts,`${e} namespace`);i&&(r=i)}),r}function Dp(t,e){let r=null;return qo(t?.methods)?qo(t?.events)||(r=Ke("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ke("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function Ko(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Dp(n,`${e}, namespace`);i&&(r=i)}),r}function Op(t,e,r){let n=null;if(t&&Cr(t)){const i=Ko(t,e);i&&(n=i);const s=mp(t,e);s&&(n=s)}else n=H("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function ln(t,e){let r=null;if(t&&Cr(t)){const n=Ko(t,e);n&&(r=n);const i=Sp(t,e);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Ho(t){return He(t.protocol,!0)}function xp(t,e){let r=!1;return e&&!t?r=!0:t&&Rr(t)&&t.length&&t.forEach(n=>{r=Ho(n)}),r}function Ip(t){return typeof t=="number"}function dt(t){return typeof t<"u"&&typeof t!==null}function Tp(t){return!(!t||typeof t!="object"||!t.code||!yi(t.code,!1)||!t.message||!He(t.message,!1))}function Np(t){return!(ut(t)||!He(t.method,!1))}function Pp(t){return!(ut(t)||ut(t.result)&&ut(t.error)||!yi(t.id,!1)||!He(t.jsonrpc,!1))}function Ap(t){return!(ut(t)||!He(t.name,!1))}function Vo(t,e){return!(!bi(e)||!cp(t).includes(e))}function Rp(t,e,r){return He(r,!1)?up(t,e).includes(r):!1}function Cp(t,e,r){return He(r,!1)?hp(t,e).includes(r):!1}function Go(t,e,r){let n=null;const i=Fp(t),s=Lp(e),a=Object.keys(i),c=Object.keys(s),l=Wo(Object.keys(t)),h=Wo(Object.keys(e)),f=l.filter(y=>!h.includes(y));return f.length&&(n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${f.toString()}
      Received: ${Object.keys(e).toString()}`)),Xt(a,c)||(n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(y=>{if(!y.includes(":")||n)return;const b=ur(e[y].accounts);b.includes(y)||(n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${y}
        Required: ${y}
        Approved: ${b.toString()}`))}),a.forEach(y=>{n||(Xt(i[y].methods,s[y].methods)?Xt(i[y].events,s[y].events)||(n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${y}`)):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${y}`))}),n}function Fp(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(i=>{e[i]={methods:t[r].methods,events:t[r].events}})}),e}function Wo(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Lp(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const n=ur(t[r].accounts);n?.forEach(i=>{e[i]={accounts:t[r].accounts.filter(s=>s.includes(`${i}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function Up(t,e){return yi(t,!1)&&t<=e.max&&t>=e.min}const $p="PARSE_ERROR",Mp="INVALID_REQUEST",jp="METHOD_NOT_FOUND",Bp="INVALID_PARAMS",Yo="INTERNAL_ERROR",wi="SERVER_ERROR",zp=[-32700,-32600,-32601,-32602,-32603],Fr={[$p]:{code:-32700,message:"Parse error"},[Mp]:{code:-32600,message:"Invalid Request"},[jp]:{code:-32601,message:"Method not found"},[Bp]:{code:-32602,message:"Invalid params"},[Yo]:{code:-32603,message:"Internal error"},[wi]:{code:-32e3,message:"Server error"}},ko=wi;function qp(t){return zp.includes(t)}function Xo(t){return Object.keys(Fr).includes(t)?Fr[t]:Fr[ko]}function Kp(t){const e=Object.values(Fr).find(r=>r.code===t);return e||Fr[ko]}function Hp(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Jo={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var vi=function(t,e){return vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},vi(t,e)};function Vp(t,e){vi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var mi=function(){return mi=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mi.apply(this,arguments)};function Gp(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Wp(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(i<3?a(s):i>3?a(e,r,s):a(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Yp(t,e){return function(r,n){e(r,n,t)}}function kp(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Xp(t,e,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(f){try{h(n.next(f))}catch(y){a(y)}}function l(f){try{h(n.throw(f))}catch(y){a(y)}}function h(f){f.done?s(f.value):i(f.value).then(c,l)}h((n=n.apply(t,e||[])).next())})}function Jp(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(h){return function(f){return l([h,f])}}function l(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(f){h=[6,f],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Zp(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Qp(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Ei(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zo(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function eg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Zo(arguments[e]));return t}function tg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function Lr(t){return this instanceof Lr?(this.v=t,this):new Lr(t)}function rg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(v){return new Promise(function(E,A){s.push([b,v,E,A])>1||c(b,v)})})}function c(b,v){try{l(n[b](v))}catch(E){y(s[0][3],E)}}function l(b){b.value instanceof Lr?Promise.resolve(b.value.v).then(h,f):y(s[0][2],b)}function h(b){c("next",b)}function f(b){c("throw",b)}function y(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ng(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(a){return(r=!r)?{value:Lr(t[i](a)),done:i==="return"}:s?s(a):a}:s}}function ig(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Ei=="function"?Ei(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(a){return new Promise(function(c,l){a=t[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(h){s({value:h,done:c})},a)}}function sg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function og(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ag(t){return t&&t.__esModule?t:{default:t}}function cg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ug(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var hg=Object.freeze({__proto__:null,__extends:Vp,get __assign(){return mi},__rest:Gp,__decorate:Wp,__param:Yp,__metadata:kp,__awaiter:Xp,__generator:Jp,__createBinding:Zp,__exportStar:Qp,__values:Ei,__read:Zo,__spread:eg,__spreadArrays:tg,__await:Lr,__asyncGenerator:rg,__asyncDelegator:ng,__asyncValues:ig,__makeTemplateObject:sg,__importStar:og,__importDefault:ag,__classPrivateFieldGet:cg,__classPrivateFieldSet:ug}),lg=qt(hg),Pt={},Qo;function fg(){if(Qo)return Pt;Qo=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isBrowserCryptoAvailable=Pt.getSubtleCrypto=Pt.getBrowerCrypto=void 0;function t(){return et?.crypto||et?.msCrypto||{}}Pt.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Pt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Pt.isBrowserCryptoAvailable=r,Pt}var At={},ea;function dg(){if(ea)return At;ea=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowser=At.isNode=At.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}At.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}At.isNode=e;function r(){return!t()&&!e()}return At.isBrowser=r,At}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=lg;e.__exportStar(fg(),t),e.__exportStar(dg(),t)})(Jo);function ta(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function pg(t=6){return BigInt(ta(t))}function fn(t,e,r){return{id:r||ta(),jsonrpc:"2.0",method:t,params:e}}function Si(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Di(t,e,r){return{id:t,jsonrpc:"2.0",error:gg(e,r)}}function gg(t,e){return typeof t>"u"?Xo(Yo):(typeof t=="string"&&(t=Object.assign(Object.assign({},Xo(wi)),{message:t})),typeof e<"u"&&(t.data=e),qp(t.code)&&(t=Kp(t.code)),t)}class _g{}class yg extends _g{constructor(){super()}}class bg extends yg{constructor(e){super()}}const wg="^wss?:";function vg(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function mg(t,e){const r=vg(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function ra(t){return mg(t,wg)}function Eg(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function na(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Oi(t){return na(t)&&"method"in t}function xi(t){return na(t)&&(Rt(t)||mt(t))}function Rt(t){return"result"in t}function mt(t){return"error"in t}class Sg extends bg{constructor(e){super(e),this.events=new lt.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(fn(e.method,e.params||[],pg().toString()),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{mt(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),xi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ia=10,Dg=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Og=()=>typeof window<"u",xg=Dg();class Ig{constructor(e){if(this.url=e,this.events=new lt.exports.EventEmitter,this.registering=!1,!ra(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Yn(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!ra(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Jo.isReactNative()?void 0:{rejectUnauthorized:!Eg(e)},s=new xg(e,[],i);Og()?s.onerror=a=>{const c=a;n(this.emitError(c.error))}:s.on("error",a=>{n(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Ns(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Di(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return Hp(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ia&&this.events.setMaxListeners(ia)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ii={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,a=9007199254740991,c="[object Arguments]",l="[object Array]",h="[object AsyncFunction]",f="[object Boolean]",y="[object Date]",b="[object Error]",v="[object Function]",E="[object GeneratorFunction]",A="[object Map]",R="[object Number]",j="[object Null]",S="[object Object]",x="[object Promise]",g="[object Proxy]",m="[object RegExp]",w="[object Set]",o="[object String]",p="[object Symbol]",L="[object Undefined]",B="[object WeakMap]",k="[object ArrayBuffer]",X="[object DataView]",J="[object Float32Array]",P="[object Float64Array]",N="[object Int8Array]",W="[object Int16Array]",M="[object Int32Array]",F="[object Uint8Array]",U="[object Uint8ClampedArray]",$="[object Uint16Array]",z="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[P]=Y[N]=Y[W]=Y[M]=Y[F]=Y[U]=Y[$]=Y[z]=!0,Y[c]=Y[l]=Y[k]=Y[f]=Y[X]=Y[y]=Y[b]=Y[v]=Y[A]=Y[R]=Y[S]=Y[m]=Y[w]=Y[o]=Y[B]=!1;var ae=typeof et=="object"&&et&&et.Object===Object&&et,T=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||T||Function("return this")(),D=e&&!e.nodeType&&e,u=D&&!0&&t&&!t.nodeType&&t,_=u&&u.exports===D,K=_&&ae.process,V=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),le=V&&V.isTypedArray;function ye(d,O){for(var C=-1,G=d==null?0:d.length,Te=0,ie=[];++C<G;){var Fe=d[C];O(Fe,C,d)&&(ie[Te++]=Fe)}return ie}function de(d,O){for(var C=-1,G=O.length,Te=d.length;++C<G;)d[Te+C]=O[C];return d}function ve(d,O){for(var C=-1,G=d==null?0:d.length;++C<G;)if(O(d[C],C,d))return!0;return!1}function Le(d,O){for(var C=-1,G=Array(d);++C<d;)G[C]=O(C);return G}function Ae(d){return function(O){return d(O)}}function _e(d,O){return d.has(O)}function pe(d,O){return d?.[O]}function fe(d){var O=-1,C=Array(d.size);return d.forEach(function(G,Te){C[++O]=[Te,G]}),C}function ue(d,O){return function(C){return d(O(C))}}function ce(d){var O=-1,C=Array(d.size);return d.forEach(function(G){C[++O]=G}),C}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,he=I["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,be=function(){var d=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),we=ee.toString,Ee=RegExp("^"+ge.call(re).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Se=_?I.Buffer:void 0,me=I.Symbol,Et=I.Uint8Array,Nt=ee.propertyIsEnumerable,Mt=oe.splice,gt=me?me.toStringTag:void 0,Jt=Object.getOwnPropertySymbols,Br=Se?Se.isBuffer:void 0,vn=ue(Object.keys,Object),$e=lr(I,"DataView"),Re=lr(I,"Map"),Me=lr(I,"Promise"),je=lr(I,"Set"),Be=lr(I,"WeakMap"),Ce=lr(Object,"create"),Ge=Qt($e),We=Qt(Re),Ye=Qt(Me),ke=Qt(je),Xe=Qt(Be),qe=me?me.prototype:void 0,ze=qe?qe.valueOf:void 0;function Ne(d){var O=-1,C=d==null?0:d.length;for(this.clear();++O<C;){var G=d[O];this.set(G[0],G[1])}}function Je(){this.__data__=Ce?Ce(null):{},this.size=0}function Ze(d){var O=this.has(d)&&delete this.__data__[d];return this.size-=O?1:0,O}function py(d){var O=this.__data__;if(Ce){var C=O[d];return C===n?void 0:C}return re.call(O,d)?O[d]:void 0}function gy(d){var O=this.__data__;return Ce?O[d]!==void 0:re.call(O,d)}function _y(d,O){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Ce&&O===void 0?n:O,this}Ne.prototype.clear=Je,Ne.prototype.delete=Ze,Ne.prototype.get=py,Ne.prototype.has=gy,Ne.prototype.set=_y;function Ct(d){var O=-1,C=d==null?0:d.length;for(this.clear();++O<C;){var G=d[O];this.set(G[0],G[1])}}function yy(){this.__data__=[],this.size=0}function by(d){var O=this.__data__,C=En(O,d);if(C<0)return!1;var G=O.length-1;return C==G?O.pop():Mt.call(O,C,1),--this.size,!0}function wy(d){var O=this.__data__,C=En(O,d);return C<0?void 0:O[C][1]}function vy(d){return En(this.__data__,d)>-1}function my(d,O){var C=this.__data__,G=En(C,d);return G<0?(++this.size,C.push([d,O])):C[G][1]=O,this}Ct.prototype.clear=yy,Ct.prototype.delete=by,Ct.prototype.get=wy,Ct.prototype.has=vy,Ct.prototype.set=my;function Zt(d){var O=-1,C=d==null?0:d.length;for(this.clear();++O<C;){var G=d[O];this.set(G[0],G[1])}}function Ey(){this.size=0,this.__data__={hash:new Ne,map:new(Re||Ct),string:new Ne}}function Sy(d){var O=Sn(this,d).delete(d);return this.size-=O?1:0,O}function Dy(d){return Sn(this,d).get(d)}function Oy(d){return Sn(this,d).has(d)}function xy(d,O){var C=Sn(this,d),G=C.size;return C.set(d,O),this.size+=C.size==G?0:1,this}Zt.prototype.clear=Ey,Zt.prototype.delete=Sy,Zt.prototype.get=Dy,Zt.prototype.has=Oy,Zt.prototype.set=xy;function mn(d){var O=-1,C=d==null?0:d.length;for(this.__data__=new Zt;++O<C;)this.add(d[O])}function Iy(d){return this.__data__.set(d,n),this}function Ty(d){return this.__data__.has(d)}mn.prototype.add=mn.prototype.push=Iy,mn.prototype.has=Ty;function jt(d){var O=this.__data__=new Ct(d);this.size=O.size}function Ny(){this.__data__=new Ct,this.size=0}function Py(d){var O=this.__data__,C=O.delete(d);return this.size=O.size,C}function Ay(d){return this.__data__.get(d)}function Ry(d){return this.__data__.has(d)}function Cy(d,O){var C=this.__data__;if(C instanceof Ct){var G=C.__data__;if(!Re||G.length<r-1)return G.push([d,O]),this.size=++C.size,this;C=this.__data__=new Zt(G)}return C.set(d,O),this.size=C.size,this}jt.prototype.clear=Ny,jt.prototype.delete=Py,jt.prototype.get=Ay,jt.prototype.has=Ry,jt.prototype.set=Cy;function Fy(d,O){var C=Dn(d),G=!C&&ky(d),Te=!C&&!G&&Mi(d),ie=!C&&!G&&!Te&&Za(d),Fe=C||G||Te||ie,Qe=Fe?Le(d.length,String):[],nt=Qe.length;for(var Pe in d)(O||re.call(d,Pe))&&!(Fe&&(Pe=="length"||Te&&(Pe=="offset"||Pe=="parent")||ie&&(Pe=="buffer"||Pe=="byteLength"||Pe=="byteOffset")||Hy(Pe,nt)))&&Qe.push(Pe);return Qe}function En(d,O){for(var C=d.length;C--;)if(Ya(d[C][0],O))return C;return-1}function Ly(d,O,C){var G=O(d);return Dn(d)?G:de(G,C(d))}function zr(d){return d==null?d===void 0?L:j:gt&&gt in Object(d)?qy(d):Yy(d)}function Ha(d){return qr(d)&&zr(d)==c}function Va(d,O,C,G,Te){return d===O?!0:d==null||O==null||!qr(d)&&!qr(O)?d!==d&&O!==O:Uy(d,O,C,G,Va,Te)}function Uy(d,O,C,G,Te,ie){var Fe=Dn(d),Qe=Dn(O),nt=Fe?l:Bt(d),Pe=Qe?l:Bt(O);nt=nt==c?S:nt,Pe=Pe==c?S:Pe;var _t=nt==S,St=Pe==S,st=nt==Pe;if(st&&Mi(d)){if(!Mi(O))return!1;Fe=!0,_t=!1}if(st&&!_t)return ie||(ie=new jt),Fe||Za(d)?Ga(d,O,C,G,Te,ie):By(d,O,nt,C,G,Te,ie);if(!(C&i)){var wt=_t&&re.call(d,"__wrapped__"),vt=St&&re.call(O,"__wrapped__");if(wt||vt){var zt=wt?d.value():d,Ft=vt?O.value():O;return ie||(ie=new jt),Te(zt,Ft,C,G,ie)}}return st?(ie||(ie=new jt),zy(d,O,C,G,Te,ie)):!1}function $y(d){if(!Ja(d)||Gy(d))return!1;var O=ka(d)?Ee:q;return O.test(Qt(d))}function My(d){return qr(d)&&Xa(d.length)&&!!Y[zr(d)]}function jy(d){if(!Wy(d))return vn(d);var O=[];for(var C in Object(d))re.call(d,C)&&C!="constructor"&&O.push(C);return O}function Ga(d,O,C,G,Te,ie){var Fe=C&i,Qe=d.length,nt=O.length;if(Qe!=nt&&!(Fe&&nt>Qe))return!1;var Pe=ie.get(d);if(Pe&&ie.get(O))return Pe==O;var _t=-1,St=!0,st=C&s?new mn:void 0;for(ie.set(d,O),ie.set(O,d);++_t<Qe;){var wt=d[_t],vt=O[_t];if(G)var zt=Fe?G(vt,wt,_t,O,d,ie):G(wt,vt,_t,d,O,ie);if(zt!==void 0){if(zt)continue;St=!1;break}if(st){if(!ve(O,function(Ft,er){if(!_e(st,er)&&(wt===Ft||Te(wt,Ft,C,G,ie)))return st.push(er)})){St=!1;break}}else if(!(wt===vt||Te(wt,vt,C,G,ie))){St=!1;break}}return ie.delete(d),ie.delete(O),St}function By(d,O,C,G,Te,ie,Fe){switch(C){case X:if(d.byteLength!=O.byteLength||d.byteOffset!=O.byteOffset)return!1;d=d.buffer,O=O.buffer;case k:return!(d.byteLength!=O.byteLength||!ie(new Et(d),new Et(O)));case f:case y:case R:return Ya(+d,+O);case b:return d.name==O.name&&d.message==O.message;case m:case o:return d==O+"";case A:var Qe=fe;case w:var nt=G&i;if(Qe||(Qe=ce),d.size!=O.size&&!nt)return!1;var Pe=Fe.get(d);if(Pe)return Pe==O;G|=s,Fe.set(d,O);var _t=Ga(Qe(d),Qe(O),G,Te,ie,Fe);return Fe.delete(d),_t;case p:if(ze)return ze.call(d)==ze.call(O)}return!1}function zy(d,O,C,G,Te,ie){var Fe=C&i,Qe=Wa(d),nt=Qe.length,Pe=Wa(O),_t=Pe.length;if(nt!=_t&&!Fe)return!1;for(var St=nt;St--;){var st=Qe[St];if(!(Fe?st in O:re.call(O,st)))return!1}var wt=ie.get(d);if(wt&&ie.get(O))return wt==O;var vt=!0;ie.set(d,O),ie.set(O,d);for(var zt=Fe;++St<nt;){st=Qe[St];var Ft=d[st],er=O[st];if(G)var Qa=Fe?G(er,Ft,st,O,d,ie):G(Ft,er,st,d,O,ie);if(!(Qa===void 0?Ft===er||Te(Ft,er,C,G,ie):Qa)){vt=!1;break}zt||(zt=st=="constructor")}if(vt&&!zt){var On=d.constructor,xn=O.constructor;On!=xn&&"constructor"in d&&"constructor"in O&&!(typeof On=="function"&&On instanceof On&&typeof xn=="function"&&xn instanceof xn)&&(vt=!1)}return ie.delete(d),ie.delete(O),vt}function Wa(d){return Ly(d,Zy,Ky)}function Sn(d,O){var C=d.__data__;return Vy(O)?C[typeof O=="string"?"string":"hash"]:C.map}function lr(d,O){var C=pe(d,O);return $y(C)?C:void 0}function qy(d){var O=re.call(d,gt),C=d[gt];try{d[gt]=void 0;var G=!0}catch{}var Te=we.call(d);return G&&(O?d[gt]=C:delete d[gt]),Te}var Ky=Jt?function(d){return d==null?[]:(d=Object(d),ye(Jt(d),function(O){return Nt.call(d,O)}))}:Qy,Bt=zr;($e&&Bt(new $e(new ArrayBuffer(1)))!=X||Re&&Bt(new Re)!=A||Me&&Bt(Me.resolve())!=x||je&&Bt(new je)!=w||Be&&Bt(new Be)!=B)&&(Bt=function(d){var O=zr(d),C=O==S?d.constructor:void 0,G=C?Qt(C):"";if(G)switch(G){case Ge:return X;case We:return A;case Ye:return x;case ke:return w;case Xe:return B}return O});function Hy(d,O){return O=O??a,!!O&&(typeof d=="number"||Q.test(d))&&d>-1&&d%1==0&&d<O}function Vy(d){var O=typeof d;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?d!=="__proto__":d===null}function Gy(d){return!!be&&be in d}function Wy(d){var O=d&&d.constructor,C=typeof O=="function"&&O.prototype||ee;return d===C}function Yy(d){return we.call(d)}function Qt(d){if(d!=null){try{return ge.call(d)}catch{}try{return d+""}catch{}}return""}function Ya(d,O){return d===O||d!==d&&O!==O}var ky=Ha(function(){return arguments}())?Ha:function(d){return qr(d)&&re.call(d,"callee")&&!Nt.call(d,"callee")},Dn=Array.isArray;function Xy(d){return d!=null&&Xa(d.length)&&!ka(d)}var Mi=Br||e1;function Jy(d,O){return Va(d,O)}function ka(d){if(!Ja(d))return!1;var O=zr(d);return O==v||O==E||O==h||O==g}function Xa(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=a}function Ja(d){var O=typeof d;return d!=null&&(O=="object"||O=="function")}function qr(d){return d!=null&&typeof d=="object"}var Za=le?Ae(le):My;function Zy(d){return Xy(d)?Fy(d):jy(d)}function Qy(){return[]}function e1(){return!1}t.exports=Jy})(Ii,Ii.exports);var Tg=Ii.exports,Ng=Object.defineProperty,sa=Object.getOwnPropertySymbols,Pg=Object.prototype.hasOwnProperty,Ag=Object.prototype.propertyIsEnumerable,oa=(t,e,r)=>e in t?Ng(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ht=(t,e)=>{for(var r in e||(e={}))Pg.call(e,r)&&oa(t,r,e[r]);if(sa)for(var r of sa(e))Ag.call(e,r)&&oa(t,r,e[r]);return t};function Rg(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var c=t.length,l=t.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function y(E){if(E instanceof Uint8Array||(ArrayBuffer.isView(E)?E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength):Array.isArray(E)&&(E=Uint8Array.from(E))),!(E instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(E.length===0)return"";for(var A=0,R=0,j=0,S=E.length;j!==S&&E[j]===0;)j++,A++;for(var x=(S-j)*f+1>>>0,g=new Uint8Array(x);j!==S;){for(var m=E[j],w=0,o=x-1;(m!==0||w<R)&&o!==-1;o--,w++)m+=256*g[o]>>>0,g[o]=m%c>>>0,m=m/c>>>0;if(m!==0)throw new Error("Non-zero carry");R=w,j++}for(var p=x-R;p!==x&&g[p]===0;)p++;for(var L=l.repeat(A);p<x;++p)L+=t.charAt(g[p]);return L}function b(E){if(typeof E!="string")throw new TypeError("Expected String");if(E.length===0)return new Uint8Array;var A=0;if(E[A]!==" "){for(var R=0,j=0;E[A]===l;)R++,A++;for(var S=(E.length-A)*h+1>>>0,x=new Uint8Array(S);E[A];){var g=r[E.charCodeAt(A)];if(g===255)return;for(var m=0,w=S-1;(g!==0||m<j)&&w!==-1;w--,m++)g+=c*x[w]>>>0,x[w]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");j=m,A++}if(E[A]!==" "){for(var o=S-j;o!==S&&x[o]===0;)o++;for(var p=new Uint8Array(R+(S-o)),L=R;o!==S;)p[L++]=x[o++];return p}}}function v(E){var A=b(E);if(A)return A;throw new Error(`Non-${e} character`)}return{encode:y,decodeUnsafe:b,decode:v}}var Cg=Rg,Fg=Cg;const aa=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Lg=t=>new TextEncoder().encode(t),Ug=t=>new TextDecoder().decode(t);class $g{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Mg{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ca(this,e)}}class jg{constructor(e){this.decoders=e}or(e){return ca(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ca=(t,e)=>new jg(ht(ht({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Bg{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new $g(e,r,n),this.decoder=new Mg(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const dn=({name:t,prefix:e,encode:r,decode:n})=>new Bg(t,e,r,n),Ur=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Fg(r,e);return dn({prefix:t,name:e,encode:n,decode:s=>aa(i(s))})},zg=(t,e,r,n)=>{const i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,l=0,h=0;for(let f=0;f<s;++f){const y=i[t[f]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|y,c+=r,c>=8&&(c-=8,a[h++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return a},qg=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",a=0,c=0;for(let l=0;l<t.length;++l)for(c=c<<8|t[l],a+=8;a>r;)a-=r,s+=e[i&c>>a];if(a&&(s+=e[i&c<<r-a]),n)for(;s.length*r&7;)s+="=";return s},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>dn({prefix:e,name:t,encode(i){return qg(i,n,r)},decode(i){return zg(i,n,r,t)}}),Kg=dn({prefix:"\0",name:"identity",encode:t=>Ug(t),decode:t=>Lg(t)});var Hg=Object.freeze({__proto__:null,identity:Kg});const Vg=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Gg=Object.freeze({__proto__:null,base2:Vg});const Wg=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Yg=Object.freeze({__proto__:null,base8:Wg});const kg=Ur({prefix:"9",name:"base10",alphabet:"0123456789"});var Xg=Object.freeze({__proto__:null,base10:kg});const Jg=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Zg=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Qg=Object.freeze({__proto__:null,base16:Jg,base16upper:Zg});const e0=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),t0=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),r0=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),n0=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i0=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),s0=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),o0=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),a0=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),c0=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var u0=Object.freeze({__proto__:null,base32:e0,base32upper:t0,base32pad:r0,base32padupper:n0,base32hex:i0,base32hexupper:s0,base32hexpad:o0,base32hexpadupper:a0,base32z:c0});const h0=Ur({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),l0=Ur({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var f0=Object.freeze({__proto__:null,base36:h0,base36upper:l0});const d0=Ur({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p0=Ur({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var g0=Object.freeze({__proto__:null,base58btc:d0,base58flickr:p0});const _0=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),y0=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),b0=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),w0=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var v0=Object.freeze({__proto__:null,base64:_0,base64pad:y0,base64url:b0,base64urlpad:w0});const ua=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),m0=ua.reduce((t,e,r)=>(t[r]=e,t),[]),E0=ua.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function S0(t){return t.reduce((e,r)=>(e+=m0[r],e),"")}function D0(t){const e=[];for(const r of t){const n=E0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const O0=dn({prefix:"\u{1F680}",name:"base256emoji",encode:S0,decode:D0});var x0=Object.freeze({__proto__:null,base256emoji:O0}),I0=la,ha=128,T0=127,N0=~T0,P0=Math.pow(2,31);function la(t,e,r){e=e||[],r=r||0;for(var n=r;t>=P0;)e[r++]=t&255|ha,t/=128;for(;t&N0;)e[r++]=t&255|ha,t>>>=7;return e[r]=t|0,la.bytes=r-n+1,e}var A0=Ti,R0=128,fa=127;function Ti(t,n){var r=0,n=n||0,i=0,s=n,a,c=t.length;do{if(s>=c)throw Ti.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=i<28?(a&fa)<<i:(a&fa)*Math.pow(2,i),i+=7}while(a>=R0);return Ti.bytes=s-n,r}var C0=Math.pow(2,7),F0=Math.pow(2,14),L0=Math.pow(2,21),U0=Math.pow(2,28),$0=Math.pow(2,35),M0=Math.pow(2,42),j0=Math.pow(2,49),B0=Math.pow(2,56),z0=Math.pow(2,63),q0=function(t){return t<C0?1:t<F0?2:t<L0?3:t<U0?4:t<$0?5:t<M0?6:t<j0?7:t<B0?8:t<z0?9:10},K0={encode:I0,decode:A0,encodingLength:q0},da=K0;const pa=(t,e,r=0)=>(da.encode(t,e,r),e),ga=t=>da.encodingLength(t),Ni=(t,e)=>{const r=e.byteLength,n=ga(t),i=n+ga(r),s=new Uint8Array(i+r);return pa(t,s,0),pa(r,s,n),s.set(e,i),new H0(t,r,e,s)};class H0{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const _a=({name:t,code:e,encode:r})=>new V0(t,e,r);class V0{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Ni(this.code,r):r.then(n=>Ni(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ya=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),G0=_a({name:"sha2-256",code:18,encode:ya("SHA-256")}),W0=_a({name:"sha2-512",code:19,encode:ya("SHA-512")});var Y0=Object.freeze({__proto__:null,sha256:G0,sha512:W0});const ba=0,k0="identity",wa=aa;var X0=Object.freeze({__proto__:null,identity:{code:ba,name:k0,encode:wa,digest:t=>Ni(ba,wa(t))}});new TextEncoder,new TextDecoder;const va=ht(ht(ht(ht(ht(ht(ht(ht(ht(ht({},Hg),Gg),Yg),Xg),Qg),u0),f0),g0),v0),x0);ht(ht({},Y0),X0);function J0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ma(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Ea=ma("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Pi=ma("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=J0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Z0=ht({utf8:Ea,"utf-8":Ea,hex:va.base16,latin1:Pi,ascii:Pi,binary:Pi},va);function Q0(t,e="utf8"){const r=Z0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Sa="wc",e_=2,Ai="core",$t=`${Sa}@${2}:${Ai}:`,t_={name:Ai,logger:"error"},r_={database:":memory:"},n_="crypto",Da="client_ed25519_seed",i_=Z.ONE_DAY,s_="keychain",o_="0.3",a_="messages",c_="0.3",u_=Z.SIX_HOURS,h_="publisher",Oa="irn",l_="error",xa="wss://relay.walletconnect.com",f_="relayer",Ve={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},d_="_subscription",pn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},p_=Z.ONE_SECOND,g_="2.6.2",__="0.3",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},y_="subscription",b_="0.3",w_=Z.FIVE_SECONDS*1e3,v_="pairing",m_="0.3",$r={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},Tt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},E_="history",S_="0.3",D_="expirer",yt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},O_="0.3";class x_{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=s_,this.version=o_,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Uo(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?$o(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class I_{constructor(e,r,n){this.core=e,this.logger=r,this.name=n_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=oo(i);return so(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Nd();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),a=oo(s),c=gi();return await $f(c,i,i_,a)},this.generateSharedKey=(i,s,a)=>{this.isInitialized();const c=this.getPrivateKey(i),l=Pd(c,s);return this.setSymKey(l,a)},this.setSymKey=async(i,s)=>{this.isInitialized();const a=s||Ad(i);return await this.keychain.set(a,i),a},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,a)=>{this.isInitialized();const c=Po(a),l=Yn(s);if(Ao(c)){const b=c.senderPublicKey,v=c.receiverPublicKey;i=await this.generateSharedKey(b,v)}const h=this.getSymKey(i),{type:f,senderPublicKey:y}=c;return Cd({type:f,symKey:h,message:l,senderPublicKey:y})},this.decode=async(i,s,a)=>{this.isInitialized();const c=Ud(s,a);if(Ao(c)){const f=c.receiverPublicKey,y=c.senderPublicKey;i=await this.generateSharedKey(f,y)}const l=this.getSymKey(i),h=Fd({symKey:l,encoded:s});return Ns(h)},this.getPayloadType=i=>{const s=cn(i);return Pr(s.type)},this.getPayloadSenderPublicKey=i=>{const s=cn(i);return s.senderPublicKey?at(s.senderPublicKey,ct):void 0},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.keychain=n||new x_(this.core,this.logger)}get context(){return Oe.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Da)}catch{e=gi(),await this.keychain.set(Da,e)}return Q0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class T_ extends yh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=a_,this.version=c_,this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=an(i);let a=this.messages.get(n);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=i,this.messages.set(n,a),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),a=an(i);return typeof s[a]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Oe.generateChildLogger(e,this.name),this.core=r}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Uo(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?$o(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class N_ extends bh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new lt.exports.EventEmitter,this.name=h_,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const a=s?.ttl||u_,c=_i(s),l=s?.prompt||!1,h=s?.tag||0,f={topic:n,message:i,opts:{ttl:a,relay:c,prompt:l,tag:h}},y=an(i);this.queue.set(y,f);try{await await un(this.rpcPublish(n,i,a,c,l,h),this.publishTimeout),this.relayer.events.emit(Ve.publish,f)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Ve.connection_stalled);return}this.onPublish(y,f),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(a){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(a),a}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Oe.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,a){var c,l,h,f;const y={method:hn(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:a}};return ut((c=y.params)==null?void 0:c.prompt)&&((l=y.params)==null||delete l.prompt),ut((h=y.params)==null?void 0:h.tag)&&((f=y.params)==null||delete f.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:y}),this.relayer.request(y)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(wr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class P_{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var A_=Object.defineProperty,R_=Object.defineProperties,C_=Object.getOwnPropertyDescriptors,Ia=Object.getOwnPropertySymbols,F_=Object.prototype.hasOwnProperty,L_=Object.prototype.propertyIsEnumerable,Ta=(t,e,r)=>e in t?A_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mr=(t,e)=>{for(var r in e||(e={}))F_.call(e,r)&&Ta(t,r,e[r]);if(Ia)for(var r of Ia(e))L_.call(e,r)&&Ta(t,r,e[r]);return t},Ri=(t,e)=>R_(t,C_(e));class U_ extends mh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new P_,this.events=new lt.exports.EventEmitter,this.name=y_,this.version=b_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$t,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=_i(i),a={topic:n,relay:s};this.pending.set(n,a);const c=await this.rpcSubscribe(n,s);return this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const a=new Z.Watch;a.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),i(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=w_&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Oe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=_i(n);await this.rpcUnsubscribe(e,r,i);const s=Ke("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:hn(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await un(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}return an(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:hn(r.protocol).batchSubscribe,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await un(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Ve.connection_stalled)}}rpcUnsubscribe(e,r,n){const i={method:hn(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,r){this.setSubscription(e,Ri(Mr({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Mr({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,Mr({},r)),this.topicMap.set(r.topic,e),this.events.emit(It.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(It.deleted,Ri(Mr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){if(!this.cached.length)return;const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<e;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}this.events.emit(It.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const r=await this.rpcBatchSubscribe(e);Rr(r)&&this.onBatchSubscribe(r.map((n,i)=>Ri(Mr({},e[i]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(r=>{e.push(r)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(wr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Ve.connect,async()=>{await this.onConnect()}),this.relayer.on(Ve.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async e=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(It.deleted,async e=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),e())},this.pollingInterval)})}}var $_=Object.defineProperty,Na=Object.getOwnPropertySymbols,M_=Object.prototype.hasOwnProperty,j_=Object.prototype.propertyIsEnumerable,Pa=(t,e,r)=>e in t?$_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,B_=(t,e)=>{for(var r in e||(e={}))M_.call(e,r)&&Pa(t,r,e[r]);if(Na)for(var r of Na(e))j_.call(e,r)&&Pa(t,r,e[r]);return t};class z_ extends wh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new lt.exports.EventEmitter,this.name=f_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Oe.generateChildLogger(e.logger,this.name):Kr(Oe.getDefaultLoggerOptions({level:e.logger||l_})),this.messages=new T_(this.logger,e.core),this.subscriber=new U_(this,this.logger),this.publisher=new N_(this,this.logger),this.relayUrl=e?.relayUrl||xa,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Oe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now()})}async subscribe(e,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(It.created,s=>{s.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,r),i()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Ve.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(It.resubscribed,()=>{r()})}),await Promise.race([new Promise(async(r,n)=>{await un(this.provider.connect(),5e3,"socket stalled").catch(i=>n(i)).then(()=>r()).finally(()=>this.removeListener(Ve.transport_closed,this.rejectTransportOpen))}),new Promise(r=>this.once(Ve.transport_closed,this.rejectTransportOpen))])])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.events.emit(Ve.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,await this.transportClose(),await new Promise(r=>setTimeout(r,500)),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(r=>e.includes(r))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Sg(new Ig(Xd({sdkVersion:g_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Oi(e)){if(!e.method.endsWith(d_))return;const r=e.params,{topic:n,message:i,publishedAt:s}=r.data,a={topic:n,message:i,publishedAt:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(B_({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Ve.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Si(e.id,!0);await this.provider.connection.send(r)}registerProviderListeners(){this.provider.on(pn.payload,e=>this.onProviderPayload(e)),this.provider.on(pn.connect,()=>{this.events.emit(Ve.connect)}),this.provider.on(pn.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(pn.error,e=>{this.logger.error(e),this.events.emit(Ve.error,e)})}registerEventListeners(){this.events.on(Ve.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Ve.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},Z.toMiliseconds(p_))}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var q_=Object.defineProperty,Aa=Object.getOwnPropertySymbols,K_=Object.prototype.hasOwnProperty,H_=Object.prototype.propertyIsEnumerable,Ra=(t,e,r)=>e in t?q_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ca=(t,e)=>{for(var r in e||(e={}))K_.call(e,r)&&Ra(t,r,e[r]);if(Aa)for(var r of Aa(e))H_.call(e,r)&&Ra(t,r,e[r]);return t};class gn extends vh{constructor(e,r,n,i=$t,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=__,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!ut(a)?this.map.set(this.getKey(a),a):yp(a)?this.map.set(a.id,a):bp(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(l=>Tg(c[l],a[l]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const l=Ca(Ca({},this.getData(a)),c);this.map.set(a,l),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),await this.persist())},this.logger=Oe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class V_{constructor(e,r){this.core=e,this.logger=r,this.name=v_,this.version=m_,this.events=new lt.exports,this.initialized=!1,this.storagePrefix=$t,this.ignoredPayloadTypes=[kt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=gi(),i=await this.core.crypto.setSymKey(n),s=xt(Z.FIVE_MINUTES),a={protocol:Oa},c={topic:i,expiry:s,relay:a,active:!1},l=ap({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:a});return await this.pairings.set(i,c),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:l}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:a}=sp(n.uri);if(this.pairings.keys.includes(i))throw new Error(`Pairing already exists: ${i}`);if(this.core.crypto.hasKeys(i))throw new Error(`Keychain already exists: ${i}`);const c=xt(Z.FIVE_MINUTES),l={topic:i,relay:a,expiry:c,active:!1};return await this.pairings.set(i,l),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:a}),this.core.expirer.set(i,c),n.activatePairing&&await this.activate({topic:i}),l},this.activate=async({topic:n})=>{this.isInitialized();const i=xt(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:a,resolve:c,reject:l}=cr();this.events.once(Ue("pairing_ping",s),({error:h})=>{h?l(h):c()}),await a()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ke("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const a=fn(i,s),c=await this.core.crypto.encode(n,a),l=$r[i].req;return this.core.history.set(n,a),await this.core.relayer.publish(n,c,l),a.id},this.sendResult=async(n,i,s)=>{const a=Si(n,s),c=await this.core.crypto.encode(i,a),l=await this.core.history.get(i,n),h=$r[l.request.method].res;await this.core.relayer.publish(i,c,h),await this.core.history.resolve(a)},this.sendError=async(n,i,s)=>{const a=Di(n,s),c=await this.core.crypto.encode(i,a),l=await this.core.history.get(i,n),h=$r[l.request.method]?$r[l.request.method].res:$r.unregistered_method.res;await this.core.relayer.publish(i,c,h),await this.core.history.resolve(a)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>Ut(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,a=s.method;if(this.pairings.keys.includes(i))switch(a){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,a=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(a){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Rt(i)?this.events.emit(Ue("pairing_ping",s),{}):mt(i)&&this.events.emit(Ue("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:a}=i;try{if(this.registeredMethods.includes(a))return;const c=Ke("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,n,c),this.logger.error(c)}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ke("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!dt(n)){const{message:i}=H("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!_p(n.uri)){const{message:i}=H("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!dt(n)){const{message:s}=H("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!dt(n)){const{message:s}=H("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!He(n,!1)){const{message:i}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(Ut(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=H("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=Oe.generateChildLogger(r,this.name),this.pairings=new gn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Oe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ve.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Oi(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):xi(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(yt.expired,async e=>{const{topic:r}=jo(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class G_ extends _h{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new lt.exports.EventEmitter,this.name=E_,this.version=S_,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const a={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(a.id,a),this.events.emit(Tt.created,a)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=mt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(Tt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Tt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:fn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Tt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Tt.created,e=>{const r=Tt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Tt.updated,e=>{const r=Tt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Tt.deleted,e=>{const r=Tt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class W_ extends Eh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new lt.exports.EventEmitter,this.name=D_,this.version=O_,this.cached=[],this.initialized=!1,this.storagePrefix=$t,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),a={target:s,expiry:i};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(yt.created,{target:s,expiration:a})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(yt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Jd(e);if(typeof e=="number")return Zd(e);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(yt.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(wr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yt.created,e=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.expired,e=>{const r=yt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(yt.deleted,e=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Y_=Object.defineProperty,Fa=Object.getOwnPropertySymbols,k_=Object.prototype.hasOwnProperty,X_=Object.prototype.propertyIsEnumerable,La=(t,e,r)=>e in t?Y_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ua=(t,e)=>{for(var r in e||(e={}))k_.call(e,r)&&La(t,r,e[r]);if(Fa)for(var r of Fa(e))X_.call(e,r)&&La(t,r,e[r]);return t};class Ci extends gh{constructor(e){super(e),this.protocol=Sa,this.version=e_,this.name=Ai,this.events=new lt.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||xa;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Kr(Oe.getDefaultLoggerOptions({level:e?.logger||t_.logger}));this.logger=Oe.generateChildLogger(r,this.name),this.heartbeat=new wr.HeartBeat,this.crypto=new I_(this,this.logger,e?.keychain),this.history=new G_(this,this.logger),this.expirer=new W_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Wc(Ua(Ua({},r_),e?.storageOptions)),this.relayer=new z_({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new V_(this,this.logger)}static async init(e){const r=new Ci(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const J_=Ci,Fi="wc",Li=2,Ui="client",_n=`${Fi}@${Li}:${Ui}:`,yn={name:Ui,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Z_={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire"},Q_={database:":memory:"},ey={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ty="history",ry="0.3",$a="proposal",ny=Z.THIRTY_DAYS,Ma="Proposal expired",ja="session",jr=Z.SEVEN_DAYS,Ba="engine",hr={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},bn={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},za="request";var iy=Object.defineProperty,sy=Object.defineProperties,oy=Object.getOwnPropertyDescriptors,qa=Object.getOwnPropertySymbols,ay=Object.prototype.hasOwnProperty,cy=Object.prototype.propertyIsEnumerable,Ka=(t,e,r)=>e in t?iy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bt=(t,e)=>{for(var r in e||(e={}))ay.call(e,r)&&Ka(t,r,e[r]);if(qa)for(var r of qa(e))cy.call(e,r)&&Ka(t,r,e[r]);return t},$i=(t,e)=>sy(t,oy(e));class uy extends Dh{constructor(e){super(e),this.name=Ba,this.events=new lt.exports,this.initialized=!1,this.ignoredPayloadTypes=[kt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(hr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const n=$i(bt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:l}=n;let h=i,f,y=!1;if(h&&(y=this.client.core.pairing.pairings.get(h).active),!h||!y){const{topic:x,uri:g}=await this.client.core.pairing.create();h=x,f=g}const b=await this.client.core.crypto.generateKeyPair(),v=bt({requiredNamespaces:s,optionalNamespaces:a,relays:l??[{protocol:Oa}],proposer:{publicKey:b,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:E,resolve:A,done:R}=cr(Z.FIVE_MINUTES,Ma);if(this.events.once(Ue("session_connect"),async({error:x,session:g})=>{if(x)E(x);else if(g){g.self.publicKey=b;const m=$i(bt({},g),{requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces});await this.client.session.set(g.topic,m),await this.setExpiry(g.topic,g.expiry),h&&await this.client.core.pairing.updateMetadata({topic:h,metadata:g.peer.metadata}),A(m)}}),!h){const{message:x}=H("NO_MATCHING_KEY",`connect() pairing topic: ${h}`);throw new Error(x)}const j=await this.sendRequest(h,"wc_sessionPropose",v),S=xt(Z.FIVE_MINUTES);return await this.setProposal(j,bt({id:j,expiry:S},v)),{uri:f,approval:R}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s,sessionProperties:a}=r,c=this.client.proposal.get(n);let{pairingTopic:l,proposer:h,requiredNamespaces:f,optionalNamespaces:y}=c;l=l||"",Cr(f)||(f=lp(s,"approve()"));const b=await this.client.core.crypto.generateKeyPair(),v=h.publicKey,E=await this.client.core.crypto.generateSharedKey(b,v);l&&n&&(await this.client.core.pairing.updateMetadata({topic:l,metadata:h.metadata}),await this.sendResult(n,l,{relay:{protocol:i??"irn"},responderPublicKey:b}),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}));const A=bt({relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:f,optionalNamespaces:y,pairingTopic:l,controller:{publicKey:b,metadata:this.client.metadata},expiry:xt(jr)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(E),await this.sendRequest(E,"wc_sessionSettle",A);const R=$i(bt({},A),{topic:E,pairingTopic:l,acknowledged:!1,self:A.controller,peer:{publicKey:h.publicKey,metadata:h.metadata},controller:b});return await this.client.session.set(E,R),await this.setExpiry(E,xt(jr)),{topic:E,acknowledged:()=>new Promise(j=>j(this.client.session.get(E)))}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:a,resolve:c,reject:l}=cr();return this.events.once(Ue("session_update",s),({error:h})=>{h?l(h):c()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:a}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:a,reject:c}=cr();return this.events.once(Ue("session_extend",i),({error:l})=>{l?c(l):a()}),await this.setExpiry(n,xt(jr)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s,expiry:a}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n},a),{done:l,resolve:h,reject:f}=cr(a);return this.events.once(Ue("session_request",c),({error:y,result:b})=>{y?f(y):h(b)}),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n,id:c}),await l()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;Rt(i)?await this.sendResult(s,n,i.result):mt(i)&&await this.sendError(s,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:a,reject:c}=cr();this.events.once(Ue("session_ping",i),({error:l})=>{l?c(l):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ke("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>pp(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ke("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=hr.wc_sessionRequest.req.ttl,{id:i,topic:s,params:a}=r;await this.client.pendingRequest.set(i,{id:i,topic:s,params:a}),n&&this.client.core.expirer.set(i,xt(n))},this.sendRequest=async(r,n,i,s)=>{const a=fn(n,i),c=await this.client.core.crypto.encode(r,a),l=hr[n].req;return s&&(l.ttl=s),this.client.core.history.set(r,a),this.client.core.relayer.publish(r,c,l),a.id},this.sendResult=async(r,n,i)=>{const s=Si(r,i),a=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),l=hr[c.request.method].res;this.client.core.relayer.publish(n,a,l),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=Di(r,i),a=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),l=hr[c.request.method].res;this.client.core.relayer.publish(n,a,l),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{Ut(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{Ut(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(bt({},n.params));const a=xt(Z.FIVE_MINUTES),c=bt({id:s,pairingTopic:r,expiry:a},i);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Rt(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const h=await this.client.core.crypto.generateSharedKey(c,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const f=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:f}),await this.client.core.pairing.activate({topic:r})}else mt(n)&&(await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")),this.events.emit(Ue("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:l,namespaces:h,requiredNamespaces:f,optionalNamespaces:y,sessionProperties:b,pairingTopic:v}=n.params,E=bt({topic:r,relay:a,expiry:l,namespaces:h,acknowledged:!0,pairingTopic:v,requiredNamespaces:f,optionalNamespaces:y,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},b&&{sessionProperties:b});await this.sendResult(n.id,r,!0),this.events.emit(Ue("session_connect"),{session:E})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Rt(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ue("session_approve",i),{})):mt(n)&&(await this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.events.emit(Ue("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(bt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Ue("session_update",i),{}):mt(n)&&this.events.emit(Ue("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,xt(jr)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Ue("session_extend",i),{}):mt(n)&&this.events.emit(Ue("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Rt(n)?this.events.emit(Ue("session_ping",i),{}):mt(n)&&this.events.emit(Ue("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),this.client.core.relayer.once(Ve.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(i,r,!0),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(bt({topic:r},s)),await this.setPendingSessionRequest({id:i,topic:r,params:s}),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Ue("session_request",i),{result:n.result}):mt(n)&&this.events.emit(Ue("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(bt({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.isValidConnect=async r=>{if(!dt(r)){const{message:l}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(ut(n)||await this.isValidPairingTopic(n),!xp(c,!0)){const{message:l}=H("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}!ut(i)&&Cr(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!ut(s)&&Cr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),ut(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,n)=>{const i=Op(r,"connect()",n);if(i)throw new Error(i.message)},this.isValidApprove=async r=>{if(!dt(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=ln(i,"approve()");if(l)throw new Error(l.message);const h=Go(c.requiredNamespaces,i,"approve()");if(h)throw new Error(h.message);if(!He(s,!0)){const{message:f}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}ut(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!dt(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!Tp(i)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!dt(r)){const{message:h}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:n,controller:i,namespaces:s,expiry:a}=r;if(!Ho(n)){const{message:h}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const c=wp(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);const l=ln(s,"onSessionSettleRequest()");if(l)throw new Error(l.message);if(Ut(a)){const{message:h}=H("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!dt(r)){const{message:l}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(l)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),a=ln(i,"update()");if(a)throw new Error(a.message);const c=Go(s.requiredNamespaces,i,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!dt(r)){const{message:l}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(l)}const{topic:n,request:i,chainId:s,expiry:a}=r;await this.isValidSessionTopic(n);const{namespaces:c}=this.client.session.get(n);if(!Vo(c,s)){const{message:l}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(l)}if(!Np(i)){const{message:l}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(l)}if(!Rp(c,s,i.method)){const{message:l}=H("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(l)}if(a&&!Up(a,bn)){const{message:l}=H("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${bn.min} and ${bn.max}`);throw new Error(l)}},this.isValidRespond=async r=>{if(!dt(r)){const{message:s}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!Pp(i)){const{message:s}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!dt(r)){const{message:c}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Vo(a,s)){const{message:c}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!Ap(i)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}if(!Cp(a,s,i.name)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(i=>{if(!He(i,!1)){const{message:s}=H("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Ve.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);Oi(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):xi(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(yt.expired,async e=>{const{topic:r,id:n}=jo(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,H("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(e){if(!He(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Ut(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=H("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!He(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Ut(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=H("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(He(e,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Ip(e)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Ut(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=H("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class hy extends gn{constructor(e,r){super(e,r,$a,_n),this.core=e,this.logger=r}}class ly extends gn{constructor(e,r){super(e,r,ja,_n),this.core=e,this.logger=r}}class fy extends gn{constructor(e,r){super(e,r,za,_n,n=>n.id),this.core=e,this.logger=r}}class wn extends Sh{constructor(e){super(e),this.protocol=Fi,this.version=Li,this.name=yn.name,this.events=new lt.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||yn.name,this.metadata=e?.metadata||Gd();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Kr(Oe.getDefaultLoggerOptions({level:e?.logger||yn.logger}));this.core=e?.core||new J_(e),this.logger=Oe.generateChildLogger(r,this.name),this.session=new ly(this.core,this.logger),this.proposal=new hy(this.core,this.logger),this.pendingRequest=new fy(this.core,this.logger),this.engine=new uy(this)}static async init(e){const r=new wn(e);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const dy=wn;xe.ENGINE_CONTEXT=Ba,xe.ENGINE_RPC_OPTS=hr,xe.HISTORY_CONTEXT=ty,xe.HISTORY_EVENTS=ey,xe.HISTORY_STORAGE_VERSION=ry,xe.PROPOSAL_CONTEXT=$a,xe.PROPOSAL_EXPIRY=ny,xe.PROPOSAL_EXPIRY_MESSAGE=Ma,xe.REQUEST_CONTEXT=za,xe.SESSION_CONTEXT=ja,xe.SESSION_EXPIRY=jr,xe.SESSION_REQUEST_EXPIRY_BOUNDARIES=bn,xe.SIGN_CLIENT_CONTEXT=Ui,xe.SIGN_CLIENT_DEFAULT=yn,xe.SIGN_CLIENT_EVENTS=Z_,xe.SIGN_CLIENT_PROTOCOL=Fi,xe.SIGN_CLIENT_STORAGE_OPTIONS=Q_,xe.SIGN_CLIENT_STORAGE_PREFIX=_n,xe.SIGN_CLIENT_VERSION=Li,xe.SignClient=dy,xe.default=wn,Object.defineProperty(xe,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
